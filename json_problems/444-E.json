{
    "uid": "444-E",
    "url": "https://codeforces.com/contest/444/problem/E",
    "tags": [
        "binary search",
        " dsu",
        " trees"
    ],
    "title": "444-E",
    "statement": "E. DZY Loves Plantingtime limit per test3 secondsmemory limit per test256 megabytesinputstdinoutputstdoutDZY loves planting, and he enjoys solving tree problems.DZY has a weighted tree (connected undirected graph without cycles) containingnnodes (they are numbered from1ton). He defines the functiong(x,y)(1 ≤x,y≤n)as the longest edge in the shortest path between nodesxandy. Speciallyg(z,z) = 0for everyz.For every integer sequencep1,p2, ...,pn(1 ≤pi≤n), DZY definesf(p)as.DZY wants to find such a sequencepthatf(p)has maximum possible value. But there is one more restriction: the elementjcan appear inpat mostxjtimes.Please, find the maximum possiblef(p)under the described restrictions.InputThe first line contains an integern(1 ≤n≤ 3000).Each of the nextn- 1lines contains three integersai,bi,ci(1 ≤ai,bi≤n; 1 ≤ci≤ 10000), denoting an edge betweenaiandbiwith lengthci. It is guaranteed that these edges form a tree.Each of the nextnlines describes an element of sequencex. Thej-th line contains an integerxj(1 ≤xj≤n).OutputPrint a single integer representing the answer.ExamplesInput41 2 12 3 23 4 31111Output2Input41 2 12 3 23 4 34444Output3NoteIn the first sample, one of the optimalpis[4, 3, 2, 1].",
    "source": "CF",
    "vjudge": false
}