{
    "uid": "843-E",
    "url": "https://codeforces.com/contest/843/problem/E",
    "tags": [
        "flows",
        " graphs"
    ],
    "title": "843-E",
    "statement": "E. Maximum Flowtime limit per test1 secondmemory limit per test256 megabytesinputstandard inputoutputstandard outputYou are given a directed graph, consisting ofnvertices andmedges. The verticessandtare marked as source and sink correspondingly. Additionally, there are no edges ending atsand there are no edges beginning int.The graph was constructed in a following way: initially each edge had capacityci> 0. A maximum flow with source atsand sink attwas constructed in this flow network. Let's denotefias the value of flow passing through edge with indexi. Next, all capacitiesciand flow valuefiwere erased. Instead, indicatorsgiwere written on edges — if flow value passing through edgeiwas positive, i.e.1iffi> 0and0otherwise.Using the graph and valuesgi, find out what is theminimumpossible number of edges in the initial flow network that could be saturated (the passing flow is equal to capacity, i.e.fi=ci). Also construct the corresponding flow network with maximum flow in it.A flow in directed graph is described by flow valuesfion each of the edges so that the following conditions are satisfied:for each vertex, except source and sink, total incoming flow and total outcoming flow are equal,for each edge0 ≤fi≤ciA flow is maximum if the difference between the sum of flow values on edges from the source, and the sum of flow values on edges to the source (there are no such in this problem), is maximum possible.InputThe first line of input data contains four positive integersn,m,s,t(2 ≤n≤ 100,1 ≤m≤ 1000,1 ≤s,t≤n,s≠t) — the number of vertices, the number of edges, index of source vertex and index of sink vertex correspondingly.Each of nextmlines of input data contain non-negative integersui,vi,gi(1 ≤ui,vi≤n,) — the beginning of edgei, the end of edgeiand indicator, which equals to1if flow value passing through edgeiwas positive and0if not.It's guaranteed that no edge connects vertex with itself. Also it's guaranteed that there are no more than one edge between each ordered pair of vertices and that there exists at least one network flow that satisfies all the constrains from input data.OutputIn the first line print single non-negative integerk— minimum number of edges, which should be saturated in maximum flow.In each of nextmlines print two integersfi,ci(1 ≤ci≤ 109,0 ≤fi≤ci) — the flow value passing through edgeiand capacity of edgei.This data should form a correct maximum flow in flow network. Also there must be exactlykedges with statementfi=cisatisfied. Also statementfi> 0must be true if and only ifgi= 1.If there are several possible answers, print any of them.ExampleInput5 6 1 51 2 12 3 13 5 11 4 14 3 04 5 1Output23 33 83 44 40 54 9NoteThe illustration for second sample case. The saturated edges are marked dark, while edges withgi= 0are marked with dotted line. The integer on edge is the index of this edge in input list.",
    "source": "CF",
    "vjudge": false
}