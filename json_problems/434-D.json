{
    "uid": "434-D",
    "url": "https://codeforces.com/contest/434/problem/D",
    "tags": [
        "flows"
    ],
    "title": "434-D",
    "statement": "D. Nanami's Power Planttime limit per test5 secondsmemory limit per test512 megabytesinputstdinoutputstdoutNanami likes playing games, and is also really good at it. This day she was playing a new game which involved operating a power plant. Nanami's job is to control the generators in the plant and produce maximum output.There arengenerators in the plant. Each generator should be set to a generating level. Generating level is an integer (possibly zero or negative), the generating level of thei-th generator should be betweenliandri(both inclusive). The output of a generator can be calculated using a certain quadratic functionf(x), wherexis the generating level of the generator. Each generator has its own function, the function of thei-th generator is denoted asfi(x).However, there aremfurther restrictions to the generators. Let the generating level of thei-th generator bexi. Each restriction is of the formxu≤xv+d, whereuandvare IDs of two different generators anddis an integer.Nanami found the game tedious but giving up is against her creed. So she decided to have a program written to calculate the answer for her (the maximum total output of generators). Somehow, this became your job.InputThe first line contains two integersnandm(1 ≤n≤ 50; 0 ≤m≤ 100)— the number of generators and the number of restrictions.Then follownlines, each line contains three integersai,bi, andci(|ai| ≤ 10; |bi|, |ci| ≤ 1000)— the coefficients of the functionfi(x). That is,fi(x) =aix2+bix+ci.Then follow anothernlines, each line contains two integersliandri( - 100 ≤li≤ri≤ 100).Then followmlines, each line contains three integersui,vi, anddi(1 ≤ui,vi≤n;ui≠vi; |di| ≤ 200), describing a restriction. Thei-th restriction isxui≤xvi+di.OutputPrint a single line containing a single integer — the maximum output of all the generators. It is guaranteed that there exists at least one valid configuration.ExamplesInput3 30 1 00 1 10 1 20 31 2-100 1001 2 02 3 03 1 0Output9Input5 81 -8 202 -4 0-1 10 -100 1 00 -1 11 91 40 103 117 92 1 31 2 32 3 33 2 33 4 34 3 34 5 35 4 3Output46NoteIn the first sample,f1(x) =x,f2(x) =x+ 1, andf3(x) =x+ 2, so we are to maximize the sum of the generating levels. The restrictions arex1≤x2,x2≤x3, andx3≤x1, which gives usx1=x2=x3. The optimal configuration isx1=x2=x3= 2, which produces an output of 9.In the second sample, restrictions are equal to|xi-xi+ 1| ≤ 3for1 ≤i<n. One of the optimal configurations isx1= 1,x2= 4,x3= 5,x4= 8andx5= 7.",
    "source": "CF",
    "vjudge": false
}