{
    "uid": "97-D",
    "url": "https://codeforces.com/contest/97/problem/D",
    "tags": [
        "bitmasks",
        " brute force",
        " implementation"
    ],
    "title": "97-D",
    "statement": "D. Robot in Basementtime limit per test4 secondsmemory limit per test256 megabytesinputstdinoutputstdoutThe Professor has lost his home robot yet again. After some thinking Professor understood that he had left the robot in the basement.The basement in Professor's house is represented by a rectanglen×m, split into1 × 1squares. Some squares are walls which are impassable; other squares are passable. You can get from any passable square to any other passable square moving through edge-adjacent passable squares. One passable square is the exit from the basement. The robot is placed exactly in one passable square. Also the robot may be placed in the exit square.Professor is scared of going to the dark basement looking for the robot at night. However, he has a basement plan and the robot's remote control. Using the remote, Professor can send signals to the robot to shift one square left, right, up or down. When the robot receives a signal, it moves in the required direction if the robot's neighboring square in the given direction is passable. Otherwise, the robot stays idle.Professor wrote a sequence ofkcommands on a piece of paper. He thinks that the sequence can lead the robot out of the basement, wherever it's initial position might be. Professor programmed another robot to press the required buttons on the remote according to the notes on the piece of paper. Professor was just about to run the program and go to bed, when he had an epiphany.Executing each command takes some energy and Professor doesn't want to get huge electricity bill at the end of the month. That's why he wants to find in the sequence he has written out the minimal possible prefix that would guarantee to lead the robot out to the exit after the prefix is fulfilled. And that's the problem Professor challenges you with at this late hour.InputThe first line contains three integersn,mandk(3 ≤n,m≤ 150,1 ≤k≤ 105). Nextnlines containmcharacters each — that is the Professor's basement's description: \"#\" stands for a wall, \".\" stands for a passable square and \"E\" stands for the exit from the basement (this square also is passable). It is possible to get from each passable square to the exit, all squares located by then×mrectangle's perimeter are the walls. Exactly one square is the exit from the basement. The last line containskcharacters, the description of the sequence of commands that Professor has written out on a piece of paper. \"L\", \"R\", \"U\", \"D\" stand for commands left, right, up and down correspondingly.OutputPrint in the output file the length of the smallest possible prefix that will lead the robot to the exit square. In other words, wherever the robot had been positioned initially, it should be positioned in the exit squareafter allthe commands from the prefix are fulfilled (during doing commands the robot can come and leave the exit square, but only the last position of the robot is interesting for us). If Professor is mistaken and no prefix (including the whole sequence) can bring the robot to the exit, print \"-1\" (without the quotes). If there is the only passable square and it is the exit, print \"0\" (without the quotes).ExamplesInput5 5 7######...##...##E..######UULLDDROutput6Input5 5 7######.#.##...##E..######UULLDDROutput-1Input5 3 2####.##.##E####DDOutput2",
    "source": "CF",
    "vjudge": false
}