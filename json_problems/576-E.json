{
    "uid": "576-E",
    "url": "https://codeforces.com/contest/576/problem/E",
    "tags": [
        "binary search",
        " data structures"
    ],
    "title": "576-E",
    "statement": "E. Painting Edgestime limit per test6 secondsmemory limit per test600 megabytesinputstandard inputoutputstandard outputNote the unusual memory limit for this problem.You are given an undirected graph consisting ofnvertices andmedges. The vertices are numbered with integers from1ton, the edges are numbered with integers from1tom. Each edge can be unpainted or be painted in one of thekcolors, which are numbered with integers from1tok. Initially, none of the edges is painted in any of the colors.You get queries of the form \"Repaint edgeeito colorci\". At any time the graph formed by the edges of the same color must be bipartite. If after the repaint this condition is violated, then the query is considered to be invalid and edgeeikeeps its color. Otherwise, edgeeiis repainted in colorci, and the query is considered to valid.Recall that the graph is calledbipartiteif the set of its vertices can be divided into two parts so that no edge connected vertices of the same parts.For example, suppose you are given a triangle graph, that is a graph with three vertices and edges(1, 2),(2, 3)and(3, 1). Suppose that the first two edges are painted color1, and the third one is painted color2. Then the query of \"repaint the third edge in color1\" will be incorrect because after its execution the graph formed by the edges of color1will not be bipartite. On the other hand, it is possible to repaint the second edge in color2.You receiveqqueries. For each query, you should either apply it, and report that the query is valid, or report that the query is invalid.InputThe first line contains integersn,m,k,q(2 ≤n≤ 5·105,1 ≤m,q≤ 5·105,1 ≤k≤ 50) — the number of vertices, the number of edges, the number of colors and the number of queries.Then followmedges of the graph in the formai,bi(1 ≤ai,bi≤n).Then followqqueries of the formei,ci(1 ≤ei≤m,1 ≤ci≤k).It is guaranteed that the graph doesn't contain multiple edges and loops.OutputFor each query print \"YES\" (without the quotes), if it is valid, or \"NO\" (without the quotes), if this query destroys the bipartivity of the graph formed by the edges of some color.ExamplesInput3 3 2 51 22 31 31 12 13 23 12 2OutputYESYESYESNOYES",
    "source": "CF",
    "vjudge": false
}