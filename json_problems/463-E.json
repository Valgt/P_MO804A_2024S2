{
    "uid": "463-E",
    "url": "https://codeforces.com/contest/463/problem/E",
    "tags": [
        "brute force",
        " dfs and similar",
        " math",
        " number theory",
        " trees"
    ],
    "title": "463-E",
    "statement": "E. Caisa and Treetime limit per test10 secondsmemory limit per test256 megabytesinputstdinoutputstdoutCaisa is now at home and his son has a simple task for him.Given a rooted tree withnvertices, numbered from1ton(vertex1is the root). Each vertex of the tree has a value. You should answerqqueries. Each query is one of the following:Format of the query is \"1v\". Let's write out the sequence of vertices along the path from the root to vertexv:u1,u2, ...,uk(u1= 1;uk=v). You need to output such a vertexuithatgcd(valueofui,valueofv) > 1andi<k. If there are several possible verticesuipick the one with maximum value ofi. If there is no such vertex output-1.Format of the query is \"2vw\". You must change the value of vertexvtow.You are given all the queries, help Caisa to solve the problem.InputThe first line contains two space-separated integersn,q(1 ≤n,q≤ 105).The second line containsnintegersa1,a2, ...,an(1 ≤ai≤ 2·106), whereairepresent the value of nodei.Each of the nextn- 1lines contains two integersxiandyi(1 ≤xi,yi≤n;xi≠yi), denoting the edge of the tree between verticesxiandyi.Each of the nextqlines contains a query in the format that is given above. For each query the following inequalities hold:1 ≤v≤nand1 ≤w≤ 2·106.Note that: there are no more than50queries that changes the value of a vertex.OutputFor each query of the first type output the result of the query.ExamplesInput4 610 8 4 31 22 33 41 11 21 31 42 1 91 4Output-112-11Notegcd(x,y)is greatest common divisor of two integersxandy.",
    "source": "CF",
    "vjudge": false
}