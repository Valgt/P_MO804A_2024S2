{
    "uid": "436-C",
    "url": "https://codeforces.com/contest/436/problem/C",
    "tags": [
        "dsu",
        " graphs",
        " greedy",
        " trees"
    ],
    "title": "436-C",
    "statement": "C. Dungeons and Candiestime limit per test2 secondsmemory limit per test256 megabytesinputstdinoutputstdoutDuring the loading of the game \"Dungeons and Candies\" you are required to get descriptions ofklevels from the server. Each description is a map of ann×mcheckered rectangular field. Some cells of the field contain candies (each cell has at most one candy). An empty cell is denoted as \".\" on the map, but if a cell has a candy, it is denoted as a letter of the English alphabet. A level may contain identical candies, in this case the letters in the corresponding cells of the map will be the same.When you transmit information via a network, you want to minimize traffic — the total size of the transferred data. The levels can be transmitted in any order. There are two ways to transmit the current levelA:You can transmit the whole levelA. Then you need to transmitn·mbytes via the network.You can transmit the difference between levelAand some previously transmitted levelB(if it exists); this operation requires to transmitdA,B·wbytes, wheredA,Bis the number of cells of the field that are different forAandB, andwis a constant. Note, that you should compare only the corresponding cells of levelsAandBto calculatedA,B. You cannot transform the maps of levels, i.e. rotate or shift them relatively to each other.Your task is to find a way to transfer all theklevels and minimize the traffic.InputThe first line contains four integersn,m,k,w(1 ≤n,m≤ 10; 1 ≤k,w≤ 1000). Then follows the description ofklevels. Each level is described bynlines, each line containsmcharacters. Each character is either a letter of the English alphabet or a dot (\".\"). Please note that the case of the letters matters.OutputIn the first line print the required minimum number of transferred bytes.Then printkpairs of integersx1,y1,x2,y2, ...,xk,yk, describing the way to transfer levels. Pairxi,yimeans that levelxineeds to be transferred by wayyi. Ifyiequals 0, that means that the level must be transferred using the first way, otherwiseyimust be equal to the number of a previously transferred level. It means that you will transfer the difference between levelsyiandxito transfer levelxi. Print the pairs in the order of transferring levels. The levels are numbered 1 throughkin the order they follow in the input.If there are multiple optimal solutions, you can print any of them.ExamplesInput2 3 3 2A.A...A.a..CX.Y...Output141 02 13 1Input1 1 4 1A.B.Output31 02 04 23 0Input1 3 5 2ABABBBBBABABABBOutput111 03 12 34 25 1",
    "source": "CF",
    "vjudge": false
}