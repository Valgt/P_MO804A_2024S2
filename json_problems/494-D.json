{
    "uid": "494-D",
    "url": "https://codeforces.com/contest/494/problem/D",
    "tags": [
        "data structures",
        " dfs and similar",
        " dp",
        " trees"
    ],
    "title": "494-D",
    "statement": "D. Birthdaytime limit per test2 secondsmemory limit per test256 megabytesinputstdinoutputstdoutAli is Hamed's little brother and tomorrow is his birthday. Hamed wants his brother to earn his gift so he gave him a hard programming problem and told him if he can successfully solve it, he'll get him a brand new laptop. Ali is not yet a very talented programmer like Hamed and although he usually doesn't cheat but this time is an exception. It's about a brand new laptop. So he decided to secretly seek help from you. Please solve this problem for Ali.Ann-vertex weighted rooted tree is given. Vertex number1is a root of the tree. We defined(u,v)as the sum of edges weights on the shortest path between verticesuandv. Specifically we defined(u,u) = 0. Also let's defineS(v)for each vertexvas a set containing all verticesusuch thatd(1,u) =d(1,v) +d(v,u). Functionf(u,v)is then defined using the following formula:The goal is to calculatef(u,v)for each of theqgiven pair of vertices. As the answer can be rather large it's enough to print it modulo109+ 7.InputIn the first line of input an integern(1 ≤n≤ 105), number of vertices of the tree is given.In each of the nextn- 1lines three space-separated integersai,bi,ci(1 ≤ai,bi≤n,1 ≤ci≤ 109) are given indicating an edge betweenaiandbiwith weight equal toci.In the next line an integerq(1 ≤q≤ 105), number of vertex pairs, is given.In each of the nextqlines two space-separated integersui,vi(1 ≤ui,vi≤n) are given meaning that you must calculatef(ui,vi).It is guaranteed that the given edges form a tree.OutputOutputqlines. In thei-th line print the value off(ui,vi)modulo109+ 7.ExamplesInput51 2 14 3 13 5 11 3 151 11 52 42 13 5Output1010000000051000000002231000000002Input81 2 1001 3 202 4 22 5 13 6 13 7 26 8 561 82 35 82 64 76 1Output9999687534979699996127199999123599995856945130",
    "source": "CF",
    "vjudge": false
}