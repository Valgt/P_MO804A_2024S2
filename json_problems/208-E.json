{
    "uid": "208-E",
    "url": "https://codeforces.com/contest/208/problem/E",
    "tags": [
        "binary search",
        " data structures",
        " dfs and similar",
        " trees"
    ],
    "title": "208-E",
    "statement": "E. Blood Cousinstime limit per test2 secondsmemory limit per test256 megabytesinputstdinoutputstdoutPolycarpus got hold of a family relationship tree. The tree describes family relationships ofnpeople, numbered 1 throughn. Each person in the tree has no more than one parent.Let's call personaa 1-ancestor of personb, ifais the parent ofb.Let's call personaak-ancestor(k> 1)of personb, if personbhas a 1-ancestor, andais a(k- 1)-ancestor ofb's 1-ancestor.Family relationships don't form cycles in the found tree. In other words, there is no person who is his own ancestor, directly or indirectly (that is, who is anx-ancestor for himself, for somex,x> 0).Let's call two peoplexandy(x≠y)p-th cousins(p> 0), if there is personz, who is ap-ancestor ofxand ap-ancestor ofy.Polycarpus wonders how many counsins and what kinds of them everybody has. He took a piece of paper and wrotempairs of integersvi,pi. Help him to calculate the number ofpi-th cousins that personvihas, for each pairvi,pi.InputThe first input line contains a single integern(1 ≤n≤ 105)— the number of people in the tree. The next line containsnspace-separated integersr1,r2, ...,rn, whereri(1 ≤ri≤n)is the number of personi's parent or0, if personihas no parent. It is guaranteed that family relationships don't form cycles.The third line contains a single numberm(1 ≤m≤ 105)— the number of family relationship queries Polycarus has. Nextmlines contain pairs of space-separated integers. Thei-th line contains numbersvi,pi(1 ≤vi,pi≤n).OutputPrintmspace-separated integers — the answers to Polycarpus' queries. Print the answers to the queries in the order, in which the queries occur in the input.ExamplesInput60 1 1 0 4 471 11 22 12 24 15 16 1Output0 0 1 0 0 1 1",
    "source": "CF",
    "vjudge": false
}