{
    "uid": "327-E",
    "url": "https://codeforces.com/contest/327/problem/E",
    "tags": [
        "bitmasks",
        " combinatorics",
        " constructive algorithms",
        " dp",
        " meet-in-the-middle"
    ],
    "title": "327-E",
    "statement": "E. Axis Walkingtime limit per test3 secondsmemory limit per test512 megabytesinputstdinoutputstdoutIahub wants to meet his girlfriend Iahubina. They both live inOxaxis (the horizontal axis). Iahub lives at point 0 and Iahubina at pointd.Iahub hasnpositive integersa1,a2, ...,an. The sum of those numbers isd. Supposep1,p2, ...,pnis a permutation of{1, 2, ...,n}. Then, letb1=ap1,b2=ap2and so on. The array b is called a \"route\". There aren!different routes, one for each permutationp.Iahub's travel schedule is: he walksb1steps onOxaxis, then he makes a break in pointb1. Then, he walksb2more steps onOxaxis and makes a break in pointb1+b2. Similarly, atj-th(1 ≤j≤n)time he walksbjmore steps onOxaxis and makes a break in pointb1+b2+ ... +bj.Iahub is very superstitious and haskintegers which give him bad luck. He calls a route \"good\" if he never makes a break in a point corresponding to one of thoseknumbers. For his own curiosity, answer how many good routes he can make, modulo1000000007(109+ 7).InputThe first line contains an integern(1 ≤n≤ 24). The following line containsnintegers:a1,a2, ...,an(1 ≤ai≤ 109).The third line contains integerk(0 ≤k≤ 2). The fourth line containskpositive integers, representing the numbers that give Iahub bad luck. Each of these numbers does not exceed109.OutputOutput a single integer — the answer of Iahub's dilemma modulo1000000007(109+ 7).ExamplesInput32 3 525 7Output1Input32 2 221 3Output6NoteIn the first case consider six possible orderings:[2, 3, 5]. Iahub will stop at position 2, 5 and 10. Among them, 5 is bad luck for him.[2, 5, 3]. Iahub will stop at position 2, 7 and 10. Among them, 7 is bad luck for him.[3, 2, 5]. He will stop at the unlucky 5.[3, 5, 2]. This is a valid ordering.[5, 2, 3]. He got unlucky twice (5 and 7).[5, 3, 2]. Iahub would reject, as it sends him to position 5.In the second case, note that it is possible that two different ways have the identical set of stopping. In fact, all six possible ways have the same stops: [2, 4, 6], so there's no bad luck for Iahub.",
    "source": "CF",
    "vjudge": false
}