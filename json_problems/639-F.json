{
    "uid": "639-F",
    "url": "https://codeforces.com/contest/639/problem/F",
    "tags": [
        "data structures",
        " dfs and similar",
        " graphs",
        " trees"
    ],
    "title": "639-F",
    "statement": "F. Bear and Chemistrytime limit per test6 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputLimak is a smart brown bear who loves chemistry, reactions and transforming elements.In Bearland (Limak's home) there arenelements, numbered1throughn. There are also special machines, that can transform elements. Each machine is described by two integersai,birepresenting two elements, not necessarily distinct. One can use a machine either to transform an elementaitobior to transformbitoai. Machines in Bearland aren't very resistant and each of them can be usedat most once. It is possible thatai=biand that many machines have the same pairai,bi.Radewoosh is Limak's biggest enemy and rival. He wants to test Limak in the chemistry. They will meet tomorrow and both of them will bring all their machines. Limak hasmmachines but he doesn't know much about his enemy. They agreed Radewoosh will choose two distinct elements, let's denote them asxandy. Limak will be allowed to use both his and Radewoosh's machines. He may use zero or more (maybe even all) machines to achieve the goal, each machine at most once. Limak will start from an elementxand his task will be to first get an elementyand then to again get an elementx—then we say that he succeeds. After that Radewoosh would agree that Limak knows the chemistry (and Radewoosh would go away).Radewoosh likes some particular non-empty set of favorite elements and he will choosex,yfrom that set. Limak doesn't know exactly which elements are in the set and also he doesn't know what machines Radewoosh has. Limak has heardqgossips (queries) though and each of them consists of Radewoosh's machines and favorite elements. For each gossip Limak wonders if he would be able tosucceedtomorrow for every pairx,ychosen from the set of favorite elements. If yes then print \"YES\" (without the quotes). But if there exists a pair(x,y)from the given set that Limak wouldn't be able to succeed then you should print \"NO\" (without the quotes).InputThe first line contains three integersn,mandq(1 ≤n,q≤ 300 000, 0 ≤m≤ 300 000) — the number of elements, the number of Limak's machines and the number of gossips, respectively.Each of the nextmlines contains two integersaiandbi(1 ≤ai,bi≤n) describing one of Limak's machines.Then, the description ofqgossips follows.The first line of the description of thei-th gossip contains two integersniandmi(1 ≤ni≤ 300 000, 0 ≤mi≤ 300 000). The second line containsnidistinctintegersxi, 1,xi, 2, ...,xi,ni(1 ≤xi,j≤n) — Radewoosh's favorite elements in thei-th gossip. Note thatni= 1is allowed, in this case there are no pairs of distinct elements, so Limak automatically wins (the answer is \"YES\"). Thenmilines follow, each containing two integersai,j,bi,j(1 ≤ai,j,bi,j) describing one of Radewoosh's machines in thei-th gossip.The sum ofniover all gossips won't exceed300 000. Also, the sum ofmiover all gossips won't exceed300 000.Important:Because we want you to process the gossips online, in order to know the elements in Radewoosh's favorite set and elements that his machines can transform, for on each number that denotes them in the input you should use following function:int rotate(int element){element=(element+R)%n;if (element==0) {element=n;}return element;}whereRis initially equal to0and is increased by the number of the query any time the answer is \"YES\". Queries are numbered starting with1in the order they appear in the input.OutputYou should printqlines. Thei-th of them should contain \"YES\" (without quotes) if for thei-th gossipfor each pairof elementsxandy(in the setxi, 1,xi, 2, ...,xi,ni) Limak is able to succeed. Otherwise you should print \"NO\" (without quotes).ExamplesInput6 5 41 22 33 42 45 62 04 22 16 23 43 26 3 42 54 62 11 21 2OutputYESNOYESYESInput7 6 21 21 32 42 53 63 77 21 2 3 4 5 6 74 56 77 21 2 3 4 5 6 74 65 7OutputNOYESNoteLets look at first sample:In first gossip Radewoosh's favorite set is{4, 2}and he has no machines. Limak can tranform element4into2(so half of a task is complete) and then2into3, and3into4. Answer is \"YES\", soRis increased by1.In second gossip set in the input is denoted by{6, 2}and machine by(3, 4), butRis equal to1, so set is{1, 3}and machine is(4, 5). Answer is \"NO\", soRisn't changed.In third gossip set{6, 4, 3}and machines(2, 5)and(4, 6)are deciphered to be{1, 5, 4},(3, 6)and(5, 1).Consider Radewoosh's choices:If he chooses elements1and5, then Limak is able to transform1into5, then6into3,3into2and2into1.If he chooses elements5and4, then Limak is able to transform5into6,6into3,3into4(half way already behind him),4into2,2into1,1into5.If he chooses elements1and4, then Limak is able to transform1into2,2into4,4into3,3into6,6into5and5into1.So Limak is able to execute task. Answer is \"YES\" andRis increased by3(it's equal to4now).In last gossip{1, 2}and(1, 2)are deciphered to be{5, 6}and(5, 6). Now there are2machines(5, 6)so Limak is able to execute task again.",
    "source": "CF",
    "vjudge": false
}