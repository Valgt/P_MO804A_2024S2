{
    "uid": "794-G",
    "url": "https://codeforces.com/contest/794/problem/G",
    "tags": [
        "combinatorics",
        " dp",
        " math"
    ],
    "title": "794-G",
    "statement": "G. Replace Alltime limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputIgor the analyst is at work. He learned about a feature in his text editor called \"Replace All\". Igor is too bored at work and thus he came up with the following problem:Given two stringsxandywhich consist of the English letters 'A' and 'B' only, a pair of strings(s,t)is calledgoodif:sandtconsist of the characters '0' and '1' only.1 ≤ |s|, |t| ≤n, where|z|denotes the length of stringz, andnis a fixed positive integer.If we replace all occurrences of 'A' inxandywith the strings, and replace all occurrences of 'B' inxandywith the stringt, then the two obtained fromxandystrings are equal.For example, ifx=AAB,y=BBandn= 4, then (01,0101) is one of good pairs of strings, because both obtained after replacing strings are \"01010101\".Theflexibilityof a pair of stringsxandyis the number of pairs of good strings(s,t). The pairs are ordered, for example the pairs(0,1)and(1,0)are different.You're given two stringscandd. They consist of characters 'A', 'B' and '?' only. Find the sum of flexibilities of all possible pairs of strings(c',d')such thatc'andd'can be obtained fromcanddrespectively by replacing the question marks with either 'A' or 'B', modulo109+ 7.InputThe first line contains the stringc(1 ≤ |c| ≤ 3·105).The second line contains the stringd(1 ≤ |d| ≤ 3·105).The last line contains a single integern(1 ≤n≤ 3·105).OutputOutput a single integer: the answer to the problem, modulo109+ 7.ExamplesInputA??3Output2InputAB10Output2046NoteFor the first sample, there are four possible pairs of(c',d').If(c',d') = (AA,A), then the flexibility is0.If(c',d') = (AB,A), then the flexibility is0.If(c',d') = (AA,B), then the flexibility is2, as the pairs of binary strings(1,11),(0,00)are the only good pairs.If(c',d') = (AB,B), then the flexibility is0.Thus, the total flexibility is2.For the second sample, there are21+ 22+ ... + 210= 2046possible binary strings of length not greater10, and the set of pairs of good strings is precisely the set of pairs(s,s), wheresis a binary string of length not greater than10.",
    "source": "CF",
    "vjudge": false
}