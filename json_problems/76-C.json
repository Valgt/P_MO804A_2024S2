{
    "uid": "76-C",
    "url": "https://codeforces.com/contest/76/problem/C",
    "tags": [
        "bitmasks",
        " dp",
        " math"
    ],
    "title": "76-C",
    "statement": "C. Mutationtime limit per test1 secondmemory limit per test256 megabytesinputstdinoutputstdoutScientists of planet Olympia are conducting an experiment in mutation of primitive organisms. Genome of organism from this planet can be represented as a string of the firstKcapital English letters. For each pair of types of genes they assignedai,j— a risk of disease occurence in the organism provided that genes of these types are adjacent in the genome, wherei— the 1-based index of the first gene andj— the index of the second gene. The gene 'A' has index 1, 'B' has index 2 and so on. For example,a3, 2stands for the risk of 'CB' fragment. Risk of disease occurence in the organism is equal to the sum of risks for each pair of adjacent genes in the genome.Scientists have already obtained a base organism. Some new organisms can be obtained by mutation of this organism. Mutation involves removal of all genes of some particular types. Such removal increases the total risk of disease occurence additionally. For each type of genes scientists determinedti— the increasement of the total risk of disease occurence provided by removal of all genes having type with indexi. For example,t4stands for the value of additional total risk increasement in case of removing all the 'D' genes.Scientists want to find a number of different organisms that can be obtained from the given one which have the total risk of disease occurence not greater thanT. They can use only the process of mutation described above. Two organisms are considered different if strings representing their genomes are different. Genome should contain at least one gene.InputThe first line of the input contains three integer numbersN(1 ≤N≤ 200 000) — length of the genome of base organism,K(1 ≤K≤ 22) — the maximal index of gene type in the genome andT(1 ≤T≤ 2·109) — maximal allowable risk of disease occurence. The second line contains the genome of the given organism. It is a string of the firstKcapital English letters having lengthN.The third line containsKnumberst1,t2, ...,tK, wheretiis additional risk value of disease occurence provided by removing of all genes of thei-th type.The followingKlines contain the elements of the given matrixai,j. Thei-th line containsKnumbers. Thej-th number of thei-th line stands for a risk of disease occurence for the pair of genes, first of which corresponds to thei-th letter and second of which corresponds to thej-th letter. The given matrix isnotnecessarily symmetrical.All the numbers in the input are integer, non-negative and all of them exceptTare not greater than109. It is guaranteed that the maximal possible risk of organism that can be obtained from the given organism is strictly smaller than231.OutputOutput the number of organisms that can be obtained from the base one and which have the total risk of disease occurence not greater thanT.ExamplesInput5 3 13BACAC4 1 21 2 32 3 43 4 10Output5NoteExplanation: one can obtain the following organisms (risks are stated in brackets): BACAC (11), ACAC (10), BAA (5), B (6), AA (4).",
    "source": "CF",
    "vjudge": false
}