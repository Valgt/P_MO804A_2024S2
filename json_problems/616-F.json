{
    "uid": "616-F",
    "url": "https://codeforces.com/contest/616/problem/F",
    "tags": [
        "data structures",
        " sortings",
        " string suffix structures",
        " strings"
    ],
    "title": "616-F",
    "statement": "F. Expensive Stringstime limit per test6 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputYou are givennstringsti. Each string has costci.Let's define the function of string, whereps,iis the number of occurrences ofsinti,|s|is the length of the strings. Find the maximal value of functionf(s)over all strings.Note that the stringsis not necessarily some string fromt.InputThe first line contains the only integern(1 ≤n≤ 105) — the number of strings int.Each of the nextnlines contains contains a non-empty stringti.ticontains only lowercase English letters.It is guaranteed that the sum of lengths of all strings intis not greater than5·105.The last line containsnintegersci(- 107≤ci≤ 107) — the cost of thei-th string.OutputPrint the only integera— the maximal value of the functionf(s)over all stringss. Note one more time that the stringsis not necessarily fromt.ExamplesInput2aabb2 1Output4Input2aaab2 1Output5",
    "source": "CF",
    "vjudge": false
}