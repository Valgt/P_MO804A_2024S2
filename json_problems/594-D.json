{
    "uid": "594-D",
    "url": "https://codeforces.com/contest/594/problem/D",
    "tags": [
        "data structures",
        " number theory"
    ],
    "title": "594-D",
    "statement": "D. REQtime limit per test3 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputToday on a math lesson the teacher told Vovochka that the Euler function of a positive integerφ(n)is an arithmetic function that counts the positive integers less than or equal to n that are relatively prime to n. The number1is coprime to all the positive integers andφ(1) = 1.Now the teacher gave Vovochka an array ofnpositive integersa1,a2, ...,anand a task to processqqueriesliri— to calculate and printmodulo109+ 7. As it is too hard for a second grade school student, you've decided to help Vovochka.InputThe first line of the input contains numbern(1 ≤n≤ 200 000) — the length of the array given to Vovochka. The second line containsnintegersa1,a2, ...,an(1 ≤ai≤ 106).The third line contains integerq(1 ≤q≤ 200 000) — the number of queries. Nextqlines contain the queries, one per line. Each query is defined by the boundaries of the segmentliandri(1 ≤li≤ri≤n).OutputPrintqnumbers — the value of the Euler function for each query, calculated modulo109+ 7.ExamplesInput101 2 3 4 5 6 7 8 9 1071 13 85 64 88 107 97 10Output14608815361921441152Input724 63 13 52 6 10 163 54 71 72 43 62 6Output124876812939264112329984539136NoteIn the second sample the values are calculated like that:φ(13·52·6) = φ(4056) = 1248φ(52·6·10·1) = φ(3120) = 768φ(24·63·13·52·6·10·1) = φ(61326720) = 12939264φ(63·13·52) = φ(42588) = 11232φ(13·52·6·10) = φ(40560) = 9984φ(63·13·52·6·10) = φ(2555280) = 539136",
    "source": "CF",
    "vjudge": false
}