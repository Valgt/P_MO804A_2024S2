{
    "uid": "883-B",
    "url": "https://codeforces.com/contest/883/problem/B",
    "tags": [
        "constructive algorithms",
        " graphs",
        " greedy"
    ],
    "title": "883-B",
    "statement": "B. Berland Armytime limit per test3 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputThere arenmilitary men in the Berland army. Some of them have given orders to other military men by now. Givenmpairs (xi,yi), meaning that the military manxigave thei-th order to another military manyi.It is time for reform! The Berland Ministry of Defence plans to introduce ranks in the Berland army. Each military man should be assigned a rank — integer number between1andk, inclusive. Some of them have been already assigned a rank, but the rest of them should get a rank soon.Help the ministry to assign ranks to the rest of the army so that:for each ofmorders it is true that the rank of a person giving the order (military manxi) is strictly greater than the rank of a person receiving the order (military manyi);for each rank from1tokthere is at least one military man with this rank.InputThe first line contains three integersn,mandk(1 ≤n≤ 2·105,0 ≤m≤ 2·105,1 ≤k≤ 2·105) — number of military men in the Berland army, number of orders and number of ranks.The second line containsnintegersr1,r2, ...,rn, whereri> 0(in this case1 ≤ri≤k) means that thei-th military man has been already assigned the rankri;ri= 0means thei-th military man doesn't have a rank yet.The followingmlines contain orders one per line. Each order is described with a line containing two integersxi,yi(1 ≤xi,yi≤n,xi≠yi). This line means that thei-th order was given by the military manxito the military manyi. For each pair(x,y)of military men there could be several orders fromxtoy.OutputPrintnintegers, where thei-th number is the rank of thei-th military man. If there are many solutions, print any of them.If there is no solution, print the only number-1.ExamplesInput5 3 30 3 0 0 22 43 43 5Output1 3 3 2 2Input7 6 50 4 5 4 1 0 06 13 63 17 57 17 4Output2 4 5 4 1 3 5Input2 2 22 11 22 1Output-1",
    "source": "CF",
    "vjudge": false
}