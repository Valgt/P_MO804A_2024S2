{
    "uid": "500-D",
    "url": "https://codeforces.com/contest/500/problem/D",
    "tags": [
        "combinatorics",
        " dfs and similar",
        " graphs",
        " trees"
    ],
    "title": "500-D",
    "statement": "D. New Year Santa Networktime limit per test2 secondsmemory limit per test256 megabytesinputstdinoutputstdoutNew Year is coming in Tree World! In this world, as the name implies, there arencities connected byn- 1roads, and for any two distinct cities there always exists a path between them. The cities are numbered by integers from 1 ton, and the roads are numbered by integers from1ton- 1. Let's defined(u,v)as total length of roads on the path between cityuand cityv.As an annual event, people in Tree World repairs exactly one road per year. As a result, the length of one road decreases. It is already known that in thei-th year, the length of theri-th road is going to becomewi, which is shorter than its length before. Assume that the current year is year1.Three Santas are planning to give presents annually to all the children in Tree World. In order to do that, they need some preparation, so they are going to choose three distinct citiesc1,c2,c3and make exactly one warehouse in each city. Thek-th (1 ≤k≤ 3) Santa will take charge of the warehouse in cityck.It is really boring for the three Santas to keep a warehouse alone. So, they decided to build an only-for-Santa network! The cost needed to build this network equals tod(c1,c2) +d(c2,c3) +d(c3,c1)dollars. Santas are too busy to find the best place, so they decided to choosec1,c2,c3randomly uniformly over all triples of distinct numbers from1ton. Santas would like to know the expected value of the cost needed to build the network.However, as mentioned, each year, the length of exactly one road decreases. So, the Santas want to calculate the expected after each length change. Help them to calculate the value.InputThe first line contains an integern(3 ≤n≤ 105) — the number of cities in Tree World.Nextn- 1lines describe the roads. Thei-th line of them (1 ≤i≤n- 1) contains three space-separated integersai,bi,li(1 ≤ai,bi≤n,ai≠bi,1 ≤li≤ 103), denoting that thei-th road connects citiesaiandbi, and the length ofi-th road isli.The next line contains an integerq(1 ≤q≤ 105) — the number of road length changes.Nextqlines describe the length changes. Thej-th line of them (1 ≤j≤q) contains two space-separated integersrj,wj(1 ≤rj≤n- 1,1 ≤wj≤ 103). It means that in thej-th repair, the length of therj-th road becomeswj. It is guaranteed thatwjis smaller than the current length of therj-th road. The same road can be repaired several times.OutputOutputqnumbers. For each given change, print a line containing the expected cost needed to build the network in Tree World. The answer will be considered correct if its absolute and relative error doesn't exceed10- 6.ExamplesInput32 3 51 3 351 42 21 22 11 1Output14.000000000012.00000000008.00000000006.00000000004.0000000000Input61 5 35 3 26 1 71 4 45 2 351 22 13 54 15 2Output19.600000000018.600000000016.600000000013.600000000012.6000000000NoteConsider the first sample. There are 6 triples:(1, 2, 3), (1, 3, 2), (2, 1, 3), (2, 3, 1), (3, 1, 2), (3, 2, 1). Becausen= 3, the cost needed to build the network is alwaysd(1, 2) +d(2, 3) +d(3, 1)for all the triples. So, the expected cost equals tod(1, 2) +d(2, 3) +d(3, 1).",
    "source": "CF",
    "vjudge": false
}