{
    "uid": "722-E",
    "url": "https://codeforces.com/contest/722/problem/E",
    "tags": [
        "combinatorics",
        " dp"
    ],
    "title": "722-E",
    "statement": "E. Research Rovertime limit per test2.5 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputUnfortunately, the formal description of the task turned out to be too long, so here is the legend.Research rover finally reached the surface of Mars and is ready to complete its mission. Unfortunately, due to the mistake in the navigation system design, the rover is located in the wrong place.The rover will operate on the grid consisting ofnrows andmcolumns. We will define as(r,c)the cell located in the rowrand columnc. From each cell the rover is able to move to any cell that share a side with the current one.The rover is currently located at cell(1, 1)and has to move to the cell(n,m). It will randomly follow someshortest pathbetween these two cells. Each possible way is chosen equiprobably.The cargo section of the rover contains the battery required to conduct the research. Initially, the battery charge is equal tosunits of energy.Some of the cells contain anomaly. Each time the rover gets to the cell with anomaly, the battery looses half of its charge rounded down. Formally, if the charge was equal toxbefore the rover gets to the cell with anomaly, the charge will change to.While the rover picks a random shortest path to proceed, compute the expected value of the battery charge after it reaches cell(n,m). If the cells(1, 1)and(n,m)contain anomaly, they also affect the charge of the battery.InputThe first line of the input contains four integersn,m,kands(1 ≤n,m≤ 100 000,0 ≤k≤ 2000,1 ≤s≤ 1 000 000) — the number of rows and columns of the field, the number of cells with anomaly and the initial charge of the battery respectively.The followklines containing two integersriandci(1 ≤ri≤n,1 ≤ci≤m) — coordinates of the cells, containing anomaly. It's guaranteed that each cell appears in this list no more than once.OutputThe answer can always be represented as an irreducible fraction. Print the only integerP·Q- 1modulo109+ 7.ExamplesInput3 3 2 112 12 3Output333333342Input4 5 3 171 23 34 1Output514285727Input1 6 2 151 11 5Output4NoteIn the first sample, the rover picks one of the following six routes:, after passing cell(2, 3)charge is equal to6., after passing cell(2, 3)charge is equal to6., charge remains unchanged and equals11., after passing cells(2, 1)and(2, 3)charge equals6and then3., after passing cell(2, 1)charge is equal to6., after passing cell(2, 1)charge is equal to6.Expected value of the battery charge is calculated by the following formula:.ThusP= 19, andQ= 3.3- 1modulo109+ 7equals333333336.19·333333336 = 333333342 (mod109+ 7)",
    "source": "CF",
    "vjudge": false
}