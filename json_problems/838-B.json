{
    "uid": "838-B",
    "url": "https://codeforces.com/contest/838/problem/B",
    "tags": [
        "data structures",
        " dfs and similar",
        " trees"
    ],
    "title": "838-B",
    "statement": "B. Diverging Directionstime limit per test3 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputYou are given a directed weighted graph withnnodes and2n- 2edges. The nodes are labeled from1ton, while the edges are labeled from1to2n- 2. The graph's edges can be split into two parts.The firstn- 1edges will form a rooted spanning tree, with node1as the root. All these edges will point away from the root.The lastn- 1edges will be from nodeito node1, for all2 ≤i≤n.You are givenqqueries. There are two types of queries1iw: Change the weight of thei-th edge tow2uv: Print the length of the shortest path between nodesutovGiven these queries, print the shortest path lengths.InputThe first line of input will contain two integersn,q(2 ≤n,q≤ 200 000), the number of nodes, and the number of queries, respectively.The next2n- 2integers will contain 3 integersai,bi,ci, denoting a directed edge from nodeaito nodebiwith weightci.The firstn- 1of these lines will describe a rooted spanning tree pointing away from node1, while the lastn- 1of these lines will havebi= 1.More specifically,The edges(a1,b1), (a2,b2), ... (an- 1,bn- 1)will describe a rooted spanning tree pointing away from node1.bj= 1forn≤j≤ 2n- 2.an,an+ 1, ...,a2n- 2will be distinct and between2andn.The nextqlines will contain 3 integers, describing a query in the format described in the statement.All edge weights will be between1and106.OutputFor each type 2 query, print the length of the shortest path in its own line.ExampleInput5 91 3 13 2 21 4 33 5 45 1 53 1 62 1 74 1 82 1 12 1 32 3 52 5 21 1 1002 1 31 8 302 4 22 2 4Output014810013210",
    "source": "CF",
    "vjudge": false
}