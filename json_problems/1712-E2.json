{
    "uid": "1712-E2",
    "url": "https://codeforces.com/contest/1712/problem/E2",
    "tags": [
        "brute force",
        " data structures",
        " math",
        " number theory",
        " two pointers"
    ],
    "title": "1712-E2",
    "statement": "E2. LCM Sum (hard version)time limit per test3.5 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputWe are sum for we are manySome NumberThis version of the problem differs from the previous one only in the constraint on $$$t$$$. You can make hacks only if both versions of the problem are solved.You are given two positive integers $$$l$$$ and $$$r$$$.Count the number of distinct triplets of integers $$$(i, j, k)$$$ such that $$$l \\\\le i < j < k \\\\le r$$$ and $$$\\\\operatorname{lcm}(i,j,k) \\\\ge i + j + k$$$.Here $$$\\\\operatorname{lcm}(i, j, k)$$$ denotes theleast common multiple (LCM)of integers $$$i$$$, $$$j$$$, and $$$k$$$.InputEach test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$\\\\bf{1 \\\\le t \\\\le 10^5}$$$). Description of the test cases follows.The only line for each test case contains two integers $$$l$$$ and $$$r$$$ ($$$1 \\\\le l \\\\le r \\\\le 2 \\\\cdot 10^5$$$, $$$l + 2 \\\\le r$$$).OutputFor each test case print one integer — the number of suitable triplets.ExampleInput51 43 58 8668 866 86868Output3 1 78975 969 109229059713337NoteIn the first test case, there are $$$3$$$ suitable triplets:$$$(1,2,3)$$$,$$$(1,3,4)$$$,$$$(2,3,4)$$$.In the second test case, there is $$$1$$$ suitable triplet:$$$(3,4,5)$$$.",
    "source": "CF",
    "vjudge": false
}