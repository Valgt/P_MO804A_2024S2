{
    "uid": "780-G",
    "url": "https://codeforces.com/contest/780/problem/G",
    "tags": [
        "data structures",
        " dp"
    ],
    "title": "780-G",
    "statement": "G. Andryusha and Nervous Barrierstime limit per test4 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputAndryusha has found a perplexing arcade machine. The machine is a vertically adjusted board divided into square cells. The board haswcolumns numbered from1towfrom left to right, andhrows numbered from1tohfrom the bottom to the top.Further, there are barriers in some of board rows. There arenbarriers in total, andi-th of them occupied the cellslithroughriof the rowui. Andryusha recollects well that no two barriers share the same row. Furthermore, no row is completely occupied with a barrier, that is, at least one cell in each row is free.The player can throw a marble to any column of the machine from above. A marble falls downwards until it encounters a barrier, or falls through the bottom of the board. A marble disappears once it encounters a barrier but is replaced by two more marbles immediately to the left and to the right of the same barrier. In a situation when the barrier is at an edge of the board, both marbles appear next to the barrier at the side opposite to the edge. More than one marble can occupy the same place of the board, without obstructing each other's movement. Ultimately, all marbles are bound to fall from the bottom of the machine.Examples of marble-barrier interaction.Peculiarly, sometimes marbles can go through barriers as if they were free cells. That is so because the barriers are in fact alive, and frightened when a marble was coming at them from a very high altitude. More specifically, if a marble falls towards the barrierifrom relative height more thansi(that is, it started its fall strictly higher thanui+si), then the barrier evades the marble. If a marble is thrown from the top of the board, it is considered to appear at height(h+ 1).Andryusha remembers to have thrown a marble once in each of the columns. Help him find the total number of marbles that came down at the bottom of the machine. Since the answer may be large, print it modulo109+ 7.InputThe first line contains three integersh,w, andn(1 ≤h≤ 109,2 ≤w≤ 105,0 ≤n≤ 105) — the number of rows, columns, and barriers in the machine respectively.Nextnlines describe barriers.i-th of these lines containts four integersui,li,ri, andsi(1 ≤ui≤h,1 ≤li≤ri≤w,1 ≤si≤ 109) — row index, leftmost and rightmost column index ofi-th barrier, and largest relative fall height such that the barrier does not evade a falling marble. It is guaranteed that each row has at least one free cell, and that alluiare distinct.OutputPrint one integer — the answer to the problem modulo109+ 7.ExamplesInput10 5 13 2 3 10Output7Input10 5 23 1 3 105 3 5 10Output16Input10 5 23 1 3 75 3 5 10Output14Input10 15 47 3 9 56 4 10 11 1 4 104 11 11 20Output53NoteIn the first sample case, there is a single barrier: if one throws a marble in the second or the third column, two marbles come out, otherwise there is only one. The total answer is7.In the second sample case, the numbers of resulting marbles are2,2,4,4,4in order of indexing columns with the initial marble.In the third sample case, the numbers of resulting marbles are1,1,4,4,4. Note that the first barrier evades the marbles falling from the top of the board, but does not evade the marbles falling from the second barrier.In the fourth sample case, the numbers of resulting marbles are2,2,6,6,6,6,6,6,6,1,2,1,1,1,1. The picture below shows the case when a marble is thrown into the seventh column.The result of throwing a marble into the seventh column.",
    "source": "CF",
    "vjudge": false
}