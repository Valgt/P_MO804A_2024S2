{
    "uid": "348-E",
    "url": "https://codeforces.com/contest/348/problem/E",
    "tags": [
        "dfs and similar",
        " dp",
        " trees"
    ],
    "title": "348-E",
    "statement": "E. Pilgrimstime limit per test2 secondsmemory limit per test256 megabytesinputstdinoutputstdoutA long time ago there was a land called Dudeland. Dudeland consisted ofntowns connected withn- 1bidirectonal roads. The towns are indexed from1tonand one can reach any city from any other city if he moves along the roads of the country. There aremmonasteries in Dudeland located inmdifferent towns. In each monastery lives a pilgrim.At the beginning of the year, each pilgrim writes down which monastery is the farthest from the monastery he is living in. If there is more than one farthest monastery, he lists all of them. On the Big Lebowski day each pilgrim picks one town from his paper at random and starts walking to that town.Walter hates pilgrims and wants to make as many of them unhappy as possible by preventing them from finishing their journey. He plans to destroy exactly one town that does not contain a monastery. A pilgrim becomes unhappy if all monasteries in his list become unreachable from the monastery he is living in.You need to find the maximum number of pilgrims Walter can make unhappy. Also find the number of ways he can make this maximal number of pilgrims unhappy: the number of possible towns he can destroy.InputThe first line contains two integersn(3 ≤n≤ 105) andm(2 ≤m<n). The next line containsmdistinct integers representing indices of towns that contain monasteries.Nextn- 1lines contain three integers each,ai,bi,ci, indicating that there is an edge between townsaiandbiof lengthci(1 ≤ai,bi≤n, 1 ≤ci≤ 1000,ai≠bi).OutputOutput two integers: the maximum number of pilgrims Walter can make unhappy and the number of ways in which he can make his plan come true.ExamplesInput8 57 2 5 4 81 2 12 3 21 4 14 5 21 6 16 7 86 8 10Output5 1",
    "source": "CF",
    "vjudge": false
}