{
    "uid": "543-E",
    "url": "https://codeforces.com/contest/543/problem/E",
    "tags": [
        "constructive algorithms",
        " data structures"
    ],
    "title": "543-E",
    "statement": "E. Listening to Musictime limit per test7 secondsmemory limit per test64 megabytesinputstandard inputoutputstandard outputPlease note that the memory limit differs from the standard.You really love to listen to music. During the each of nextsdays you will listen to exactlymsongs from the playlist that consists of exactlynsongs. Let's number the songs from the playlist with numbers from1ton, inclusive. The quality of song numberiisai.On thei-th day you choose some integerv(li≤v≤ri) and listen to songs numberv,v+ 1, ...,v+m- 1. On thei-th day listening to one song with quality less thanqiincreases your displeasure by exactly one.Determine what minimum displeasure you can get on each of thesnext days.InputThe first line contains two positive integersn,m(1 ≤m≤n≤ 2·105). The second line containsnpositive integersa1,a2, ...,an(0 ≤ai< 230) — the description of songs from the playlist.The next line contains a single numbers(1 ≤s≤ 2·105) — the number of days that you consider.The nextslines contain three integers eachli,ri,xi(1 ≤li≤ri≤n-m+ 1;0 ≤xi< 230) — the description of the parameters for thei-th day. In order to calculate valueqi, you need to use formula:, whereansiis the answer to the problem for dayi. Assume thatans0= 0.OutputPrint exactlysintegersans1,ans2, ...,anss, whereansiis the minimum displeasure that you can get on dayi.ExamplesInput5 31 2 1 2 351 1 21 3 21 3 31 3 51 3 1Output20231",
    "source": "CF",
    "vjudge": false
}