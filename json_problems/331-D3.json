{
    "uid": "331-D3",
    "url": "https://codeforces.com/contest/331/problem/D3",
    "tags": [
        "data structures",
        " implementation",
        " trees"
    ],
    "title": "331-D3",
    "statement": "D3. Escaping on Beaveractortime limit per test6 secondsmemory limit per test512 megabytesinputstdinoutputstdoutDon't put up with what you're sick of! The Smart Beaver decided to escape from the campus of Beaver Science Academy (BSA). BSA is ab×bsquare on a plane. Each pointx,y(0 ≤x,y≤b)belongs to BSA. To make the path quick and funny, the Beaver constructed a Beaveractor, an effective and comfortable types of transport.The campus obeys traffic rules: there arenarrows, parallel to the coordinate axes. The arrows do not intersect and do not touch each other. When the Beaveractor reaches some arrow, it turns in the arrow's direction and moves on until it either reaches the next arrow or gets outside the campus. The Beaveractor covers exactly one unit of space per one unit of time. You can assume that there are no obstacles to the Beaveractor.The BSA scientists want to transport the brand new Beaveractor to the \"Academic Tractor\" research institute and send the Smart Beaver to do his postgraduate studies and sharpen pencils. They haveqplans, representing the Beaveractor's initial position(xi,yi), the initial motion vectorwiand the timetithat have passed after the escape started.Your task is for each of theqplans to determine the Smart Beaver's position after the given time.InputThe first line contains two integers: the number of traffic rulesnand the size of the campusb,0 ≤n,1 ≤b. Nextnlines contain the rules. Each line of the rules contains four space-separated integersx0,y0,x1,y1— the beginning and the end of the arrow. It is guaranteed that all arrows are parallel to the coordinate axes and have no common points. All arrows are located inside the campus, that is,0 ≤x0,y0,x1,y1≤bholds.Next line contains integerq— the number of plans the scientists have,1 ≤q≤ 105. Thei-th plan is represented by two integers,xi,yiare the Beaveractor's coordinates at the initial time,0 ≤xi,yi≤b, characterwi, that takes valueU,D,L,Rand sets the initial direction up, down, to the left or to the right correspondingly (the Y axis is directed upwards), andti— the time passed after the escape started,0 ≤ti≤ 1015.to get 30 points you need to solve the problem with constraintsn,b≤ 30(subproblem D1);to get 60 points you need to solve the problem with constraintsn,b≤ 1000(subproblems D1+D2);to get 100 points you need to solve the problem with constraintsn,b≤ 105(subproblems D1+D2+D3).OutputPrintqlines. Each line should contain two integers — the Beaveractor's coordinates at the final moment of time for each plan. If the Smart Beaver manages to leave the campus in timeti, print the coordinates of the last point in the campus he visited.ExamplesInput3 30 0 0 10 2 2 23 3 2 3120 0 L 00 0 L 10 0 L 20 0 L 30 0 L 40 0 L 50 0 L 62 0 U 22 0 U 33 0 U 51 3 D 21 3 R 2Output0 00 10 21 22 23 23 22 23 21 32 21 3",
    "source": "CF",
    "vjudge": false
}