{
    "uid": "246-E",
    "url": "https://codeforces.com/contest/246/problem/E",
    "tags": [
        "binary search",
        " data structures",
        " dfs and similar",
        " dp",
        " sortings"
    ],
    "title": "246-E",
    "statement": "E. Blood Cousins Returntime limit per test3 secondsmemory limit per test256 megabytesinputstdinoutputstdoutPolycarpus got hold of a family tree. The found tree describes the family relations ofnpeople, numbered from 1 ton. Every person in this tree has at most one direct ancestor. Also, each person in the tree has a name, the names are not necessarily unique.We call the man with a numberaa 1-ancestor of the man with a numberb, if the man with a numberais a direct ancestor of the man with a numberb.We call the man with a numberaak-ancestor(k> 1)of the man with a numberb, if the man with a numberbhas a 1-ancestor, and the man with a numberais a(k- 1)-ancestor of the 1-ancestor of the man with a numberb.In the tree the family ties do not form cycles. In other words there isn't a person who is his own direct or indirect ancestor (that is, who is anx-ancestor of himself, for somex,x> 0).We call a man with a numberathek-son of the man with a numberb, if the man with a numberbis ak-ancestor of the man with a numbera.Polycarpus is very much interested in how many sons and which sons each person has. He took a piece of paper and wrotempairs of numbersvi,ki. Help him to learn for each pairvi,kithe number of distinct names among all names of theki-sons of the man with numbervi.InputThe first line of the input contains a single integern(1 ≤n≤ 105)— the number of people in the tree. Nextnlines contain the description of people in the tree. Thei-th line contains space-separated stringsiand integerri(0 ≤ri≤n), wheresiis the name of the man with a numberi, andriis either the number of the direct ancestor of the man with a numberior0, if the man with a numberihas no direct ancestor.The next line contains a single integerm(1 ≤m≤ 105)— the number of Polycarpus's records. Nextmlines contain space-separated pairs of integers. Thei-th line contains integersvi,ki(1 ≤vi,ki≤n).It is guaranteed that the family relationships do not form cycles. The names of all people are non-empty strings, consisting of no more than 20 lowercase English letters.OutputPrintmwhitespace-separated integers — the answers to Polycarpus's records. Print the answers to the records in the order, in which the records occur in the input.ExamplesInput6pasha 0gerald 1gerald 1valera 2igor 3olesya 151 11 21 33 16 1Output22010Input6valera 0valera 1valera 1gerald 0valera 4kolya 471 11 22 12 24 15 16 1Output1000200",
    "source": "CF",
    "vjudge": false
}