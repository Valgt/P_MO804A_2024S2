{
    "uid": "486-D",
    "url": "https://codeforces.com/contest/486/problem/D",
    "tags": [
        "dfs and similar",
        " dp",
        " math",
        " trees"
    ],
    "title": "486-D",
    "statement": "D. Valid Setstime limit per test1 secondmemory limit per test256 megabytesinputstdinoutputstdoutAs you know, an undirected connected graph withnnodes andn- 1edges is called atree. You are given an integerdand a tree consisting ofnnodes. Each nodeihas a valueaiassociated with it.We call a setSof tree nodesvalidif following conditions are satisfied:Sis non-empty.Sis connected. In other words, if nodesuandvare inS, then all nodes lying on the simple path betweenuandvshould also be presented inS..Your task is to count the number of valid sets. Since the result can be very large, you must print its remainder modulo1000000007(109+ 7).InputThe first line contains two space-separated integersd(0 ≤d≤ 2000) andn(1 ≤n≤ 2000).The second line containsnspace-separated positive integersa1,a2, ...,an(1 ≤ai≤ 2000).Then the nextn- 1line each contain pair of integersuandv(1 ≤u,v≤n) denoting that there is an edge betweenuandv. It is guaranteed that these edges form a tree.OutputPrint the number of valid sets modulo1000000007.ExamplesInput1 42 1 3 21 21 33 4Output8Input0 31 2 31 22 3Output3Input4 87 8 7 5 4 6 4 101 61 25 81 33 56 73 4Output41NoteIn the first sample, there are exactly 8 valid sets:{1}, {2}, {3}, {4}, {1, 2}, {1, 3}, {3, 4}and{1, 3, 4}. Set{1, 2, 3, 4}is not valid, because the third condition isn't satisfied. Set{1, 4}satisfies the third condition, but conflicts with the second condition.",
    "source": "CF",
    "vjudge": false
}