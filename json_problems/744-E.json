{
    "uid": "744-E",
    "url": "https://codeforces.com/contest/744/problem/E",
    "tags": [
        "strings",
        " two pointers"
    ],
    "title": "744-E",
    "statement": "E. Hongcow Masters the Cyclic Shifttime limit per test5 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputHongcow's teacher heard that Hongcow had learned about the cyclic shift, and decided to set the following problem for him.You are given a list ofnstringss1,s2, ...,sncontained in the listA.A listXof strings is calledstableif the following condition holds.First, amessageis defined as a concatenation of some elements of the listX. You can use an arbitrary element as many times as you want, and you may concatenate these elements in any arbitrary order. LetSXdenote the set of of all messages you can construct from the list. Of course, this set has infinite size if your list is nonempty.Call a single messagegoodif the following conditions hold:Suppose the message is the concatenation ofkstringsw1,w2, ...,wk, where eachwiis an element ofX.Consider the|w1| + |w2| + ... + |wk|cyclic shifts of the string. Letmbe the number of these cyclic shifts of the string that are elements ofSX.A message is good if and only ifmis exactly equal tok.The listXis called stable if and only if every element ofSXis good.Letf(L)be1ifLis a stable list, and0otherwise.Find the sum off(L)whereLis a nonemptycontiguous sublistofA(there arecontiguous sublists in total).InputThe first line of input will contain a single integern(1 ≤n≤ 30), denoting the number of strings in the list.The nextnlines will each contain a stringsi().OutputPrint a single integer, the number of nonemptycontiguous subliststhat are stable.ExamplesInput4aabbbbaOutput7Input5hheellllooOutput0Input6aababbbababcOutput13NoteFor the first sample, there are10sublists to consider. Sublists [\"a\", \"ab\", \"b\"], [\"ab\", \"b\", \"bba\"], and [\"a\", \"ab\", \"b\", \"bba\"] are not stable. The other seven sublists are stable.For example,X= [\"a\", \"ab\", \"b\"] is not stable, since the message \"ab\" + \"ab\" = \"abab\" has four cyclic shifts [\"abab\", \"baba\", \"abab\", \"baba\"], which are all elements ofSX.",
    "source": "CF",
    "vjudge": false
}