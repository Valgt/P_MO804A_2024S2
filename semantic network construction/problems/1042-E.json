{"uid": "1042-E", "url": "https://codeforces.com/contest/1042/problem/E", "tags": ["dp", " math", " probabilities"], "title": "1042-E", "statement": "E. Vasya and Magic Matrixtime limit per test3 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputVasya has got a magic matrix $$$a$$$ of size $$$n \\\\times m$$$. The rows of the matrix are numbered from $$$1$$$ to $$$n$$$ from top to bottom, the columns are numbered from $$$1$$$ to $$$m$$$ from left to right. Let $$$a_{ij}$$$ be the element in the intersection of the $$$i$$$-th row and the $$$j$$$-th column.Vasya has also got a chip. Initially, the chip is in the intersection of the $$$r$$$-th row and the $$$c$$$-th column (that is, in the element $$$a_{rc}$$$). Vasya performs the following process as long as possible: among all elements of the matrix having their value less than the value of the element with the chip in it, Vasya randomly and equiprobably chooses one element and moves his chip to this element.After moving the chip, he adds to his score the square of the Euclidean distance between these elements (that is, between the element in which the chip is now and the element the chip was moved from). The process ends when there are no elements having their values less than the value of the element with the chip in it.Euclidean distance between matrix elements with coordinates $$$(i_1, j_1)$$$ and $$$(i_2, j_2)$$$ is equal to $$$\\\\sqrt{(i_1-i_2)^2 + (j_1-j_2)^2}$$$.Calculate the expected value of the Vasya's final score.It can be shown that the answer can be represented as $$$\\\\frac{P}{Q}$$$, where $$$P$$$ and $$$Q$$$ are coprime integer numbers, and $$$Q \\\\not\\\\equiv 0~(mod ~ 998244353)$$$. Print the value $$$P \\\\cdot Q^{-1}$$$ modulo $$$998244353$$$.InputThe first line of the input contains two integers $$$n$$$ and $$$m$$$ $$$(1 \\\\le n, m \\\\le 1\\\\,000)$$$ — the number of rows and the number of columns in the matrix $$$a$$$.The following $$$n$$$ lines contain description of the matrix $$$a$$$. The $$$i$$$-th line contains $$$m$$$ integers $$$a_{i1}, a_{i2}, \\\\dots, a_{im} ~ (0 \\\\le a_{ij} \\\\le 10^9)$$$.The following line contains two integers $$$r$$$ and $$$c$$$ $$$(1 \\\\le r \\\\le n, 1 \\\\le c \\\\le m)$$$ — the index of row and the index of column where the chip is now.OutputPrint the expected value of Vasya's final score in the format described in the problem statement.ExamplesInput1 41 1 2 11 3Output2Input2 31 5 72 3 11 2Output665496238NoteIn the first example, Vasya will move his chip exactly once. The expected value of the final score is equal to $$$\\\\frac{1^2 + 2^2+ 1^2}{3} = 2$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "47fec8d4", "template_md5": "35d339e4", "result": "You are given a 2D matrix of integers.  A chip starts at a specific cell in the matrix. The chip can move to any cell with a smaller value than its current cell.  \n\nEach time the chip moves, the score is increased by the square of the Euclidean distance between the old cell and the new cell.\n\nThe process continues until the chip can no longer move to a cell with a smaller value.\n\nCalculate the expected value of the final score. The answer can be expressed as a fraction P/Q, where P and Q are coprime integers and Q is not divisible by 998244353. Output the value of P * Q<sup>-1</sup> modulo 998244353."}, {"prompt_md5": "fcaab5d5", "template_md5": "465699a0", "result": "You are given a grid of numbers. A chip starts at a specific location on the grid. The chip can move to any adjacent location with a smaller number.  Each time the chip moves, a score is calculated based on the distance between the old and new locations. The process continues until the chip can no longer move. Calculate the average score achieved over many runs."}]}