{"uid": "85-C", "url": "https://codeforces.com/contest/85/problem/C", "tags": ["binary search", " dfs and similar", " probabilities", " sortings", " trees"], "title": "85-C", "statement": "C. Petya and Treetime limit per test3 secondsmemory limit per test256 megabytesinputstdinoutputstdoutOne night, having had a hard day at work, Petya saw a nightmare. There was a binary search tree in the dream. But it was not the actual tree that scared Petya. The horrifying thing was that Petya couldn't search for elements in this tree. Petya tried many times to choose key and look for it in the tree, and each time he arrived at a wrong place. Petya has been racking his brains for long, choosing keys many times, but the result was no better. But the moment before Petya would start to despair, he had an epiphany: every time he was looking for keys, the tree didn't have the key, and occured exactly one mistake. \"That's not a problem!\", thought Petya. \"Why not count the expectation value of an element, which is found when I search for the key\". The moment he was about to do just that, however, Petya suddenly woke up.Thus, you are given abinary search tree, that is a tree containing some number written in the node. This number is called thenode key. The number of children of every node of the tree is equal either to0or to2. The nodes that have0children are calledleavesand the nodes that have2children, are calledinner. An inner node has theleft child, that is the child whose key is less than the current node's key, and theright child, whose key is more than the current node's key. Also, a key of any node is strictly larger than all the keys of the left subtree of the node and strictly smaller than all the keys of the right subtree of the node.Also you are given a set ofsearch keys, all of which are distinct and differ from the node keys contained in the tree. For each key from the set its search in the tree is realised. The search is arranged like this: initially we are located in the tree root, if the key of the current node is larger that our search key, then we move to the left child of the node, otherwise we go to the right child of the node and the process is repeated. As it is guaranteed that the search key is not contained in the tree, the search will always finish in some leaf. The key lying in the leaf is declared thesearch result.It is known for sure that during the search we make a mistake in comparing exactly once, that is we go the wrong way, but we won't make any mistakes later. All possible mistakes are equiprobable, that is we should consider all such searches where exactly one mistake occurs. Your task is to find the expectation (the average value) of the search result for every search key, considering that exactly one mistake occurs in the search. That is, for a set of paths containing exactly one mistake in the given key search, you should count the average value of keys containing in the leaves of those paths.InputThe first line contains an odd integern(3 ≤n< 105), which represents the number of tree nodes. Nextnlines contain node descriptions. The(i+ 1)-th line contains two space-separated integers. The first number is the number of parent of thei-st node and the second number is the key lying in thei-th node. The next line contains an integerk(1 ≤k≤ 105), which represents the number of keys for which you should count the average value of search results containing one mistake. Nextklines contain the actual keys, one key per line.All node keys and all search keys are positive integers, not exceeding109. Alln+kkeys are distinct.All nodes are numbered from1ton. For the tree root \"-1\" (without the quote) will be given instead of the parent's node number. It is guaranteed that the correct binary search tree is given. For each node except for the root, it could be determined according to its key whether it is the left child or the right one.OutputPrintkreal numbers which are the expectations of answers for the keys specified in the input. The answer should differ from the correct one with the measure of absolute or relative error not exceeding10- 9.ExamplesInput7-1 81 41 122 22 63 103 1411Output8.0000000000Input3-1 51 31 76124689Output7.00000000007.00000000007.00000000003.00000000003.00000000003.0000000000NoteIn the first sample the search of key 1 with one error results in two paths in the trees: (1, 2, 5) and (1, 3, 6), in parentheses are listed numbers of nodes from the root to a leaf. The keys in the leaves of those paths are equal to 6 and 10 correspondingly, that's why the answer is equal to 8.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "89081c20", "template_md5": "35d339e4", "result": "You are given a binary search tree with $n$ nodes, where each node contains a unique key.  The tree satisfies the properties of a binary search tree:\n\n* The key of each node is greater than all keys in its left subtree.\n* The key of each node is less than all keys in its right subtree.\n\nYou are also given a set of $k$ search keys, each distinct from the keys in the tree.\n\nFor each search key, consider all possible searches where exactly one comparison is made incorrectly (i.e., the search goes to the wrong child).  \n\nCalculate the average value of the key found at the leaf node for all these incorrect search paths. Output the average for each search key.\n\n\n\nLet me know if you'd like me to elaborate on any part of the problem statement."}, {"prompt_md5": "c612330e", "template_md5": "465699a0", "result": "You are given a binary search tree and a set of keys.  For each key, find the average value of the leaf node reached when searching for the key, assuming exactly one wrong comparison is made during the search."}]}