{"uid": "1178-G", "url": "https://codeforces.com/contest/1178/problem/G", "tags": ["data structures", " dfs and similar"], "title": "1178-G", "statement": "G. The Awesomest Vertextime limit per test5 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputYou are given a rooted tree on $$$n$$$ vertices. The vertices are numbered from $$$1$$$ to $$$n$$$; the root is the vertex number $$$1$$$.Each vertex has two integers associated with it: $$$a_i$$$ and $$$b_i$$$. We denote the set of all ancestors of $$$v$$$ (including $$$v$$$ itself) by $$$R(v)$$$. Theawesomenessof a vertex $$$v$$$ is defined as$$$$$$\\\\left| \\\\sum_{w \\\\in R(v)} a_w\\\\right| \\\\cdot \\\\left|\\\\sum_{w \\\\in R(v)} b_w\\\\right|,$$$$$$where $$$|x|$$$ denotes the absolute value of $$$x$$$.Process $$$q$$$ queries of one of the following forms:1 v x— increase $$$a_v$$$ by a positive integer $$$x$$$.2 v— report the maximumawesomenessin the subtree of vertex $$$v$$$.InputThe first line contains two integers $$$n$$$ and $$$q$$$ ($$$1 \\\\leq n \\\\leq 2\\\\cdot 10^5, 1 \\\\leq q \\\\leq 10^5$$$) — the number of vertices in the tree and the number of queries, respectively.The second line contains $$$n - 1$$$ integers $$$p_2, p_3, \\\\dots, p_n$$$ ($$$1 \\\\leq p_i < i$$$), where $$$p_i$$$ means that there is an edge between vertices $$$i$$$ and $$$p_i$$$.The third line contains $$$n$$$ integers $$$a_1, a_2, \\\\dots, a_n$$$ ($$$-5000 \\\\leq a_i \\\\leq 5000$$$), the initial values of $$$a_i$$$ for each vertex.The fourth line contains $$$n$$$ integers $$$b_1, b_2, \\\\dots, b_n$$$ ($$$-5000 \\\\leq b_i \\\\leq 5000$$$), the values of $$$b_i$$$ for each vertex.Each of the next $$$q$$$ lines describes a query. It has one of the following forms:1 v x($$$1 \\\\leq v \\\\leq n$$$, $$$1\\\\leq x \\\\leq 5000$$$).2 v($$$1 \\\\leq v \\\\leq n$$$).OutputFor each query of the second type, print a single line with the maximumawesomenessin the respective subtree.ExampleInput5 61 1 2 210 -3 -7 -3 -1010 3 9 3 62 12 21 2 62 11 2 52 1Output10091169240NoteThe initialawesomenessof the vertices is $$$[100, 91, 57, 64, 57]$$$. The mostawesomevertex in the subtree of vertex $$$1$$$ (the first query) is $$$1$$$, and the mostawesomevertex in the subtree of vertex $$$2$$$ (the second query) is $$$2$$$.After the first update (the third query), theawesomenesschanges to $$$[100, 169, 57, 160, 57]$$$ and thus the mostawesomevertex in the whole tree (the fourth query) is now $$$2$$$.After the second update (the fifth query), theawesomenessbecomes $$$[100, 234, 57, 240, 152]$$$, hence the mostawesomevertex (the sixth query) is now $$$4$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "9b5d20b2", "template_md5": "35d339e4", "result": "You are given a tree with $n$ vertices, numbered from 1 to $n$. Each vertex has two associated integers, $a_i$ and $b_i$.  \n\nThe \"awesomeness\" of a vertex $v$ is defined as:\n\n$$| \\sum_{w \\in R(v)} a_w | \\cdot | \\sum_{w \\in R(v)} b_w |$$\n\nwhere $R(v)$ is the set of all ancestors of vertex $v$ (including $v$ itself), and $|x|$ denotes the absolute value of $x$.\n\nYou will be given $q$ queries. Each query can be one of two types:\n\n1. **Update:**  Increase the value of $a_v$ by $x$.\n2. **Query:** Report the maximum awesomeness in the subtree of vertex $v$.\n\n**Input:**\n\n* The first line contains two integers, $n$ and $q$ ($1 \\leq n \\leq 2 \\cdot 10^5$, $1 \\leq q \\leq 10^5$), representing the number of vertices and the number of queries.\n* The second line contains $n-1$ integers $p_2, p_3, ..., p_n$ ($1 \\leq p_i < i$), representing the parent of each vertex (except the root, which is vertex 1).\n* The third line contains $n$ integers $a_1, a_2, ..., a_n$ ($-5000 \\leq a_i \\leq 5000$), representing the initial values of $a_i$.\n* The fourth line contains $n$ integers $b_1, b_2, ..., b_n$ ($-5000 \\leq b_i \\leq 5000$), representing the values of $b_i$.\n* Each of the next $q$ lines describes a query in the format specified above.\n\n**Output:**\n\nFor each query of type 2, print a single line with the maximum awesomeness in the subtree of vertex $v$."}, {"prompt_md5": "f603c25d", "template_md5": "465699a0", "result": "You are given a tree with numbered nodes. Each node has two associated values, 'a' and 'b'.  You need to process queries:\n\n1. Increase the 'a' value of a specific node by a given amount.\n2. Find the node in a given subtree that has the largest product of the absolute values of the sum of 'a' values and the sum of 'b' values for all its ancestors (including itself)."}]}