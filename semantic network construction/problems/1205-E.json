{"uid": "1205-E", "url": "https://codeforces.com/contest/1205/problem/E", "tags": ["combinatorics", " strings"], "title": "1205-E", "statement": "E. Expected Value Againtime limit per test4 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputYou are given integers $$$n$$$, $$$k$$$. Let's consider the alphabet consisting of $$$k$$$ different elements.Letbeauty$$$f(s)$$$ of the string $$$s$$$ be the number of indexes $$$i$$$, $$$1\\\\le i<|s|$$$, for which prefix of $$$s$$$ of length $$$i$$$ equals to suffix of $$$s$$$ of length $$$i$$$. For example, beauty of the string $$$abacaba$$$ equals $$$2$$$, as for $$$i = 1, 3$$$ prefix and suffix of length $$$i$$$ are equal.Consider all words of length $$$n$$$ in the given alphabet. Find the expected value of $$$f(s)^2$$$ of a uniformly chosen at random word. We can show that it can be expressed as $$$\\\\frac{P}{Q}$$$, where $$$P$$$ and $$$Q$$$ are coprime and $$$Q$$$ isn't divided by $$$10^9 + 7$$$. Output $$$P\\\\cdot Q^{-1} \\\\bmod 10^9 + 7$$$.InputThe first and the only line contains two integers $$$n$$$, $$$k$$$ ($$$1\\\\le n \\\\le 10^5$$$, $$$1\\\\le k\\\\le 10^9$$$) — the length of a string and the size of alphabet respectively.OutputOutput a single integer — $$$P\\\\times Q^{-1} \\\\bmod 10^9 + 7$$$.ExamplesInput2 3Output333333336Input1 5Output0Input100 1Output9801Input10 10Output412377396NoteIn the first example, there are $$$9$$$ words of length $$$2$$$ in alphabet of size $$$3$$$ — $$$aa$$$, $$$ab$$$, $$$ac$$$, $$$ba$$$, $$$bb$$$, $$$bc$$$, $$$ca$$$, $$$cb$$$, $$$cc$$$. $$$3$$$ of them have beauty $$$1$$$ and $$$6$$$ of them have beauty $$$0$$$, so the average value is $$$\\\\frac{1}{3}$$$.In the third example, there is only one such word, and it has beauty $$$99$$$, so the average value is $$$99^2$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "7526e288", "template_md5": "35d339e4", "result": "You are given two integers $n$ and $k$.  \n\nConsider all possible strings of length $n$ made up of $k$ unique characters.  \n\nFor a string $s$, define its \"beauty\" $f(s)$ as the number of positions $i$ (where $1 \\le i < |s|$) such that the prefix of $s$ of length $i$ is equal to the suffix of $s$ of length $i$.\n\nCalculate the expected value of $f(s)^2$ for a randomly chosen string $s$.  The answer can be expressed as a fraction $\\frac{P}{Q}$ where $P$ and $Q$ are coprime integers and $Q$ is not divisible by $10^9 + 7$. Output $P \\cdot Q^{-1} \\pmod{10^9 + 7}$."}, {"prompt_md5": "b2ced296", "template_md5": "465699a0", "result": "Given a string length and a number of unique characters, find the average of the square of the \"beauty\" of all possible strings of that length. The beauty of a string is the number of times its prefix matches its suffix of the same length."}]}