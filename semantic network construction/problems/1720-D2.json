{"uid": "1720-D2", "url": "https://codeforces.com/contest/1720/problem/D2", "tags": ["bitmasks", " data structures", " dp", " strings", " trees"], "title": "1720-D2", "statement": "D2. Xor-Subsequence (hard version)time limit per test2 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputIt is the hard version of the problem. The only difference is that in this version $$$a_i \\\\le 10^9$$$.You are given an array of $$$n$$$ integers $$$a_0, a_1, a_2, \\\\ldots a_{n - 1}$$$. Bryap wants to find the longestbeautifulsubsequence in the array.An array $$$b = [b_0, b_1, \\\\ldots, b_{m-1}]$$$, where $$$0 \\\\le b_0 < b_1 < \\\\ldots < b_{m - 1} < n$$$, is a subsequence of length $$$m$$$ of the array $$$a$$$.Subsequence $$$b = [b_0, b_1, \\\\ldots, b_{m-1}]$$$ of length $$$m$$$ is calledbeautiful, if the following condition holds:For any $$$p$$$ ($$$0 \\\\le p < m - 1$$$) holds: $$$a_{b_p} \\\\oplus b_{p+1} < a_{b_{p+1}} \\\\oplus b_p$$$.Here $$$a \\\\oplus b$$$ denotes thebitwise XORof $$$a$$$ and $$$b$$$. For example, $$$2 \\\\oplus 4 = 6$$$ and $$$3 \\\\oplus 1=2$$$.Bryap is a simple person so he only wants to know the length of the longest such subsequence. Help Bryap and find the answer to his question.InputThe first line contains a single integer $$$t$$$ ($$$1 \\\\leq t \\\\leq 10^5$$$)  — the number of test cases. The description of the test cases follows.The first line of each test case contains a single integer $$$n$$$ ($$$2 \\\\leq n \\\\leq 3 \\\\cdot 10^5$$$) — the length of the array.The second line of each test case contains $$$n$$$ integers $$$a_0,a_1,...,a_{n-1}$$$ ($$$0 \\\\leq a_i \\\\leq 10^9$$$) — the elements of the array.It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$3 \\\\cdot 10^5$$$.OutputFor each test case print a single integer — the length of the longestbeautifulsubsequence.ExampleInput321 255 2 4 3 1103 8 8 2 9 1 6 2 8 3Output2 3 6NoteIn the first test case, we can pick the whole array as a beautiful subsequence because $$$1 \\\\oplus 1 < 2 \\\\oplus 0$$$.In the second test case, we can pick elements with indexes $$$1$$$, $$$2$$$ and $$$4$$$ (in $$$0$$$ indexation). For this elements holds: $$$2 \\\\oplus 2 < 4 \\\\oplus 1$$$ and $$$4 \\\\oplus 4 < 1 \\\\oplus 2$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "7be58482", "template_md5": "35d339e4", "result": "You are given an array of $n$ integers $a_0, a_1, a_2, ..., a_{n-1}$.  Find the length of the longest subsequence of this array where the following condition holds for all $p$ where $0 \\le p < m-1$:\n\n$a_{b_p} \\oplus b_{p+1} < a_{b_{p+1}} \\oplus b_p$\n\nHere $\\oplus$ denotes the bitwise XOR operation. \n\nInput:\n\n* The first line contains an integer $t$ ($1 \\le t \\le 10^5$) representing the number of test cases.\n* For each test case:\n    * The first line contains an integer $n$ ($2 \\le n \\le 3 \\cdot 10^5$) representing the length of the array.\n    * The second line contains $n$ integers $a_0, a_1, ..., a_{n-1}$ ($0 \\le a_i \\le 10^9$) representing the elements of the array.\n\nOutput:\n\nFor each test case, print a single integer representing the length of the longest subsequence that satisfies the given condition."}, {"prompt_md5": "1e0a351b", "template_md5": "465699a0", "result": "Given a list of numbers, find the longest subsequence where each pair of consecutive numbers in the subsequence satisfies a specific condition: the XOR of the first number and the next number is less than the XOR of the next number and the first number."}]}