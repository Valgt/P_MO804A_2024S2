{"uid": "1707-D", "url": "https://codeforces.com/contest/1707/problem/D", "tags": ["combinatorics", " dfs and similar", " dp", " math", " trees"], "title": "1707-D", "statement": "D. Partial Virtual Treestime limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputKawashiro Nitori is a girl who loves competitive programming. One day she found a rooted tree consisting of $$$n$$$ vertices. The root is vertex $$$1$$$. As an advanced problem setter, she quickly thought of a problem.Kawashiro Nitori has a vertex set $$$U=\\\\{1,2,\\\\ldots,n\\\\}$$$. She's going to play a game with the tree and the set. In each operation, she will choose a vertex set $$$T$$$, where $$$T$$$ is apartial virtual treeof $$$U$$$, and change $$$U$$$ into $$$T$$$.A vertex set $$$S_1$$$ is a partial virtual tree of a vertex set $$$S_2$$$, if $$$S_1$$$ is a subset of $$$S_2$$$, $$$S_1 \\\\neq S_2$$$, and for all pairs of vertices $$$i$$$ and $$$j$$$ in $$$S_1$$$, $$$\\\\operatorname{LCA}(i,j)$$$ is in $$$S_1$$$, where $$$\\\\operatorname{LCA}(x,y)$$$ denotes thelowest common ancestorof vertices $$$x$$$ and $$$y$$$ on the tree. Note that a vertex set can have many different partial virtual trees.Kawashiro Nitori wants to know for each possible $$$k$$$, if she performs the operationexactly$$$k$$$ times, in how many ways she can make $$$U=\\\\{1\\\\}$$$ in the end? Two ways are considered different if there exists an integer $$$z$$$ ($$$1 \\\\le z \\\\le k$$$) such that after $$$z$$$ operations the sets $$$U$$$ are different.Since the answer could be very large, you need to find it modulo $$$p$$$. It's guaranteed that $$$p$$$ is a prime number.InputThe first line contains two integers $$$n$$$ and $$$p$$$ ($$$2 \\\\le n \\\\le 2000$$$, $$$10^8 + 7 \\\\le p \\\\le 10^9+9$$$). It's guaranteed that $$$p$$$ is a prime number.Each of the next $$$n-1$$$ lines contains two integers $$$u_i$$$, $$$v_i$$$ ($$$1 \\\\leq u_i, v_i \\\\leq n$$$), representing an edge between $$$u_i$$$ and $$$v_i$$$.It is guaranteed that the given edges form a tree.OutputThe only line contains $$$n-1$$$ integers — the answer modulo $$$p$$$ for $$$k=1,2,\\\\ldots,n-1$$$.ExamplesInput4 998244353 1 2 2 3 1 4Output1 6 6Input7 100000007 1 2 1 3 2 4 2 5 3 6 3 7Output1 47 340 854 880 320Input8 1000000007 1 2 2 3 3 4 4 5 5 6 6 7 7 8Output1 126 1806 8400 16800 15120 5040NoteIn the first test case, when $$$k=1$$$, the only possible way is:$$$\\\\{1,2,3,4\\\\} \\\\to \\\\{1\\\\}$$$.When $$$k=2$$$, there are $$$6$$$ possible ways:$$$\\\\{1,2,3,4\\\\} \\\\to \\\\{1,2\\\\} \\\\to \\\\{1\\\\}$$$;$$$\\\\{1,2,3,4\\\\} \\\\to \\\\{1,2,3\\\\} \\\\to \\\\{1\\\\}$$$;$$$\\\\{1,2,3,4\\\\} \\\\to \\\\{1,2,4\\\\} \\\\to \\\\{1\\\\}$$$;$$$\\\\{1,2,3,4\\\\} \\\\to \\\\{1,3\\\\} \\\\to \\\\{1\\\\}$$$;$$$\\\\{1,2,3,4\\\\} \\\\to \\\\{1,3,4\\\\} \\\\to \\\\{1\\\\}$$$;$$$\\\\{1,2,3,4\\\\} \\\\to \\\\{1,4\\\\} \\\\to \\\\{1\\\\}$$$.When $$$k=3$$$, there are $$$6$$$ possible ways:$$$\\\\{1,2,3,4\\\\} \\\\to \\\\{1,2,3\\\\} \\\\to \\\\{1,2\\\\} \\\\to \\\\{1\\\\}$$$;$$$\\\\{1,2,3,4\\\\} \\\\to \\\\{1,2,3\\\\} \\\\to \\\\{1,3\\\\} \\\\to \\\\{1\\\\}$$$;$$$\\\\{1,2,3,4\\\\} \\\\to \\\\{1,2,4\\\\} \\\\to \\\\{1,2\\\\} \\\\to \\\\{1\\\\}$$$;$$$\\\\{1,2,3,4\\\\} \\\\to \\\\{1,2,4\\\\} \\\\to \\\\{1,4\\\\} \\\\to \\\\{1\\\\}$$$;$$$\\\\{1,2,3,4\\\\} \\\\to \\\\{1,3,4\\\\} \\\\to \\\\{1,3\\\\} \\\\to \\\\{1\\\\}$$$;$$$\\\\{1,2,3,4\\\\} \\\\to \\\\{1,3,4\\\\} \\\\to \\\\{1,4\\\\} \\\\to \\\\{1\\\\}$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "7eb9b74e", "template_md5": "35d339e4", "result": "You are given a rooted tree with $n$ vertices. The root is vertex 1.\n\nA set $T$ is a partial virtual tree of a set $S$ if:\n\n* $T$ is a subset of $S$\n* $T$ is not equal to $S$\n* For any two vertices $i$ and $j$ in $T$, their lowest common ancestor (LCA) is also in $T$.\n\nYou start with the set $U = \\{1, 2, ..., n\\}$. In each operation, you choose a partial virtual tree $T$ of $U$ and update $U$ to be $T$.\n\nFind the number of ways to make $U = \\{1\\}$ after exactly $k$ operations, for each $k$ from 1 to $n-1$. Since the answer can be large, find it modulo $p$. \n\nNote: $p$ is a prime number."}, {"prompt_md5": "ed5c8638", "template_md5": "465699a0", "result": "You are given a tree with $n$ nodes.  You can repeatedly shrink the set of nodes in the tree by selecting a subset of the current nodes that forms a \"partial virtual tree\" (where the lowest common ancestor of any two nodes in the subset is also in the subset).  \n\nFind the number of ways to reduce the tree to a single node (node 1) after performing the operation exactly $k$ times, for each $k$ from 1 to $n-1$. The answer should be modulo $p$."}]}