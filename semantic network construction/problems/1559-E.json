{"uid": "1559-E", "url": "https://codeforces.com/contest/1559/problem/E", "tags": ["combinatorics", " dp", " fft", " math", " number theory"], "title": "1559-E", "statement": "E. Mocha and Starstime limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputMocha wants to be an astrologer. There are $$$n$$$ stars which can be seen in Zhijiang, and the brightness of the $$$i$$$-th star is $$$a_i$$$.Mocha considers that these $$$n$$$ stars form a constellation, and she uses $$$(a_1,a_2,\\\\ldots,a_n)$$$ to show its state. A state is calledmathematicalif all of the following three conditions are satisfied:For all $$$i$$$ ($$$1\\\\le i\\\\le n$$$), $$$a_i$$$ is an integer in the range $$$[l_i, r_i]$$$.$$$\\\\sum \\\\limits _{i=1} ^ n a_i \\\\le m$$$.$$$\\\\gcd(a_1,a_2,\\\\ldots,a_n)=1$$$.Here, $$$\\\\gcd(a_1,a_2,\\\\ldots,a_n)$$$ denotes thegreatest common divisor (GCD)of integers $$$a_1,a_2,\\\\ldots,a_n$$$.Mocha is wondering how many different mathematical states of this constellation exist. Because the answer may be large, you must find it modulo $$$998\\\\,244\\\\,353$$$.Two states $$$(a_1,a_2,\\\\ldots,a_n)$$$ and $$$(b_1,b_2,\\\\ldots,b_n)$$$ are considered different if there exists $$$i$$$ ($$$1\\\\le i\\\\le n$$$) such that $$$a_i \\\\ne b_i$$$.InputThe first line contains two integers $$$n$$$ and $$$m$$$ ($$$2 \\\\le n \\\\le 50$$$, $$$1 \\\\le m \\\\le 10^5$$$) — the number of stars and the upper bound of the sum of the brightness of stars.Each of the next $$$n$$$ lines contains two integers $$$l_i$$$ and $$$r_i$$$ ($$$1 \\\\le l_i \\\\le r_i \\\\le m$$$) — the range of the brightness of the $$$i$$$-th star.OutputPrint a single integer — the number of different mathematical states of this constellation, modulo $$$998\\\\,244\\\\,353$$$.ExamplesInput2 4 1 3 1 2Output4Input5 10 1 10 1 10 1 10 1 10 1 10Output251Input5 100 1 94 1 96 1 91 4 96 6 97Output47464146NoteIn the first example, there are $$$4$$$ different mathematical states of this constellation:$$$a_1=1$$$, $$$a_2=1$$$.$$$a_1=1$$$, $$$a_2=2$$$.$$$a_1=2$$$, $$$a_2=1$$$.$$$a_1=3$$$, $$$a_2=1$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "4b02082d", "template_md5": "465699a0", "result": "You are given a list of ranges for the brightness of stars.  Find the number of ways to choose a brightness for each star within its range so that:\n\n1. The sum of the brightness values is less than or equal to a given limit.\n2. The greatest common divisor of all the brightness values is 1. \n\n\n\nThe answer should be the number of valid combinations modulo 998244353."}, {"prompt_md5": "7e48b23b", "template_md5": "35d339e4", "result": "There are $n$ stars, each with a brightness value in a given range [$l_i$, $r_i$].  The sum of the brightness values of all stars must be less than or equal to $m$.  \n\nFind the number of different combinations of brightness values for the stars that satisfy these conditions and have a greatest common divisor (GCD) of 1.\n\nThe answer should be modulo 998244353."}]}