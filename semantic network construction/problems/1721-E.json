{"uid": "1721-E", "url": "https://codeforces.com/contest/1721/problem/E", "tags": ["dfs and similar", " dp", " hashing", " string suffix structures", " strings", " trees"], "title": "1721-E", "statement": "E. Prefix Function Queriestime limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputYou are given a string $$$s$$$, consisting of lowercase Latin letters.You are asked $$$q$$$ queries about it: given another string $$$t$$$, consisting of lowercase Latin letters, perform the following steps:concatenate $$$s$$$ and $$$t$$$;calculate the prefix function of the resulting string $$$s+t$$$;print the values of the prefix function on positions $$$|s|+1, |s|+2, \\\\dots, |s|+|t|$$$ ($$$|s|$$$ and $$$|t|$$$ denote the lengths of strings $$$s$$$ and $$$t$$$, respectively);revert the string back to $$$s$$$.The prefix function of a string $$$a$$$ is a sequence $$$p_1, p_2, \\\\dots, p_{|a|}$$$, where $$$p_i$$$ is the maximum value of $$$k$$$ such that $$$k < i$$$ and $$$a[1..k]=a[i-k+1..i]$$$ ($$$a[l..r]$$$ denotes a contiguous substring of a string $$$a$$$ from a position $$$l$$$ to a position $$$r$$$, inclusive). In other words, it's the longest proper prefix of the string $$$a[1..i]$$$ that is equal to its suffix of the same length.InputThe first line contains a non-empty string $$$s$$$ ($$$1 \\\\le |s| \\\\le 10^6$$$), consisting of lowercase Latin letters.The second line contains a single integer $$$q$$$ ($$$1 \\\\le q \\\\le 10^5$$$) — the number of queries.Each of the next $$$q$$$ lines contains a query: a non-empty string $$$t$$$ ($$$1 \\\\le |t| \\\\le 10$$$), consisting of lowercase Latin letters.OutputFor each query, print the values of the prefix function of a string $$$s+t$$$ on positions $$$|s|+1, |s|+2, \\\\dots, |s|+|t|$$$.ExamplesInputaba 6 caba aba bababa aaaa b forcesOutput0 1 2 3  1 2 3  2 3 4 5 6 7  1 1 1 1  2  0 0 0 0 0 0Inputaacba 4 aaca cbbb aab ccacaOutput2 2 3 1  0 0 0 0  2 2 0  0 0 1 0 1", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "277c163b", "template_md5": "35d339e4", "result": "You are given a string $s$. You will be asked $q$ queries. Each query consists of a string $t$. For each query:\n\n1. Concatenate $s$ and $t$ to form a new string $s+t$.\n2. Calculate the prefix function of $s+t$. The prefix function of a string is a sequence of numbers where each number represents the length of the longest proper prefix of the string that is also a suffix of the same length.\n3. Print the values of the prefix function for the positions $|s|+1$ to $|s|+|t|$ in the string $s+t$.\n4. Restore the original string $s$.\n\n**Example:**\n\nIf $s = \"aba\"$ and $t = \"ba\"$, then:\n\n1. $s+t = \"abab\"$\n2. The prefix function of $s+t$ is $[0, 0, 1, 2]$.\n3. The values for positions $|s|+1$ to $|s|+|t|$ are $[1, 2]$.\n4. The original string $s$ is restored."}, {"prompt_md5": "21b6e005", "template_md5": "465699a0", "result": "You are given a string. You will be asked multiple times to:\n\n1. Append another string to the original string.\n2. Calculate a special function for the combined string (the function looks for repeating patterns within the string).\n3. Output the results of the function for a specific part of the combined string.\n4. Remove the appended string and return to the original string."}]}