{"uid": "2020-F", "url": "https://codeforces.com/contest/2020/problem/F", "tags": ["dp", " math", " number theory"], "title": "2020-F", "statement": "F. Count Leavestime limit per test4 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputLet $$$n$$$ and $$$d$$$ be positive integers. We build thethe divisor tree$$$T_{n,d}$$$ as follows:The root of the tree is a node marked with number $$$n$$$. This is the $$$0$$$-th layer of the tree.For each $$$i$$$ from $$$0$$$ to $$$d - 1$$$, for each vertex of the $$$i$$$-th layer, do the following. If the current vertex is marked with $$$x$$$, create its children and mark them with all possible distinct divisors$$$^\\\\dagger$$$ of $$$x$$$. These children will be in the $$$(i+1)$$$-st layer.The vertices on the $$$d$$$-th layer are the leaves of the tree.For example, $$$T_{6,2}$$$ (the divisor tree for $$$n = 6$$$ and $$$d = 2$$$) looks like this:Define $$$f(n,d)$$$ as the number of leaves in $$$T_{n,d}$$$.Given integers $$$n$$$, $$$k$$$, and $$$d$$$, please compute $$$\\\\sum\\\\limits_{i=1}^{n} f(i^k,d)$$$, modulo $$$10^9+7$$$.$$$^\\\\dagger$$$ In this problem, we say that an integer $$$y$$$ is a divisor of $$$x$$$ if $$$y \\\\ge 1$$$ and there exists an integer $$$z$$$ such that $$$x = y \\\\cdot z$$$.InputEach test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \\\\le t \\\\le 10^4$$$). The description of the test cases follows.The only line of each test case contains three integers $$$n$$$, $$$k$$$, and $$$d$$$ ($$$1 \\\\le n \\\\le 10^9$$$, $$$1 \\\\le k,d \\\\le 10^5$$$).It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$10^9$$$.OutputFor each test case, output $$$\\\\sum\\\\limits_{i=1}^{n} f(i^k,d)$$$, modulo $$$10^9+7$$$.ExampleInput36 1 11 3 310 1 2Output14 1 53NoteIn the first test case, $$$n = 6$$$, $$$k = 1$$$, and $$$d = 1$$$. Thus, we need to find the total number of leaves in the divisor trees $$$T_{1,1}$$$, $$$T_{2,1}$$$, $$$T_{3,1}$$$, $$$T_{4,1}$$$, $$$T_{5,1}$$$, $$$T_{6,1}$$$.$$$T_{1,1}$$$ has only one leaf, which is marked with $$$1$$$.$$$T_{2,1}$$$ has two leaves, marked with $$$1$$$ and $$$2$$$.$$$T_{3,1}$$$ has two leaves, marked with $$$1$$$ and $$$3$$$.$$$T_{4,1}$$$ has three leaves, marked with $$$1$$$, $$$2$$$, and $$$4$$$.$$$T_{5,1}$$$ has two leaves, marked with $$$1$$$ and $$$5$$$.$$$T_{6,1}$$$ has four leaves, marked with $$$1$$$, $$$2$$$, $$$3$$$, and $$$6$$$.The total number of leaves is $$$1 + 2 + 2 + 3 + 2 + 4 = 14$$$.In the second test case, $$$n = 1$$$, $$$k = 3$$$, $$$d = 3$$$. Thus, we need to find the number of leaves in $$$T_{1,3}$$$, because $$$1^3 = 1$$$. This tree has only one leaf, so the answer is $$$1$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "d5ac225d", "template_md5": "35d339e4", "result": "You are given three integers $n$, $k$, and $d$. \n\nFor each integer $i$ from 1 to $n$, construct a tree called $T_{i^k, d}$ as follows:\n\n1. The root of the tree is a node marked with the number $i^k$.\n2. For each layer $i$ from 0 to $d-1$:\n   - For each node in layer $i$, create child nodes for all the distinct divisors of the node's value.\n   - The child nodes will be in the next layer $(i+1)$.\n3. The nodes on the $d$-th layer are the leaves of the tree.\n\nDefine $f(n, d)$ as the number of leaves in the tree $T_{n, d}$.\n\nCalculate the sum  $\\sum_{i=1}^{n} f(i^k, d)$ modulo $10^9 + 7$. \n\n\n\nYou are given multiple test cases. For each test case, you need to output the calculated sum."}, {"prompt_md5": "8941d906", "template_md5": "465699a0", "result": "You are given three numbers: n, k, and d.  Calculate the total number of leaves in all the divisor trees built for numbers from 1 to n, where each tree has a depth of d and the base number is raised to the power of k.  The number of leaves in each tree is the number of divisors of the base number raised to the power of k.  The result should be modulo 10^9+7."}]}