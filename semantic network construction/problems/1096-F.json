{"uid": "1096-F", "url": "https://codeforces.com/contest/1096/problem/F", "tags": ["dp", " math", " probabilities"], "title": "1096-F", "statement": "F. Inversion Expectationtime limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputA permutation of size $$$n$$$ is an array of size $$$n$$$ such that each integer from $$$1$$$ to $$$n$$$ occurs exactly once in this array. An inversion in a permutation $$$p$$$ is a pair of indices $$$(i, j)$$$ such that $$$i > j$$$ and $$$a_i < a_j$$$. For example, a permutation $$$[4, 1, 3, 2]$$$ contains $$$4$$$ inversions: $$$(2, 1)$$$, $$$(3, 1)$$$, $$$(4, 1)$$$, $$$(4, 3)$$$.You are given a permutation $$$p$$$ of size $$$n$$$. However, the numbers on some positions are replaced by $$$-1$$$. Let the valid permutation be such a replacement of $$$-1$$$ in this sequence back to numbers from $$$1$$$ to $$$n$$$ in such a way that the resulting sequence is a permutation of size $$$n$$$.The given sequence was turned into a valid permutation randomly with the equal probability of getting each valid permutation.Calculate the expected total number of inversions in the resulting valid permutation.It can be shown that it is in the form of $$$\\\\frac{P}{Q}$$$ where $$$P$$$ and $$$Q$$$ are non-negative integers and $$$Q \\\\ne 0$$$. Report the value of $$$P \\\\cdot Q^{-1} \\\\pmod {998244353}$$$.InputThe first line contains a single integer $$$n$$$ ($$$1 \\\\le n \\\\le 2 \\\\cdot 10^5$$$) — the length of the sequence.The second line contains $$$n$$$ integers $$$p_1, p_2, \\\\dots, p_n$$$ ($$$-1 \\\\le p_i \\\\le n$$$, $$$p_i \\\\ne 0$$$) — the initial sequence.It is guaranteed that all elements not equal to $$$-1$$$ are pairwise distinct.OutputPrint a single integer — the expected total number of inversions in the resulting valid permutation.It can be shown that it is in the form of $$$\\\\frac{P}{Q}$$$ where $$$P$$$ and $$$Q$$$ are non-negative integers and $$$Q \\\\ne 0$$$. Report the value of $$$P \\\\cdot Q^{-1} \\\\pmod {998244353}$$$.ExamplesInput3 3 -1 -1Output499122179Input2 1 2Output0Input2 -1 -1Output499122177NoteIn the first example two resulting valid permutations are possible:$$$[3, 1, 2]$$$ — $$$2$$$ inversions;$$$[3, 2, 1]$$$ — $$$3$$$ inversions.The expected value is $$$\\\\frac{2 \\\\cdot 1 + 3 \\\\cdot 1}{2} = 2.5$$$.In the second example no $$$-1$$$ are present, thus the only valid permutation is possible — the given one. It has $$$0$$$ inversions.In the third example there are two resulting valid permutations — one with $$$0$$$ inversions and one with $$$1$$$ inversion.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "8dd9b7e5", "template_md5": "35d339e4", "result": "You are given a permutation of size $n$ where some elements are replaced by $-1$.  You need to find the expected number of inversions in a valid permutation that can be formed by replacing all the $-1$s with numbers from 1 to $n$ in a way that each number appears exactly once.\n\n**Input:**\n\n* The first line contains an integer $n$ (1 ≤ $n$ ≤ 2 * 10⁵) - the length of the sequence.\n* The second line contains $n$ integers $p_1, p_2, ..., p_n$ (-1 ≤ $p_i$ ≤ $n$, $p_i$ ≠ 0) - the initial sequence.\n\n**Output:**\n\nPrint a single integer - the expected total number of inversions in the resulting valid permutation.  The answer can be expressed as a fraction $P/Q$ where $P$ and $Q$ are non-negative integers and $Q$ ≠ 0. Report the value of $P * Q^{-1} \\pmod{998244353}$. \n\n\n\n**Inversion:** A pair of indices $(i, j)$ is an inversion if $i > j$ and $a_i < a_j$."}, {"prompt_md5": "99cb96a1", "template_md5": "465699a0", "result": "You are given a list of numbers where some are replaced with -1.  You need to figure out the average number of \"inversions\" in all the possible lists you can make by replacing the -1s with unique numbers from 1 to the length of the list. An inversion is when a larger number comes before a smaller number."}]}