{"uid": "487-E", "url": "https://codeforces.com/contest/487/problem/E", "tags": ["data structures", " dfs and similar", " graphs", " trees"], "title": "487-E", "statement": "E. Touriststime limit per test2 secondsmemory limit per test256 megabytesinputstdinoutputstdoutThere arencities in Cyberland, numbered from1ton, connected bymbidirectional roads. Thej-th road connects cityajandbj.For tourists, souvenirs are sold in every city of Cyberland. In particular, cityisell it at a price ofwi.Now there areqqueries for you to handle. There are two types of queries:\"Caw\": The price in cityais changed tow.\"Aab\": Now a tourist will travel from cityatob. He will choose a route, he also doesn't want to visit a city twice. He will buy souvenirs at the city where the souvenirs are the cheapest (possibly exactly at cityaorb). You should output the minimum possible price that he can buy the souvenirs during his travel.More formally, we can define routes as follow:A route is a sequence of cities[x1,x2, ...,xk], wherekis a certain positive integer.For any1 ≤i<j≤k,xi≠xj.For any1 ≤i<k, there is a road connectingxiandxi+ 1.The minimum price of the route ismin(wx1,wx2, ...,wxk).The required answer is the minimum value of the minimum prices of all valid routes fromatob.InputThe first line of input contains three integersn,m,q(1 ≤n,m,q≤ 105), separated by a single space.Nextnlines contain integerswi(1 ≤wi≤ 109).Nextmlines contain pairs of space-separated integersajandbj(1 ≤aj,bj≤n,aj≠bj).It is guaranteed that there is at most one road connecting the same pair of cities. There is always at least one valid route between any two cities.Nextqlines each describe a query. The format is \"Caw\" or \"Aab\" (1 ≤a,b≤n, 1 ≤w≤ 109).OutputFor each query of type \"A\", output the corresponding answer.ExamplesInput3 3 31231 22 31 3A 2 3C 1 5A 2 3Output12Input7 9 412345671 22 51 52 33 42 45 66 75 7A 2 3A 6 4A 6 7A 3 3Output2153NoteFor the second sample, an optimal routes are:From2to3it is[2, 3].From6to4it is[6, 5, 1, 2, 4].From6to7it is[6, 5, 7].From3to3it is[3].", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "901dd172", "template_md5": "35d339e4", "result": "There are $n$ cities connected by $m$ bidirectional roads. Each city $i$ has a souvenir price of $w_i$. \n\nYou are given $q$ queries. \n\n* **Type \"Caw\"**: Change the price of souvenirs in city $a$ to $w$.\n* **Type \"Aab\"**: A tourist wants to travel from city $a$ to city $b$. They want to find the cheapest souvenir price along their route. They can visit each city only once. Output the minimum possible price they can buy a souvenir for.\n\n**Input:**\n\n* The first line contains three integers: $n$, $m$, and $q$.\n* The next $n$ lines contain the souvenir prices $w_1$, $w_2$, ..., $w_n$.\n* The next $m$ lines contain pairs of integers $a_j$ and $b_j$, representing a road connecting city $a_j$ and $b_j$.\n* The next $q$ lines describe the queries.\n\n**Output:**\n\nFor each query of type \"A\", output the minimum souvenir price the tourist can buy."}, {"prompt_md5": "6d15643f", "template_md5": "465699a0", "result": "There are cities connected by roads. Each city has a price for a product.  You are given queries of two types:\n\n1. Change the price of a product in a city.\n2. Find the cheapest price a person can buy the product for when traveling between two cities, visiting each city only once."}]}