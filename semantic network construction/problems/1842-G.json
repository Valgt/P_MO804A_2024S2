{"uid": "1842-G", "url": "https://codeforces.com/contest/1842/problem/G", "tags": ["combinatorics", " dp", " math", " probabilities"], "title": "1842-G", "statement": "G. Tenzing and Random Operationstime limit per test2 secondsmemory limit per test1024 megabytesinputstandard inputoutputstandard outputYet another random problem.Tenzing has an array $$$a$$$ of length $$$n$$$ and an integer $$$v$$$.Tenzing will perform the following operation $$$m$$$ times:Choose an integer $$$i$$$ such that $$$1 \\\\leq i \\\\leq n$$$ uniformly at random.For all $$$j$$$ such that $$$i \\\\leq j \\\\leq n$$$, set $$$a_j := a_j + v$$$.Tenzing wants to know the expected value of $$$\\\\prod_{i=1}^n a_i$$$ after performing the $$$m$$$ operations, modulo $$$10^9+7$$$.Formally, let $$$M = 10^9+7$$$. It can be shown that the answer can be expressed as an irreducible fraction $$$\\\\frac{p}{q}$$$, where $$$p$$$ and $$$q$$$ are integers and $$$q \\\\not \\\\equiv 0 \\\\pmod{M}$$$. Output the integer equal to $$$p \\\\cdot q^{-1} \\\\bmod M$$$. In other words, output the integer $$$x$$$ that $$$0 \\\\le x < M$$$ and $$$x \\\\cdot q \\\\equiv p \\\\pmod{M}$$$.InputThe first line of input contains three integers $$$n$$$, $$$m$$$ and $$$v$$$ ($$$1\\\\leq n\\\\leq 5000$$$, $$$1\\\\leq m,v\\\\leq 10^9$$$).The second line of input contains $$$n$$$ integers $$$a_1,a_2,\\\\ldots,a_n$$$ ($$$1\\\\leq a_i\\\\leq 10^9$$$).OutputOutput the expected value of $$$\\\\prod_{i=1}^n a_i$$$ modulo $$$10^9+7$$$.ExamplesInput2 2 5 2 2Output84Input5 7 9 9 9 8 2 4Output975544726NoteThere are three types of $$$a$$$ after performing all the $$$m$$$ operations :1. $$$a_1=2,a_2=12$$$ with $$$\\\\frac{1}{4}$$$ probability.2. $$$a_1=a_2=12$$$ with $$$\\\\frac{1}{4}$$$ probability.3. $$$a_1=7,a_2=12$$$ with $$$\\\\frac{1}{2}$$$ probability.So the expected value of $$$a_1\\\\cdot a_2$$$ is $$$\\\\frac{1}{4}\\\\cdot (24+144) + \\\\frac{1}{2}\\\\cdot 84=84$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "1ad36218", "template_md5": "35d339e4", "result": "You are given an array of $n$ integers, $a_1, a_2, ..., a_n$, and an integer $v$.  You will perform $m$ operations. In each operation, choose a random index $i$ between 1 and $n$. Then, for all indices $j$ from $i$ to $n$, add $v$ to $a_j$.\n\nWhat is the expected value of the product of all the elements in the array after performing all $m$ operations, modulo $10^9 + 7$? \n\nThe answer can be expressed as a fraction $p/q$, where $q$ is not divisible by $10^9 + 7$. Output the integer $x$ such that $0 \\le x < 10^9 + 7$ and $x \\cdot q \\equiv p \\pmod{10^9 + 7}$."}, {"prompt_md5": "c0c21237", "template_md5": "465699a0", "result": "You are given an array of numbers and a value. You will repeatedly choose a position in the array and add the value to all numbers from that position to the end.  What is the average product of all the numbers in the array after many repetitions of this process?"}]}