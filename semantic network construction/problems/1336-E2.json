{"uid": "1336-E2", "url": "https://codeforces.com/contest/1336/problem/E2", "tags": ["bitmasks", " brute force", " combinatorics", " math"], "title": "1336-E2", "statement": "E2. Chiori and Doll Picking (hard version)time limit per test3 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputThis is the hard version of the problem. The only difference between easy and hard versions is the constraint of $$$m$$$. You can make hacks only if both versions are solved.Chiori loves dolls and now she is going to decorate her bedroom!As a doll collector, Chiori has got $$$n$$$ dolls. The $$$i$$$-th doll has a non-negative integer value $$$a_i$$$ ($$$a_i < 2^m$$$, $$$m$$$ is given). Chiori wants to pick some (maybe zero) dolls for the decoration, so there are $$$2^n$$$ different picking ways.Let $$$x$$$ be the bitwise-xor-sum of values of dolls Chiori picks (in case Chiori picks no dolls $$$x = 0$$$). The value of this picking way is equal to the number of $$$1$$$-bits in the binary representation of $$$x$$$. More formally, it is also equal to the number of indices $$$0 \\\\leq i < m$$$, such that $$$\\\\left\\\\lfloor \\\\frac{x}{2^i} \\\\right\\\\rfloor$$$ is odd.Tell her the number of picking ways with value $$$i$$$ for each integer $$$i$$$ from $$$0$$$ to $$$m$$$. Due to the answers can be very huge, print them by modulo $$$998\\\\,244\\\\,353$$$.InputThe first line contains two integers $$$n$$$ and $$$m$$$ ($$$1 \\\\le n \\\\le 2 \\\\cdot 10^5$$$, $$$0 \\\\le m \\\\le 53$$$)  — the number of dolls and the maximum value of the picking way.The second line contains $$$n$$$ integers $$$a_1, a_2, \\\\ldots, a_n$$$ ($$$0 \\\\le a_i < 2^m$$$)  — the values of dolls.OutputPrint $$$m+1$$$ integers $$$p_0, p_1, \\\\ldots, p_m$$$  — $$$p_i$$$ is equal to the number of picking ways with value $$$i$$$ by modulo $$$998\\\\,244\\\\,353$$$.ExamplesInput4 4 3 5 8 14Output2 2 6 6 0Input6 7 11 45 14 9 19 81Output1 2 11 20 15 10 5 0", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "d1a34c18", "template_md5": "35d339e4", "result": "You are given $n$ integers $a_1, a_2, ..., a_n$ where each $a_i$ is less than $2^m$.  You can choose any subset of these integers.  \n\nThe value of a subset is defined as the number of 1 bits in the binary representation of the bitwise XOR sum of the integers in the subset.  \n\nFor each integer $i$ from 0 to $m$, find the number of subsets that have a value of $i$.  The answer for each $i$ should be modulo 998244353."}, {"prompt_md5": "24317619", "template_md5": "465699a0", "result": "You are given a set of numbers.  You can choose any subset of these numbers. The value of a subset is the number of '1' bits in the binary representation of the sum of the numbers in the subset.  Count how many subsets have each possible value from 0 up to a given maximum."}]}