{"uid": "1387-C", "url": "https://codeforces.com/contest/1387/problem/C", "tags": ["*special", " dp", " shortest paths", " string suffix structures"], "title": "1387-C", "statement": "C. Virusestime limit per test0.75 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputThe Committee for Research on Binary Viruses discovered a method of replication for a large family of viruses whose genetic codes are sequences of zeros and ones. Each virus originates from a single gene; for simplicity genes are denoted by integers from $$$0$$$ to $$$G - 1$$$. At each moment in time a virus is a sequence of genes. When mutation occurs, one of the genes from the sequence is replaced by a certain sequence of genes, according to the mutation table. The virus stops mutating when it consists only of genes $$$0$$$ and $$$1$$$.For instance, for the following mutation table: $$$$$$ 2 \\\\to \\\\langle 0\\\\ 1 \\\\rangle \\\\\\\\ 3 \\\\to \\\\langle 2\\\\ 0\\\\ 0\\\\rangle\\\\\\\\ 3 \\\\to \\\\langle 1\\\\ 3\\\\rangle\\\\\\\\ 4 \\\\to \\\\langle 0\\\\ 3\\\\ 1\\\\ 2\\\\rangle\\\\\\\\ 5 \\\\to \\\\langle 2\\\\ 1\\\\rangle\\\\\\\\ 5 \\\\to \\\\langle 5\\\\rangle $$$$$$ a virus that initially consisted of a single gene $$$4$$$, could have mutated as follows: $$$$$$ \\\\langle 4 \\\\rangle \\\\to \\\\langle \\\\underline{0\\\\ 3\\\\ 1\\\\ 2} \\\\rangle \\\\to \\\\langle 0\\\\ \\\\underline{2\\\\ 0\\\\ 0}\\\\ 1\\\\ 2 \\\\rangle \\\\to \\\\langle 0\\\\ \\\\underline{0\\\\ 1}\\\\ 0\\\\ 0\\\\ 1\\\\ 2 \\\\rangle \\\\to \\\\langle 0\\\\ 0\\\\ 1\\\\ 0\\\\ 0\\\\ 1\\\\ \\\\underline{0\\\\ 1} \\\\rangle $$$$$$ or in another way: $$$$$$ \\\\langle 4 \\\\rangle \\\\to \\\\langle \\\\underline{0\\\\ 3\\\\ 1\\\\ 2} \\\\rangle \\\\to \\\\langle 0\\\\ \\\\underline{1\\\\ 3}\\\\ 1\\\\ 2 \\\\rangle \\\\to \\\\langle 0\\\\ 1\\\\ 3\\\\ 1\\\\ \\\\underline{0\\\\ 1} \\\\rangle \\\\to \\\\langle 0\\\\ 1\\\\ \\\\underline{2\\\\ 0\\\\ 0}\\\\ 1\\\\ 0\\\\ 1 \\\\rangle \\\\to \\\\langle 0\\\\ 1\\\\ \\\\underline{0\\\\ 1}\\\\ 0\\\\ 0\\\\ 1\\\\ 0\\\\ 1 \\\\rangle $$$$$$Viruses are detected by antibodies that identify the presence of specific continuous fragments of zeros and ones in the viruses' codes. For example, an antibody reacting to a fragment $$$\\\\langle 0\\\\ 0\\\\ 1\\\\ 0\\\\ 0 \\\\rangle$$$ will detect a virus $$$\\\\langle 0\\\\ 0\\\\ 1\\\\ 0\\\\ 0\\\\ 1\\\\ 0\\\\ 1 \\\\rangle$$$, but it will not detect a virus $$$\\\\langle 0\\\\ 1\\\\ 0\\\\ 1\\\\ 0\\\\ 0\\\\ 1\\\\ 0\\\\ 1 \\\\rangle$$$.For each gene from $$$2$$$ to $$$G-1$$$, the scientists are wondering whether a given set of antibodies is enough to detect all viruses that can emerge through mutations from this gene. If not, they want to know the length of the shortest virus that cannot be detected.It may happen that sometimes scientists don't have any antibodies. Then of course no virus can be detected, so the scientists are only interested in the length of the shortest possible virus that can emerge from the gene mutations.InputThe first line of the input will contain three integers $$$G$$$, $$$N$$$ and $$$M$$$ ($$$G > 2$$$, $$$N \\\\geq G - 2$$$, $$$M \\\\geq 0$$$) specifying the number of genes, the number of rows in the mutation table, and the number of antibodies.The following $$$N$$$ lines contain descriptions of rows of the mutation table; each line begins with two integers $$$a$$$ and $$$k$$$ ($$$2 \\\\leq a < G$$$, $$$k \\\\geq 1$$$), followed by a sequence of $$$k$$$ integers $$$b_1, b_2, \\\\ldots, b_k$$$ ($$$0 \\\\leq b_i < G$$$), that encode the row $$$$$$ a \\\\to \\\\langle b_1\\\\ b_2\\\\ \\\\ldots\\\\ b_k \\\\rangle $$$$$$The sum of all values $$$k$$$ does not exceed $$$100$$$.Every integer from $$$2$$$ to $$$G - 1$$$ appears in the table as $$$a$$$ at least once.The next $$$M$$$ lines contain descriptions of the antibodies; each such line begins with an integer $$$\\\\ell$$$ ($$$\\\\ell \\\\geq 1$$$), followed by a sequence of $$$\\\\ell$$$ integers $$$c_1, c_2, \\\\ldots, c_\\\\ell$$$ ($$$0 \\\\leq c_i \\\\leq 1$$$), describing the antibody. The sum of all values $$$\\\\ell$$$ does not exceed $$$50$$$.OutputYour program needs to output exactly $$$G - 2$$$ lines, containing the answers for the subsequent genes from $$$2$$$ to $$$G - 1$$$.If all viruses that can mutate from this single gene can be detected by the given set of antibodies, you need to print the word \"YES\". You also need to print this if there are no viruses that could originate from this gene (it can happen when the sequences never stop mutating).Otherwise you need to print the word \"NO\", followed by an integer denoting the minimal length of the undetectable virus. You can assume that for all the prepared input data this value will be smaller than $$$2^{63}$$$.ScoringSubtasks:(11 points) No antibodies ($$$M = 0$$$)(14 points) $$$N = G - 2$$$(25 points) One antibody ($$$M = 1$$$)(32 points) The sum of all values $$$\\\\ell$$$ does not exceed $$$10$$$(18 points) No further constraintsExampleInput6 6 2 2 2 0 1 3 3 2 0 0 3 2 1 3 4 4 0 3 1 2 5 2 2 1 5 1 5 2 1 1 5 0 0 1 0 0OutputNO 2 NO 4 NO 9 YES", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "f4f9c0b8", "template_md5": "35d339e4", "result": "You are given a set of rules for how a virus can mutate.  Each virus is represented by a sequence of numbers from 0 to G-1.  \n\n* **Mutation Rules:** For each number from 2 to G-1, there is a rule that says if the virus contains that number, it can be replaced with a new sequence of numbers.\n\n* **Antibodies:** You are also given a set of antibodies. Each antibody detects a specific sequence of 0s and 1s.\n\n**The Problem:**\n\nFor each number from 2 to G-1, determine:\n\n* **Case 1:** If all viruses that can be created by mutating from that number can be detected by the antibodies, print \"YES\".\n* **Case 2:** If there is a virus that can be created by mutating from that number that cannot be detected by the antibodies, print \"NO\" followed by the length of the shortest undetectable virus.\n\n\n\n**Input:**\n\n* The first line contains three integers: G (number of possible gene values), N (number of mutation rules), and M (number of antibodies).\n* The next N lines describe the mutation rules. Each line has the format: a k b1 b2 ... bk, where:\n    * a is the gene value that can be mutated.\n    * k is the length of the new sequence.\n    * b1, b2, ..., bk are the numbers in the new sequence.\n* The next M lines describe the antibodies. Each line has the format: l c1 c2 ... cl, where:\n    * l is the length of the antibody sequence.\n    * c1, c2, ..., cl are the numbers in the antibody sequence.\n\n**Output:**\n\n* Print G-2 lines, one for each gene value from 2 to G-1.  The output for each gene value should be either \"YES\" or \"NO\" followed by an integer."}, {"prompt_md5": "bce216fe", "template_md5": "465699a0", "result": "Given a set of rules for how a sequence of numbers can change, determine if a given set of patterns can detect all possible resulting sequences. If not, find the shortest undetectable sequence."}]}