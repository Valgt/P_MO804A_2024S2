{"uid": "1903-D2", "url": "https://codeforces.com/contest/1903/problem/D2", "tags": ["bitmasks", " divide and conquer", " dp", " greedy"], "title": "1903-D2", "statement": "D2. Maximum And Queries (hard version)time limit per test7 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputThis is the hard version of the problem. The only difference between the two versions is the constraint on $$$n$$$ and $$$q$$$, the memory and time limits. You can make hacks only if all versions of the problem are solved.Theofanis really likes to play with the bits of numbers. He has an array $$$a$$$ of size $$$n$$$ and an integer $$$k$$$. He can make at most $$$k$$$ operations in the array. In each operation, he picks a single element and increases it by $$$1$$$.He found themaximumbitwise ANDthat array $$$a$$$ can have after at most $$$k$$$ operations.Theofanis has put a lot of work into finding this value and was very happy with his result. Unfortunately, Adaś, being the evil person that he is, decided to bully him by repeatedly changing the value of $$$k$$$.Help Theofanis by calculating themaximumpossiblebitwise ANDfor $$$q$$$ different values of $$$k$$$. Note that queries are independent.InputThe first line contains two integers $$$n$$$ and $$$q$$$ ($$$1 \\\\le n, q \\\\le 10^6$$$) — the size of the array and the number of queries.The second line contains $$$n$$$ integers $$$a_1, a_2, \\\\ldots, a_n$$$ ($$$0 \\\\le a_i \\\\le 10^6$$$) — the elements of the array.Next $$$q$$$ lines describe the queries. The $$$i$$$-th line contains one integer $$$k_i$$$ ($$$0 \\\\le k_i \\\\le 10^{18}$$$) — the number of operations that can be done in the $$$i$$$-th query.OutputFor each query, print one integer — themaximumbitwise AND that array $$$a$$$ can have after at most $$$k_i$$$ operations.ExamplesInput4 21 3 7 5210Output2 6Input3 54 0 2981713Output5 4 7 0 1Input1 21052318381298321Output15 2318381298331NoteIn the first test case, in the first query, we add $$$1$$$ in the first and last elements of the array.Thus, the array becomes $$$[2,3,7,6]$$$ with bitwise AND equal to $$$2$$$.In the second test case, in the first query, we add $$$1$$$ in the first element, $$$5$$$ in the second, and $$$3$$$ in the third and now all the elements are equal to $$$5$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "33af50b8", "template_md5": "35d339e4", "result": "You are given an array of $n$ integers $a$ and $q$ queries. Each query has an integer $k_i$ associated with it.\n\nFor each query $i$, find the maximum possible bitwise AND of the array elements after performing at most $k_i$ operations. In each operation, you can choose one element in the array and increase its value by 1. \n\n**Input:**\n\n* The first line contains two integers $n$ and $q$ ($1 \\le n, q \\le 10^6$) - the size of the array and the number of queries.\n* The second line contains $n$ integers $a_1, a_2, ..., a_n$ ($0 \\le a_i \\le 10^6$) - the elements of the array.\n* The next $q$ lines describe the queries. The $i$-th line contains one integer $k_i$ ($0 \\le k_i \\le 10^{18}$) - the number of operations allowed for the $i$-th query.\n\n**Output:**\n\nFor each query, print one integer - the maximum possible bitwise AND of the array elements after performing at most $k_i$ operations."}, {"prompt_md5": "f5d17957", "template_md5": "465699a0", "result": "You are given an array of numbers and a series of values. For each value, find the largest possible result you can get by increasing at most that many numbers in the array. The result is the bitwise AND of all the numbers in the array."}]}