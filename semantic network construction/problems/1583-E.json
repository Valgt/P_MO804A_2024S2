{"uid": "1583-E", "url": "https://codeforces.com/contest/1583/problem/E", "tags": ["constructive algorithms", " dfs and similar", " graph matchings", " graphs", " greedy", " trees"], "title": "1583-E", "statement": "E. Moment of Bloomtime limit per test3 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputShe does her utmost to flawlessly carry out a person's last rites and preserve the world's balance of yin and yang.Hu Tao, being the little prankster she is, has tried to scare you with this graph problem! You are given a connected undirected graph of $$$n$$$ nodes with $$$m$$$ edges. You also have $$$q$$$ queries. Each query consists of two nodes $$$a$$$ and $$$b$$$.Initially, all edges in the graph have a weight of $$$0$$$. For each query, you must choose a simple path starting from $$$a$$$ and ending at $$$b$$$. Then you add $$$1$$$ to every edge along this path. Determine if it's possible, after processing all $$$q$$$ queries, for all edges in this graph to have an even weight. If so, output the choice of paths for each query.If it is not possible, determine the smallest number of extra queries you could add to make it possible. It can be shown that this number will not exceed $$$10^{18}$$$ under the given constraints.A simple path is defined as any path that does not visit a node more than once.An edge is said to have an even weight if its value is divisible by $$$2$$$.InputThe first line contains two integers $$$n$$$ and $$$m$$$ ($$$2 \\\\leq n \\\\leq 3 \\\\cdot 10^5$$$, $$$n-1 \\\\leq m \\\\leq \\\\min{\\\\left(\\\\frac{n(n-1)}{2}, 3 \\\\cdot 10^5\\\\right)}$$$).Each of the next $$$m$$$ lines contains two integers $$$x$$$ and $$$y$$$ ($$$1 \\\\leq x, y \\\\leq n$$$, $$$x\\\\neq y$$$) indicating an undirected edge between node $$$x$$$ and $$$y$$$. The input will not contain self-loops or duplicate edges, and the provided graph will be connected.The next line contains a single integer $$$q$$$ ($$$1 \\\\leq q \\\\leq 3 \\\\cdot 10^5$$$).Each of the next $$$q$$$ lines contains two integers $$$a$$$ and $$$b$$$ ($$$1 \\\\leq a, b \\\\leq n, a \\\\neq b$$$), the description of each query.It is guaranteed that $$$nq \\\\leq 3 \\\\cdot 10^5$$$.OutputIf it is possible to force all edge weights to be even, print \"YES\" on the first line, followed by $$$2q$$$ lines indicating the choice of path for each query in the same order the queries are given. For each query, the first line should contain a single integer $$$x$$$: the number of nodes in the chosen path. The next line should then contain $$$x$$$ spaced separated integers $$$p_i$$$ indicating the path you take ($$$p_1 = a, p_x = b$$$ and all numbers should fall between $$$1$$$ and $$$n$$$). This path cannot contain duplicate nodes and must be a valid simple path in the graph.If it is impossible to force all edge weights to be even, print \"NO\" on the first line and the minimum number of added queries on the second line.ExamplesInput6 7 2 1 2 3 3 5 1 4 6 1 5 6 4 5 3 1 4 5 1 4 5OutputYES 2 1 4 4 5 3 2 1 5 4 1 2 3 5Input5 7 4 3 4 5 2 1 1 4 1 3 3 5 3 2 4 4 2 3 5 5 1 4 5OutputNO 2NoteHere is what the queries look like for the first test case (red corresponds to the 1st query, blue 2nd query, and green 3rd query):Notice that every edge in the graph is part of either $$$0$$$ or $$$2$$$ colored query edges.The graph in the second test case looks like this:There does not exist an assignment of paths that will force all edges to have even weights with the given queries. One must add at least $$$2$$$ new queries to obtain a set of queries that can satisfy the condition.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "56b2079a", "template_md5": "465699a0", "result": "You are given a connected network of points.  Each point is connected to other points by edges. You have a set of requests, each asking to travel between two points. For each request, you must choose a path between the two points and increase the weight of each edge on that path by 1.  \n\nDetermine if it's possible to make the weight of every edge even after processing all the requests. If it's possible, list the chosen path for each request. If it's not possible, determine the fewest additional requests needed to make it possible."}, {"prompt_md5": "3d58c4c4", "template_md5": "35d339e4", "result": "You are given a connected undirected graph with $n$ nodes and $m$ edges. Each edge initially has a weight of 0.\n\nYou have $q$ queries. Each query consists of two nodes $a$ and $b$. For each query, you must choose a simple path from node $a$ to node $b$ and add 1 to the weight of each edge along this path.\n\nDetermine if it is possible, after processing all $q$ queries, for all edges in the graph to have an even weight.\n\nIf it is possible, output the chosen path for each query.\n\nIf it is not possible, determine the smallest number of additional queries you could add to make it possible. \n\n\n**Constraints:**\n\n* $2 \\leq n \\leq 3 \\cdot 10^5$\n* $n-1 \\leq m \\leq \\min(\\frac{n(n-1)}{2}, 3 \\cdot 10^5)$\n* $1 \\leq q \\leq 3 \\cdot 10^5$\n* $nq \\leq 3 \\cdot 10^5$\n* $1 \\leq a, b \\leq n$\n* $a \\neq b$"}]}