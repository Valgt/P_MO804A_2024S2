{"uid": "226-E", "url": "https://codeforces.com/contest/226/problem/E", "tags": ["data structures", " trees"], "title": "226-E", "statement": "E. Noble Knight's Pathtime limit per test4 secondsmemory limit per test256 megabytesinputstdinoutputstdoutIn Berland each feudal owns exactly one castle and each castle belongs to exactly one feudal.Each feudal, except one (the King) is subordinate to another feudal. A feudal can have any number of vassals (subordinates).Some castles are connected by roads, it is allowed to move along the roads in both ways. Two castles have a road between them if and only if the owner of one of these castles is a direct subordinate to the other owner.Each year exactly one of these two events may happen in Berland.The barbarians attacked castlec. The interesting fact is, the barbarians never attacked the same castle twice throughout the whole Berlandian history.A noble knight sets off on a journey from castleato castleb(provided that on his path he encounters each castle not more than once).Let's consider the second event in detail. As the journey fromatobis not short, then the knight might want to stop at a castle he encounters on his way to have some rest. However, he can't stop at just any castle: his nobility doesn't let him stay in the castle that has been desecrated by the enemy's stench. A castle is desecrated if and only if it has been attacked after the year ofy. So, the knight chooses thek-th castle he encounters, starting froma(castlesaandbaren't taken into consideration), that hasn't been attacked in years fromy+ 1till current year.The knights don't remember which castles were attacked on what years, so he asked the court scholar, aka you to help them. You've got a sequence of events in the Berland history. Tell each knight, in what city he should stop or else deliver the sad news — that the path from cityato citybhas less thankcities that meet his requirements, so the knight won't be able to rest.InputThe first input line contains integern(2 ≤n≤ 105)— the number of feudals.The next line containsnspace-separated integers: thei-th integer shows either the number of thei-th feudal's master, or a0, if thei-th feudal is the King.The third line contains integerm(1 ≤m≤ 105)— the number of queries.Then followmlines that describe the events. Thei-th line (the lines are indexed starting from1) contains the description of the event that occurred in yeari. Each event is characterised by typeti(1 ≤ti≤ 2). The description of the first type event looks as two space-separated integerstici(ti= 1; 1 ≤ci≤n), whereciis the number of the castle that was attacked by the barbarians in thei-th year. The description of the second type contains five space-separated integers:tiaibikiyi(ti= 2; 1 ≤ai,bi,ki≤n;ai≠bi; 0 ≤yi<i), whereaiis the number of the castle from which the knight is setting off,biis the number of the castle to which the knight is going,kiandyiare thekandyfrom the second event's description.You can consider the feudals indexed from 1 ton. It is guaranteed that there is only one king among the feudals. It is guaranteed that for the first type events all valuesciare different.OutputFor each second type event print an integer — the number of the castle where the knight must stay to rest, or -1, if he will have to cover the distance fromaitobiwithout a rest. Separate the answers by whitespaces.Print the answers in the order, in which the second type events are given in the input.ExamplesInput30 1 252 1 3 1 01 22 1 3 1 02 1 3 1 12 1 3 1 2Output2-1-12Input62 5 2 2 0 532 1 6 2 01 22 4 5 1 0Output5-1NoteIn the first sample there is only castle2on the knight's way from castle1to castle3. When the knight covers the path1 - 3for the first time, castle2won't be desecrated by an enemy and the knight will stay there. In the second year the castle2will become desecrated, so the knight won't have anywhere to stay for the next two years (as finding a castle that hasn't been desecrated from years1and2, correspondingly, is important for him). In the fifth year the knight won't consider the castle2desecrated, so he will stay there again.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "062d77a7", "template_md5": "35d339e4", "result": "There are $n$ castles, each owned by a feudal lord.  One feudal lord is the King, and all other lords are subordinate to exactly one other lord.  Roads connect some pairs of castles, and a road exists between two castles if and only if one lord is a direct subordinate to the other.\n\nBarbarians attack exactly one castle each year.  A knight wants to travel from castle $a$ to castle $b$ and wants to stop at a castle along the way to rest.  The knight cannot stop at a castle that has been attacked in or after year $y$.\n\nYou are given a list of events:\n\n* **Type 1:** A castle $c$ is attacked in year $i$.\n* **Type 2:** A knight wants to travel from castle $a$ to castle $b$, and wants to stop at the $k$-th castle they encounter along the way that has not been attacked in years from $y+1$ to the current year.\n\nFor each Type 2 event, determine the number of the castle where the knight should stop, or -1 if there is no suitable castle."}, {"prompt_md5": "917a3cb8", "template_md5": "465699a0", "result": "You are given a hierarchy of people where each person reports to one other person except for the top person.  Some pairs of people are connected by roads.  \n\nYou are also given a list of events where some people are attacked.  \n\nFor each query, you are given two people and a number k.  You need to find the k-th person on the path between the two given people who was not attacked after a specific year. If there are not enough unattacked people on the path, output -1."}]}