{"uid": "643-E", "url": "https://codeforces.com/contest/643/problem/E", "tags": ["dp", " math", " probabilities", " trees"], "title": "643-E", "statement": "E. Bear and Destroying Subtreestime limit per test5 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputLimak is a little grizzly bear. He will once attack Deerland but now he can only destroy trees in role-playing games. Limak starts with a tree with one vertex. The only vertex has index1and is a root of the tree.Sometimes, a game chooses a subtree and allows Limak to attack it. When a subtree is attacked then each of its edges is destroyed with probability, independently of other edges. Then, Limak gets the penalty — an integer equal to the height of the subtree after the attack. The height is defined as the maximum number of edges on the path between the root of the subtree and any vertex in the subtree.You must handle queries of two types.1 vdenotes a query of the first type. A new vertex appears and its parent isv. A new vertex has the next available index (so, new vertices will be numbered2, 3, ...).2 vdenotes a query of the second type. For a moment let's assume that the game allows Limak to attack a subtree rooted inv. Then, what would be the expected value of the penalty Limak gets after the attack?In a query of the second type, Limak doesn't actually attack the subtree and thus the query doesn't affect next queries.InputThe first line of the input contains one integerq(1 ≤q≤ 500 000) — the number of queries.Then,qlines follow. Thei-th of them contains two integerstypeiandvi(1 ≤typei≤ 2). Iftypei= 1thenvidenotes a parent of a new vertex, while iftypei= 2then you should print the answer for a subtree rooted invi.It's guaranteed that there will be at least1query of the second type, that is, the output won't be empty.It's guaranteed that just before thei-th query a vertexvialready exists.OutputFor each query of the second type print one real number —the expected value of the penalty if Limak attacks the given subtree. Your answer will be considered correct if its absolute or relative error does not exceed10- 6.Namely: let's assume that your answer isa, and the answer of the jury isb. The checker program will consider your answer correct if.ExamplesInput71 11 12 11 21 32 22 1Output0.75000000000.50000000001.1875000000Input82 11 11 21 31 42 11 42 1Output0.00000000000.93750000000.9687500000NoteBelow, you can see the drawing for the first sample. Red circles denote queries of the second type.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "f153180b", "template_md5": "35d339e4", "result": "You are given a tree with one vertex initially.  New vertices can be added to the tree, each with a parent vertex.  \n\nFor each vertex, you are asked to calculate the expected height of the subtree rooted at that vertex after a random attack.  \n\nIn the attack, each edge in the subtree has a probability of being destroyed independently. The height of a subtree is the maximum number of edges on the path from the root to any vertex in the subtree.\n\n\nThe input consists of a series of queries:\n\n* **Type 1:**  Adds a new vertex as a child of a given vertex.\n* **Type 2:**  Asks for the expected height of the subtree rooted at a given vertex after the attack.\n\nOutput the expected height for each Type 2 query."}, {"prompt_md5": "0016ee72", "template_md5": "465699a0", "result": "A tree is built one node at a time.  Each node can be the target of an attack.  An attack has a chance of destroying each edge in the target subtree. The penalty for an attack is the height of the remaining subtree.  You are given a series of queries:\n\n* **Type 1:** Add a new node to the tree, specifying its parent.\n* **Type 2:**  For a given node, calculate the expected penalty if the subtree rooted at that node were attacked."}]}