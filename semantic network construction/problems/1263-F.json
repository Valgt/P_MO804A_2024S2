{"uid": "1263-F", "url": "https://codeforces.com/contest/1263/problem/F", "tags": ["data structures", " dfs and similar", " dp", " flows", " graphs", " trees"], "title": "1263-F", "statement": "F. Economic Difficultiestime limit per test3 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputAn electrical grid in Berland palaces consists of 2 grids: main and reserve. Wires in palaces are made of expensive material, so selling some of them would be a good idea!Each grid (main and reserve) has a head node (its number is $$$1$$$). Every other node gets electricity from the head node. Each node can be reached from the head node by a unique path. Also, both grids have exactly $$$n$$$ nodes, which do not spread electricity further.In other words, every grid is a rooted directed tree on $$$n$$$ leaves with a root in the node, which number is $$$1$$$. Each tree has independent enumeration and nodes from one grid are not connected with nodes of another grid.Also, the palace has $$$n$$$ electrical devices. Each device is connected with one node of the main grid and with one node of the reserve grid. Devices connect only with nodes, from which electricity is not spread further (these nodes are the tree's leaves). Each grid's leaf is connected with exactly one device.In this example the main grid contains $$$6$$$ nodes (the top tree) and the reserve grid contains $$$4$$$ nodes (the lower tree). There are $$$3$$$ devices with numbers colored in blue.It is guaranteed that the whole grid (two grids and $$$n$$$ devices) can be shown in this way (like in the picture above):main grid is a top tree, whose wires are directed 'from the top to the down',reserve grid is a lower tree, whose wires are directed 'from the down to the top',devices — horizontal row between two grids, which are numbered from $$$1$$$ to $$$n$$$ from the left to the right,wires between nodes do not intersect.Formally, for each tree exists a depth-first search from the node with number $$$1$$$, that visits leaves in order of connection to devices $$$1, 2, \\\\dots, n$$$ (firstly, the node, that is connected to the device $$$1$$$, then the node, that is connected to the device $$$2$$$, etc.).Businessman wants to sell (remove)maximalamount of wires so that each device will be powered from at least one grid (main or reserve). In other words, for each device should exist at least one path to the head node (in the main grid or the reserve grid), which contains only nodes from one grid.InputThe first line contains an integer $$$n$$$ ($$$1 \\\\le n \\\\le 1000$$$) — the number of devices in the palace.The next line contains an integer $$$a$$$ ($$$1 + n \\\\le a \\\\le 1000 + n$$$) — the amount of nodes in the main grid.Next line contains $$$a - 1$$$ integers $$$p_i$$$ ($$$1 \\\\le p_i \\\\le a$$$). Each integer $$$p_i$$$ means that the main grid contains a wire from $$$p_i$$$-th node to $$$(i + 1)$$$-th.The next line contains $$$n$$$ integers $$$x_i$$$ ($$$1 \\\\le x_i \\\\le a$$$) — the number of a node in the main grid that is connected to the $$$i$$$-th device.The next line contains an integer $$$b$$$ ($$$1 + n \\\\le b \\\\le 1000 + n$$$) — the amount of nodes in the reserve grid.Next line contains $$$b - 1$$$ integers $$$q_i$$$ ($$$1 \\\\le q_i \\\\le b$$$). Each integer $$$q_i$$$ means that the reserve grid contains a wire from $$$q_i$$$-th node to $$$(i + 1)$$$-th.The next line contains $$$n$$$ integers $$$y_i$$$ ($$$1 \\\\le y_i \\\\le b$$$) — the number of a node in the reserve grid that is connected to the $$$i$$$-th device.It is guaranteed that each grid is a tree, which has exactly $$$n$$$ leaves and each leaf is connected with one device. Also, it is guaranteed, that for each tree exists a depth-first search from the node $$$1$$$, that visits leaves in order of connection to devices.OutputPrint a single integer — the maximal amount of wires that can be cut so that each device is powered.ExamplesInput3 6 4 1 1 4 2 6 5 3 4 1 1 1 3 4 2Output5Input4 6 4 4 1 1 1 3 2 6 5 6 6 6 1 1 1 5 4 3 2Output6Input5 14 1 1 11 2 14 14 13 7 12 2 5 6 1 9 8 3 10 4 16 1 1 9 9 2 5 10 1 14 3 7 11 6 12 2 8 16 13 4 15Output17NoteFor the first example, the picture below shows one of the possible solutions (wires that can be removed are marked in red):The second and the third examples can be seen below:", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "89ca668b", "template_md5": "35d339e4", "result": "There are two electrical grids, a main grid and a reserve grid, each with $n$ nodes.  Each grid is a rooted directed tree with the root at node 1.  Each node in a grid is connected to exactly one other node in the same grid.\n\nThere are also $n$ devices, each connected to one node in the main grid and one node in the reserve grid.\n\nYou want to remove the maximum number of wires from the grids so that each device is still powered. A device is powered if there is at least one path from it to the root of either grid.\n\n**Input:**\n\n* $n$: the number of devices\n* $a$: the number of nodes in the main grid\n* $p_1, p_2, ..., p_{a-1}$: the connections in the main grid (each $p_i$ represents a wire from node $p_i$ to node $i+1$)\n* $x_1, x_2, ..., x_n$: the node in the main grid connected to each device\n* $b$: the number of nodes in the reserve grid\n* $q_1, q_2, ..., q_{b-1}$: the connections in the reserve grid (each $q_i$ represents a wire from node $q_i$ to node $i+1$)\n* $y_1, y_2, ..., y_n$: the node in the reserve grid connected to each device\n\n**Output:**\n\n* The maximum number of wires that can be removed."}, {"prompt_md5": "5cd7de41", "template_md5": "465699a0", "result": "You have two trees, each with $n$ leaves. Each leaf is connected to a device.  You need to remove the minimum number of wires from the trees so that each device can still be powered by at least one of the trees."}]}