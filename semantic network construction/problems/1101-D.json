{"uid": "1101-D", "url": "https://codeforces.com/contest/1101/problem/D", "tags": ["data structures", " dfs and similar", " dp", " number theory", " trees"], "title": "1101-D", "statement": "D. GCD Countingtime limit per test4.5 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputYou are given a tree consisting of $$$n$$$ vertices. A number is written on each vertex; the number on vertex $$$i$$$ is equal to $$$a_i$$$.Let's denote the function $$$g(x, y)$$$ as the greatest common divisor of the numbers written on the vertices belonging to the simple path from vertex $$$x$$$ to vertex $$$y$$$ (including these two vertices). Also let's denote $$$dist(x, y)$$$ as the number of vertices on the simple path between vertices $$$x$$$ and $$$y$$$, including the endpoints. $$$dist(x, x) = 1$$$ for every vertex $$$x$$$.Your task is calculate the maximum value of $$$dist(x, y)$$$ among such pairs of vertices that $$$g(x, y) > 1$$$.InputThe first line contains one integer $$$n$$$ — the number of vertices $$$(1 \\\\le n \\\\le 2 \\\\cdot 10^5)$$$.The second line contains $$$n$$$ integers $$$a_1$$$, $$$a_2$$$, ..., $$$a_n$$$ $$$(1 \\\\le a_i \\\\le 2 \\\\cdot 10^5)$$$ — the numbers written on vertices.Then $$$n - 1$$$ lines follow, each containing two integers $$$x$$$ and $$$y$$$ $$$(1 \\\\le x, y \\\\le n, x \\\\ne y)$$$ denoting an edge connecting vertex $$$x$$$ with vertex $$$y$$$. It is guaranteed that these edges form a tree.OutputIf there is no pair of vertices $$$x, y$$$ such that $$$g(x, y) > 1$$$, print $$$0$$$. Otherwise print the maximum value of $$$dist(x, y)$$$ among such pairs.ExamplesInput32 3 41 22 3Output1Input32 3 41 32 3Output2Input31 1 11 22 3Output0", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "16b2c511", "template_md5": "35d339e4", "result": "You are given a tree with $n$ vertices. Each vertex has a number written on it, $a_1, a_2, ..., a_n$.\n\nDefine a function $g(x, y)$ as the greatest common divisor (GCD) of the numbers on the path from vertex $x$ to vertex $y$ (including both vertices).\n\nDefine a function $dist(x, y)$ as the number of vertices on the path from vertex $x$ to vertex $y$ (including both vertices).\n\nFind the maximum value of $dist(x, y)$ where $g(x, y) > 1$. If no such pair of vertices exists, print 0."}, {"prompt_md5": "09f019c8", "template_md5": "465699a0", "result": "You are given a tree-like structure with numbers on each node. Find the longest path between two nodes where the greatest common divisor of the numbers on the path is greater than 1. If no such path exists, output 0."}]}