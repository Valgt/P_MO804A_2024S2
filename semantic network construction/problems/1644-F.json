{"uid": "1644-F", "url": "https://codeforces.com/contest/1644/problem/F", "tags": ["combinatorics", " fft", " math", " number theory"], "title": "1644-F", "statement": "F. Basistime limit per test6 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputFor an array of integers $$$a$$$, let's define $$$|a|$$$ as the number of elements in it.Let's denote two functions:$$$F(a, k)$$$ is a function that takes an array of integers $$$a$$$ and a positive integer $$$k$$$. The result of this function is the array containing $$$|a|$$$ first elements of the array that you get by replacing each element of $$$a$$$ with exactly $$$k$$$ copies of that element.For example, $$$F([2, 2, 1, 3, 5, 6, 8], 2)$$$ is calculated as follows: first, you replace each element of the array with $$$2$$$ copies of it, so you obtain $$$[2, 2, 2, 2, 1, 1, 3, 3, 5, 5, 6, 6, 8, 8]$$$. Then, you take the first $$$7$$$ elements of the array you obtained, so the result of the function is $$$[2, 2, 2, 2, 1, 1, 3]$$$.$$$G(a, x, y)$$$ is a function that takes an array of integers $$$a$$$ and twodifferentintegers $$$x$$$ and $$$y$$$. The result of this function is the array $$$a$$$ with every element equal to $$$x$$$ replaced by $$$y$$$, and every element equal to $$$y$$$ replaced by $$$x$$$.For example, $$$G([1, 1, 2, 3, 5], 3, 1) = [3, 3, 2, 1, 5]$$$.An array $$$a$$$ is aparentof the array $$$b$$$ if:either there exists a positive integer $$$k$$$ such that $$$F(a, k) = b$$$;or there exist two different integers $$$x$$$ and $$$y$$$ such that $$$G(a, x, y) = b$$$.An array $$$a$$$ is anancestorof the array $$$b$$$ if there exists a finite sequence of arrays $$$c_0, c_1, \\\\dots, c_m$$$ ($$$m \\\\ge 0$$$) such that $$$c_0$$$ is $$$a$$$, $$$c_m$$$ is $$$b$$$, and for every $$$i \\\\in [1, m]$$$, $$$c_{i-1}$$$ is a parent of $$$c_i$$$.And now, the problem itself.You are given two integers $$$n$$$ and $$$k$$$. Your goal is to construct a sequence of arrays $$$s_1, s_2, \\\\dots, s_m$$$ in such a way that:every array $$$s_i$$$ contains exactly $$$n$$$ elements, and all elements are integers from $$$1$$$ to $$$k$$$;for every array $$$a$$$ consisting of exactly $$$n$$$ integers from $$$1$$$ to $$$k$$$, the sequence contains at least one array $$$s_i$$$ such that $$$s_i$$$ is an ancestor of $$$a$$$.Print the minimum number of arrays in such sequence.InputThe only line contains two integers $$$n$$$ and $$$k$$$ ($$$1 \\\\le n, k \\\\le 2 \\\\cdot 10^5$$$).OutputPrint one integer â€” the minimum number of elements in a sequence of arrays meeting the constraints. Since the answer can be large, output it modulo $$$998244353$$$.ExamplesInput3 2Output2Input4 10Output12Input13 37Output27643508Input1337 42Output211887828Input198756 123456Output159489391Input123456 198756Output460526614NoteLet's analyze the first example.One of the possible answers for the first example is the sequence $$$[[2, 1, 2], [1, 2, 2]]$$$. Every array of size $$$3$$$ consisting of elements from $$$1$$$ to $$$2$$$ has an ancestor in this sequence:for the array $$$[1, 1, 1]$$$, the ancestor is $$$[1, 2, 2]$$$: $$$F([1, 2, 2], 13) = [1, 1, 1]$$$;for the array $$$[1, 1, 2]$$$, the ancestor is $$$[1, 2, 2]$$$: $$$F([1, 2, 2], 2) = [1, 1, 2]$$$;for the array $$$[1, 2, 1]$$$, the ancestor is $$$[2, 1, 2]$$$: $$$G([2, 1, 2], 1, 2) = [1, 2, 1]$$$;for the array $$$[1, 2, 2]$$$, the ancestor is $$$[1, 2, 2]$$$;for the array $$$[2, 1, 1]$$$, the ancestor is $$$[1, 2, 2]$$$: $$$G([1, 2, 2], 1, 2) = [2, 1, 1]$$$;for the array $$$[2, 1, 2]$$$, the ancestor is $$$[2, 1, 2]$$$;for the array $$$[2, 2, 1]$$$, the ancestor is $$$[2, 1, 2]$$$: $$$F([2, 1, 2], 2) = [2, 2, 1]$$$;for the array $$$[2, 2, 2]$$$, the ancestor is $$$[1, 2, 2]$$$: $$$G(F([1, 2, 2], 4), 1, 2) = G([1, 1, 1], 1, 2) = [2, 2, 2]$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "28b9840d", "template_md5": "35d339e4", "result": "You are given two integers $n$ and $k$.  You need to find the minimum number of arrays you can create to satisfy these conditions:\n\n* Each array must have exactly $n$ elements.\n* Each element in an array must be an integer from 1 to $k$.\n* For every possible array of size $n$ with elements from 1 to $k$, there must be at least one of your created arrays that is an \"ancestor\" of it.\n\nHere's how \"ancestor\" is defined:\n\n* **Parent:**  An array $b$ is a *parent* of an array $a$ if:\n    * You can create $b$ by taking $a$ and replacing each element with $k$ copies of itself (function $F(a, k)$).\n    * Or, you can create $b$ by swapping two different elements in $a$ (function $G(a, x, y)$).\n\n* **Ancestor:** An array $b$ is an *ancestor* of an array $a$ if there is a sequence of arrays where:\n    * The first array is $a$.\n    * The last array is $b$.\n    * Each array in the sequence is a parent of the next array.\n\n\n\nOutput the minimum number of arrays needed, modulo 998244353."}, {"prompt_md5": "daab9e4d", "template_md5": "465699a0", "result": "You are given two numbers, *n* and *k*.  You need to create a list of arrays, where each array has *n* numbers from 1 to *k*.  The goal is to make sure that for any possible array of *n* numbers from 1 to *k*, it can be created by modifying one of your arrays in a specific way (either by repeating numbers or swapping two numbers). Find the smallest number of arrays you need to achieve this."}]}