{"uid": "1426-F", "url": "https://codeforces.com/contest/1426/problem/F", "tags": ["combinatorics", " dp", " strings"], "title": "1426-F", "statement": "F. Number of Subsequencestime limit per test1 secondmemory limit per test256 megabytesinputstandard inputoutputstandard outputYou are given a string $$$s$$$ consisting of lowercase Latin letters \"a\", \"b\" and \"c\" and question marks \"?\".Let the number of question marks in the string $$$s$$$ be $$$k$$$. Let's replace each question mark with one of the letters \"a\", \"b\" and \"c\". Here we can obtain all $$$3^{k}$$$ possible strings consisting only of letters \"a\", \"b\" and \"c\". For example, if $$$s = $$$\"ac?b?c\" then we can obtain the following strings: $$$[$$$\"acabac\", \"acabbc\", \"acabcc\", \"acbbac\", \"acbbbc\", \"acbbcc\", \"accbac\", \"accbbc\", \"accbcc\"$$$]$$$.Your task is to count the total number of subsequences \"abc\" in all resulting strings. Since the answer can be very large, print it modulo $$$10^{9} + 7$$$.A subsequence of the string $$$t$$$ is such a sequence that can be derived from the string $$$t$$$ after removing some (possibly, zero) number of letters without changing the order of remaining letters. For example, the string \"baacbc\" contains two subsequences \"abc\" — a subsequence consisting of letters at positions $$$(2, 5, 6)$$$ and a subsequence consisting of letters at positions $$$(3, 5, 6)$$$.InputThe first line of the input contains one integer $$$n$$$ $$$(3 \\\\le n \\\\le 200\\\\,000)$$$ — the length of $$$s$$$.The second line of the input contains the string $$$s$$$ of length $$$n$$$ consisting of lowercase Latin letters \"a\", \"b\" and \"c\" and question marks\"?\".OutputPrint the total number of subsequences \"abc\" in all strings you can obtain if you replace all question marks with letters \"a\", \"b\" and \"c\", modulo $$$10^{9} + 7$$$.ExamplesInput6 ac?b?cOutput24Input7 ???????Output2835Input9 cccbbbaaaOutput0Input5 a???cOutput46NoteIn the first example, we can obtain $$$9$$$ strings:\"acabac\" — there are $$$2$$$ subsequences \"abc\",\"acabbc\" — there are $$$4$$$ subsequences \"abc\",\"acabcc\" — there are $$$4$$$ subsequences \"abc\",\"acbbac\" — there are $$$2$$$ subsequences \"abc\",\"acbbbc\" — there are $$$3$$$ subsequences \"abc\",\"acbbcc\" — there are $$$4$$$ subsequences \"abc\",\"accbac\" — there is $$$1$$$ subsequence \"abc\",\"accbbc\" — there are $$$2$$$ subsequences \"abc\",\"accbcc\" — there are $$$2$$$ subsequences \"abc\".So, there are $$$2 + 4 + 4 + 2 + 3 + 4 + 1 + 2 + 2 = 24$$$ subsequences \"abc\" in total.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "7a9af63d", "template_md5": "35d339e4", "result": "You are given a string consisting of lowercase letters \"a\", \"b\", \"c\", and \"?\".  \n\nReplace each \"?\" with one of the letters \"a\", \"b\", or \"c\".  \n\nCount the total number of subsequences \"abc\" in all the possible strings you can create after the replacements.  \n\nThe answer can be very large, so print it modulo $10^9 + 7$. \n\n\nFor example:\n\nIf the input string is \"ac?b?c\", the possible strings are:\n\n* \"acabac\"\n* \"acabbc\"\n* \"acabcc\"\n* \"acbbac\"\n* \"acbbbc\"\n* \"acbbcc\"\n* \"accbac\"\n* \"accbbc\"\n* \"accbcc\"\n\nThere are 24 subsequences \"abc\" in total."}, {"prompt_md5": "5e24c7e4", "template_md5": "465699a0", "result": "You are given a string with lowercase letters 'a', 'b', 'c', and question marks.  Replace each question mark with any of these letters. Count how many times the sequence \"abc\" appears in all the possible resulting strings.  The answer can be very large, so give the result modulo 10^9 + 7."}]}