{"uid": "1641-E", "url": "https://codeforces.com/contest/1641/problem/E", "tags": ["combinatorics", " divide and conquer", " fft", " math"], "title": "1641-E", "statement": "E. Special Positionstime limit per test5 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputYou are given an array $$$a$$$ of length $$$n$$$. Also you are given $$$m$$$ distinct positions $$$p_1, p_2, \\\\ldots, p_m$$$ ($$$1 \\\\leq p_i \\\\leq n$$$).Anon-emptysubset of these positions $$$T$$$ is randomly selected with equal probability and the following value is calculated: $$$$$$\\\\sum_{i=1}^{n} (a_i \\\\cdot \\\\min_{j \\\\in T} \\\\left|i - j\\\\right|).$$$$$$ In other word, for each index of the array, $$$a_i$$$ and the distance to the closest chosen position are multiplied, and then these values are summed up.Find the expected value of this sum.This value must be found modulo $$$998\\\\,244\\\\,353$$$. More formally, let $$$M = 998\\\\,244\\\\,353$$$. It can be shown that the answer can be represented as an irreducible fraction $$$\\\\frac{p}{q}$$$, where $$$p$$$ and $$$q$$$ are integers and $$$q \\\\neq 0$$$ (mod $$$M$$$). Output the integer equal to $$$p \\\\cdot q^{-1}$$$ (mod $$$M$$$). In other words, output such integer $$$x$$$ that $$$0 \\\\leq x < M$$$ and $$$x \\\\cdot q = p$$$ (mod $$$M$$$).InputThe first line contains two integers $$$n$$$ and $$$m$$$ ($$$1 \\\\leq m \\\\leq n \\\\leq 10^5$$$).The second line contains $$$n$$$ integers $$$a_1, a_2, \\\\ldots, a_n$$$ ($$$0 \\\\leq a_i < 998\\\\,244\\\\,353$$$).The third line contains $$$m$$$ distinct integers $$$p_1, p_2, \\\\ldots, p_m$$$ ($$$1 \\\\leq p_i \\\\le n$$$).For every $$$1 \\\\leq i < m$$$ it is guaranteed that $$$p_i < p_{i+1}$$$.OutputPrint a single integer — the answer to the problem.ExamplesInput4 2 1 2 3 4 1 4Output665496247Input6 6 4 2 4 2 4 2 1 2 3 4 5 6Output855638030NoteIn the first test:If only $$$1$$$ is choosen, than the value equals to $$$1 \\\\cdot 0 + 2 \\\\cdot 1 + 3 \\\\cdot 2 + 4 \\\\cdot 3 = 20$$$.If only $$$4$$$ is choosen, than the value equals to $$$1 \\\\cdot 3 + 2 \\\\cdot 2 + 3 \\\\cdot 1 + 4 \\\\cdot 0 = 10$$$.If both positions are chosen, than the value equals to $$$1 \\\\cdot 0 + 2 \\\\cdot 1 + 3 \\\\cdot 1 + 4 \\\\cdot 0 = 5$$$.The answer to the problem is $$$\\\\frac{20 + 10 + 5}{3} = \\\\frac{35}{3} = 665\\\\,496\\\\,247$$$ (modulo $$$998\\\\,244\\\\,353$$$).", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "54939d94", "template_md5": "35d339e4", "result": "You are given an array of $n$ integers, $a = (a_1, a_2, ..., a_n)$. You are also given $m$ distinct positions, $p_1, p_2, ..., p_m$ ($1 \\le p_i \\le n$).\n\nA random subset of these positions is chosen, with each subset having an equal probability of being selected.  \n\nFor each chosen subset $T$, calculate the following sum:\n\n$$\\sum_{i=1}^{n} (a_i \\cdot \\min_{j \\in T} |i - j|)$$\n\nThis means for each index $i$ in the array, you multiply $a_i$ by the distance to the closest position in the chosen subset $T$. Then, you sum up all these products.\n\nFind the expected value of this sum, modulo 998244353.  \n\nIn other words, find the integer $x$ such that:\n\n$$0 \\le x < 998244353$$\n\nand\n\n$$x \\cdot q \\equiv p \\pmod{998244353}$$\n\nwhere $p$ and $q$ are integers representing the numerator and denominator of the expected value (in its simplest form)."}, {"prompt_md5": "b573e229", "template_md5": "465699a0", "result": "You have a list of numbers and a set of positions within that list.  A random subset of those positions is chosen.  Calculate the average sum of each number in the list multiplied by its distance to the nearest chosen position.  The answer should be a whole number."}]}