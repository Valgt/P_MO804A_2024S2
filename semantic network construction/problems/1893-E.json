{"uid": "1893-E", "url": "https://codeforces.com/contest/1893/problem/E", "tags": ["combinatorics", " dfs and similar", " dp", " graphs"], "title": "1893-E", "statement": "E. Cacti Symphonytime limit per test3 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputYou are given an undirected connected graph in which any two distinct simple cyclesdo not havecommon vertices. Since the graph can be very large, it is given to you in a compressed form: for each edge, you are also given a number $$$d$$$, which indicates that there are $$$d$$$ additional vertices on this edge.You need to assign a weight to each vertex and each edge of the graph — an integer from $$$1$$$ to $$$3$$$.An edge of the graph is calledgoodif thebitwise XORof the weights of its adjacent vertices isnot equal to$$$0$$$ andnot equal tothe weight of that edge.Similarly, a vertex of the graph is calledgoodif thebitwise XORof the weights of its adjacent edges isnot equal to$$$0$$$ andnot equal tothe weight of that vertex.You need to determine how many ways there are to assign weights to the vertices and edges of the graph so that all vertices and edges aregood. Since the answer can be quite large, you need to calculate the remainder of the answer divided by $$$998\\\\,244\\\\,353$$$.InputThe first line contains two integers $$$n$$$ and $$$m$$$ — the number of vertices and the number of edges in the graph ($$$2 \\\\le n \\\\le 5 \\\\cdot 10^5$$$, $$$n - 1 \\\\le m \\\\le 10^6$$$).Each of the next $$$m$$$ lines contains three integers $$$a_i, b_i$$$, and $$$d_i$$$ ($$$1 \\\\le a_i, b_i \\\\le n$$$, $$$a_i \\\\ne b_i$$$, $$$0 \\\\le d_i \\\\le 10^9$$$), indicating that there is an edge in the graph connecting vertices $$$a_i$$$ and $$$b_i$$$. Additionally, on this edge, there are $$$d_i$$$ additional vertices. It is guaranteed that the given graph is connected, there are no multiple edges, loops, and any two distinct simple cycles of the graphdo not havecommon vertices.OutputOutput a single integer — the answer to the problem modulo $$$998\\\\,244\\\\,353$$$.ExamplesInput3 3 1 2 0 2 3 0 3 1 0Output12Input6 7 1 2 0 2 3 0 3 1 0 4 5 0 5 6 0 6 4 0 4 3 0Output0Input2 1 2 1 777Output0Input3 3 1 2 0 2 3 110850709 3 1 1000000000Output179179178NoteIn the first test, the graph is a simple cycle of $$$3$$$ vertices. It can be shown, that there are exactly $$$12$$$ ways to assign weights, to make all vertexes and edgesgood.In the second test, the graph has the form of two simple cycles of $$$3$$$ vertices connected by an edge. It can be shown that for such a graph there are no ways to arrange weights so that all vertices and edges aregood.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "4208f4ee", "template_md5": "35d339e4", "result": "You are given a connected graph with $n$ vertices and $m$ edges. The graph is represented in a compressed form: for each edge $(a_i, b_i)$, you are given a number $d_i$ representing the number of additional vertices on that edge.\n\nYou need to assign a weight to each vertex and each edge, where the weights can be integers from 1 to 3.\n\nAn edge is considered \"good\" if the bitwise XOR of the weights of its adjacent vertices is not equal to 0 and not equal to the weight of the edge.\n\nA vertex is considered \"good\" if the bitwise XOR of the weights of its adjacent edges is not equal to 0 and not equal to the weight of the vertex.\n\nFind the number of ways to assign weights to the vertices and edges so that all vertices and edges are \"good\".  Since the answer can be large, output the remainder of the answer divided by $998244353$."}, {"prompt_md5": "1a52a9fe", "template_md5": "465699a0", "result": "You are given a connected graph with edges that may have additional vertices. You need to assign a number from 1 to 3 to each vertex and edge in the graph.  An edge or vertex is \"good\" if the sum of the numbers assigned to its connected vertices or edges is not zero and is not equal to the number assigned to the edge or vertex itself.  Find the number of ways to assign numbers so that all vertices and edges are \"good\". The answer should be the remainder when divided by 998244353."}]}