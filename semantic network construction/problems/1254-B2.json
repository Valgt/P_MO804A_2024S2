{"uid": "1254-B2", "url": "https://codeforces.com/contest/1254/problem/B2", "tags": ["constructive algorithms", " greedy", " math", " number theory", " ternary search", " two pointers"], "title": "1254-B2", "statement": "B2. Send Boxes to Alice (Hard Version)time limit per test1 secondmemory limit per test256 megabytesinputstandard inputoutputstandard outputThis is the harder version of the problem. In this version, $$$1 \\\\le n \\\\le 10^6$$$ and $$$0 \\\\leq a_i \\\\leq 10^6$$$. You can hack this problem if you locked it. But you can hack the previous problem only if you locked both problemsChristmas is coming, and our protagonist, Bob, is preparing a spectacular present for his long-time best friend Alice. This year, he decides to prepare $$$n$$$ boxes of chocolate, numbered from $$$1$$$ to $$$n$$$. Initially, the $$$i$$$-th box contains $$$a_i$$$ chocolate pieces.Since Bob is a typical nice guy, he will not send Alice $$$n$$$ empty boxes. In other words,at least one of $$$a_1, a_2, \\\\ldots, a_n$$$ is positive. Since Alice dislikes coprime sets, she will be happy only if there exists some integer $$$k > 1$$$ such that the number of pieces in each box is divisible by $$$k$$$. Note that Alice won't mind if there exists some empty boxes.Charlie, Alice's boyfriend, also is Bob's second best friend, so he decides to help Bob by rearranging the chocolate pieces. In one second, Charlie can pick up a piece in box $$$i$$$ and put it into either box $$$i-1$$$ or box $$$i+1$$$ (if such boxes exist). Of course, he wants to help his friend as quickly as possible. Therefore, he asks you to calculate the minimum number of seconds he would need to make Alice happy.InputThe first line contains a single integer $$$n$$$ ($$$1 \\\\le n \\\\le 10^6$$$) — the number of chocolate boxes.The second line contains $$$n$$$ integers $$$a_1, a_2, \\\\ldots, a_n$$$ ($$$0 \\\\le a_i \\\\le 10^6$$$) — the number of chocolate pieces in the $$$i$$$-th box.It is guaranteed that at least one of $$$a_1, a_2, \\\\ldots, a_n$$$ is positive.OutputIf there is no way for Charlie to make Alice happy, print $$$-1$$$.Otherwise, print a single integer $$$x$$$ — the minimum number of seconds for Charlie to help Bob make Alice happy.ExamplesInput3 4 8 5Output9Input5 3 10 2 1 5Output2Input4 0 5 15 10Output0Input1 1Output-1NoteIn the first example, Charlie can move all chocolate pieces to the second box. Each box will be divisible by $$$17$$$.In the second example, Charlie can move a piece from box $$$2$$$ to box $$$3$$$ and a piece from box $$$4$$$ to box $$$5$$$. Each box will be divisible by $$$3$$$.In the third example, each box is already divisible by $$$5$$$.In the fourth example, since Charlie has no available move, he cannot help Bob make Alice happy.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "82e0859d", "template_md5": "465699a0", "result": "You are given a list of numbers representing the number of items in each box.  You can move one item from a box to its adjacent box (if it exists).  Determine the minimum number of moves needed so that all the numbers in the list are divisible by the same number greater than 1. If this is not possible, output -1."}, {"prompt_md5": "1702d5ae", "template_md5": "35d339e4", "result": "You are given an array of $n$ integers, $a_1, a_2, ..., a_n$, representing the number of chocolate pieces in each of $n$ boxes. \n\nYou can move one chocolate piece from box $i$ to either box $i-1$ or box $i+1$ in one second, if such boxes exist.\n\nDetermine the minimum number of seconds required to make the number of chocolate pieces in each box divisible by the same integer greater than 1. If it is impossible to achieve this, output -1."}]}