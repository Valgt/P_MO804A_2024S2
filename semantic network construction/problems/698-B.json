{"uid": "698-B", "url": "https://codeforces.com/contest/698/problem/B", "tags": ["constructive algorithms", " dfs and similar", " dsu", " graphs", " trees"], "title": "698-B", "statement": "B. Fix a Treetime limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputA tree is an undirected connected graph without cycles.Let's consider a rooted undirected tree withnvertices, numbered1throughn. There are many ways to represent such a tree. One way is to create an array withnintegersp1,p2, ...,pn, wherepidenotes a parent of vertexi(here, for convenience a root is considered its own parent).For this rooted tree the arraypis[2, 3, 3, 2].Given a sequencep1,p2, ...,pn, one is able to restore a tree:There must be exactly one indexrthatpr=r. A vertexris a root of the tree.For all othern- 1verticesi, there is an edge between vertexiand vertexpi.A sequencep1,p2, ...,pnis called valid if the described procedure generates some (any) rooted tree. For example, forn= 3sequences(1,2,2),(2,3,1)and(2,1,3)are notvalid.You are given a sequencea1,a2, ...,an, not necessarily valid. Your task is to change the minimum number of elements, in order to get a valid sequence. Print the minimum number of changes and an example of a valid sequence after that number of changes. If there are many valid sequences achievable in the minimum number of changes, print any of them.InputThe first line of the input contains an integern(2 ≤n≤ 200 000) — the number of vertices in the tree.The second line containsnintegersa1,a2, ...,an(1 ≤ai≤n).OutputIn the first line print the minimum number of elements to change, in order to get a valid sequence.In the second line, print any valid sequence possible to get from(a1,a2, ...,an)in the minimum number of changes. If there are many such sequences, any of them will be accepted.ExamplesInput42 3 3 4Output12 3 4 4Input53 2 2 5 3Output03 2 2 5 3Input82 3 5 4 1 6 6 7Output22 3 7 8 1 6 6 7NoteIn the first sample, it's enough to change one element. In the provided output, a sequence represents a tree rooted in a vertex4(becausep4= 4), which you can see on the left drawing below. One of other correct solutions would be a sequence2 3 3 2, representing a tree rooted in vertex3(right drawing below). On both drawings, roots are painted red.In the second sample, the given sequence is already valid.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "3ddc27a3", "template_md5": "35d339e4", "result": "You are given a sequence of $n$ integers, $a_1, a_2, ..., a_n$, where each integer represents the parent of a vertex in a tree.  \n\n* A valid sequence represents a tree where:\n    * There is exactly one root vertex (a vertex whose parent is itself).\n    * Each vertex (except the root) has an edge connecting it to its parent.\n\nYour task is to find the minimum number of changes needed to make the given sequence valid.  After making these changes, output a valid sequence that can be obtained from the original sequence with the minimum number of changes. \n\n\n\nLet me know if you'd like help with any specific part of the problem or need further clarification!"}, {"prompt_md5": "5aef2253", "template_md5": "465699a0", "result": "You are given a list of numbers representing a potentially invalid tree structure.  Your task is to change the minimum number of numbers in the list to make it represent a valid tree. Output the minimum number of changes and one possible valid list."}]}