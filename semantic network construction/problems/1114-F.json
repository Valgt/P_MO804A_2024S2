{"uid": "1114-F", "url": "https://codeforces.com/contest/1114/problem/F", "tags": ["bitmasks", " data structures", " divide and conquer", " math", " number theory"], "title": "1114-F", "statement": "F. Please, another Queries on Array?time limit per test5.5 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputYou are given an array $$$a_1, a_2, \\\\ldots, a_n$$$.You need to perform $$$q$$$ queries of the following two types:\"MULTIPLY l r x\" — for every $$$i$$$ ($$$l \\\\le i \\\\le r$$$) multiply $$$a_i$$$ by $$$x$$$.\"TOTIENT l r\" — print $$$\\\\varphi(\\\\prod \\\\limits_{i=l}^{r} a_i)$$$ taken modulo $$$10^9+7$$$, where $$$\\\\varphi$$$ denotes Euler's totient function.TheEuler's totient functionof a positive integer $$$n$$$ (denoted as $$$\\\\varphi(n)$$$) is the number of integers $$$x$$$ ($$$1 \\\\le x \\\\le n$$$) such that $$$\\\\gcd(n,x) = 1$$$.InputThe first line contains two integers $$$n$$$ and $$$q$$$ ($$$1 \\\\le n \\\\le 4 \\\\cdot 10^5$$$, $$$1 \\\\le q \\\\le 2 \\\\cdot 10^5$$$) — the number of elements in array $$$a$$$ and the number of queries.The second line contains $$$n$$$ integers $$$a_1, a_2, \\\\ldots, a_n$$$ ($$$1 \\\\le a_i \\\\le 300$$$) — the elements of array $$$a$$$.Then $$$q$$$ lines follow, describing queries in the format given in the statement.\"MULTIPLY l r x\" ($$$1 \\\\le l \\\\le r \\\\le n$$$, $$$1 \\\\le x \\\\le 300$$$) — denotes a multiplication query.\"TOTIENT l r\" ($$$1 \\\\le l \\\\le r \\\\le n$$$) — denotes a query on the value of Euler's totient function.It is guaranteed that there is at least one \"TOTIENT\" query.OutputFor each \"TOTIENT\" query, print the answer to it.ExampleInput4 45 9 1 2TOTIENT 3 3TOTIENT 3 4MULTIPLY 4 4 3TOTIENT 4 4Output112NoteIn the first example, $$$\\\\varphi(1) = 1$$$ for the first query, $$$\\\\varphi(2) = 1$$$ for the second query and $$$\\\\varphi(6) = 2$$$ for the third one.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "40f0fdc9", "template_md5": "35d339e4", "result": "You are given an array of $n$ integers $a_1, a_2, ..., a_n$. You need to perform $q$ queries of two types:\n\n1. **MULTIPLY l r x**: Multiply each element of the array from index $l$ to $r$ (inclusive) by $x$.\n2. **TOTIENT l r**: Calculate and print the Euler's totient function of the product of elements from index $l$ to $r$ (inclusive). The Euler's totient function of a number $n$, denoted as $\\varphi(n)$, is the number of integers $x$ between 1 and $n$ (inclusive) that are relatively prime to $n$ (i.e., their greatest common divisor is 1). The result should be taken modulo $10^9 + 7$.\n\n**Input:**\n\n* The first line contains two integers $n$ and $q$ ($1 \\le n \\le 4 \\cdot 10^5$, $1 \\le q \\le 2 \\cdot 10^5$) - the size of the array and the number of queries.\n* The second line contains $n$ integers $a_1, a_2, ..., a_n$ ($1 \\le a_i \\le 300$) - the elements of the array.\n* The following $q$ lines describe the queries in the format specified above.\n\n**Output:**\n\n* For each **TOTIENT** query, print the calculated value of $\\varphi( \\prod_{i=l}^{r} a_i)$ modulo $10^9 + 7$."}, {"prompt_md5": "257577fb", "template_md5": "465699a0", "result": "You are given a list of numbers. You need to perform queries of two types:\n\n1. Multiply a range of numbers in the list by a given value.\n2. Calculate the number of integers between 1 and the product of a range of numbers in the list that are relatively prime to the product. \n\nOutput the result of the second type of query."}]}