{"uid": "1244-D", "url": "https://codeforces.com/contest/1244/problem/D", "tags": ["brute force", " constructive algorithms", " dp", " graphs", " implementation", " trees"], "title": "1244-D", "statement": "D. Paint the Treetime limit per test3 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputYou are given a tree consisting of $$$n$$$ vertices. A tree is an undirected connected acyclic graph.Example of a tree.You have to paint each vertex into one of three colors. For each vertex, you know the cost of painting it in every color.You have to paint the vertices so that any path consisting of exactly three distinct vertices does not contain any vertices with equal colors. In other words, let's consider all triples $$$(x, y, z)$$$ such that $$$x \\\\neq y, y \\\\neq z, x \\\\neq z$$$, $$$x$$$ is connected by an edge with $$$y$$$, and $$$y$$$ is connected by an edge with $$$z$$$. The colours of $$$x$$$, $$$y$$$ and $$$z$$$ should be pairwise distinct. Let's call a painting which meets this conditiongood.You have to calculate the minimum cost of agoodpainting and find one of the optimal paintings. If there is nogoodpainting, report about it.InputThe first line contains one integer $$$n$$$ $$$(3 \\\\le n \\\\le 100\\\\,000)$$$ — the number of vertices.The second line contains a sequence of integers $$$c_{1, 1}, c_{1, 2}, \\\\dots, c_{1, n}$$$ $$$(1 \\\\le c_{1, i} \\\\le 10^{9})$$$, where $$$c_{1, i}$$$ is the cost of painting the $$$i$$$-th vertex into the first color.The third line contains a sequence of integers $$$c_{2, 1}, c_{2, 2}, \\\\dots, c_{2, n}$$$ $$$(1 \\\\le c_{2, i} \\\\le 10^{9})$$$, where $$$c_{2, i}$$$ is the cost of painting the $$$i$$$-th vertex into the second color.The fourth line contains a sequence of integers $$$c_{3, 1}, c_{3, 2}, \\\\dots, c_{3, n}$$$ $$$(1 \\\\le c_{3, i} \\\\le 10^{9})$$$, where $$$c_{3, i}$$$ is the cost of painting the $$$i$$$-th vertex into the third color.Then $$$(n - 1)$$$ lines follow, each containing two integers $$$u_j$$$ and $$$v_j$$$ $$$(1 \\\\le u_j, v_j \\\\le n, u_j \\\\neq v_j)$$$ — the numbers of vertices connected by the $$$j$$$-th undirected edge. It is guaranteed that these edges denote a tree.OutputIf there is nogoodpainting, print $$$-1$$$.Otherwise, print the minimum cost of agoodpainting in the first line. In the second line print $$$n$$$ integers $$$b_1, b_2, \\\\dots, b_n$$$ $$$(1 \\\\le b_i \\\\le 3)$$$, where the $$$i$$$-th integer should denote the color of the $$$i$$$-th vertex. If there are multiple good paintings with minimum cost, print any of them.ExamplesInput3 3 2 3 4 3 2 3 1 3 1 2 2 3Output6 1 3 2Input5 3 4 2 1 2 4 2 1 5 4 5 3 2 1 1 1 2 3 2 4 3 5 3Output-1Input5 3 4 2 1 2 4 2 1 5 4 5 3 2 1 1 1 2 3 2 4 3 5 4Output9 1 3 2 1 3NoteAll vertices should be painted in different colors in the first example. The optimal way to do it is to paint the first vertex into color $$$1$$$, the second vertex — into color $$$3$$$, and the third vertex — into color $$$2$$$. The cost of this painting is $$$3 + 2 + 1 = 6$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "242f8d6c", "template_md5": "465699a0", "result": "You have a tree-shaped network with multiple nodes. Each node can be painted one of three colors.  You need to find the cheapest way to paint the nodes so that no path of three nodes has the same color. If this is impossible, say so."}, {"prompt_md5": "f0414034", "template_md5": "35d339e4", "result": "You are given a tree with $n$ vertices.  Each vertex can be painted one of three colors. You are given the cost of painting each vertex with each color.\n\nYou need to paint the vertices so that no path of three distinct vertices has the same color for any two vertices.\n\nFind the minimum cost to paint the tree according to these rules. If it's impossible to paint the tree this way, output -1. \n\nIf there are multiple solutions with the minimum cost, output any one. \n\n\n\nInput:\n\n* The first line contains the number of vertices, $n$.\n* The next three lines contain the cost of painting each vertex with each of the three colors.\n* The next $n-1$ lines contain two integers each, representing an edge in the tree.\n\nOutput:\n\n* The first line contains the minimum cost.\n* The second line contains the color assigned to each vertex (1, 2, or 3)."}]}