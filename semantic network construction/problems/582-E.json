{"uid": "582-E", "url": "https://codeforces.com/contest/582/problem/E", "tags": ["bitmasks", " dp", " expression parsing"], "title": "582-E", "statement": "E. Boolean Functiontime limit per test4 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputIn this problem we consider Boolean functions of four variablesA,B,C,D. VariablesA,B,CandDare logical and can take values 0 or 1. We will define a function using the following grammar:<expression> ::= <variable> | (<expression>) <operator> (<expression>)<variable> ::= 'A' | 'B' | 'C' | 'D' | 'a' | 'b' | 'c' | 'd'<operator> ::= '&' | '|'Here large lettersA,B,C,Drepresent variables, and small letters represent their negations. For example, ifA= 1, then character'A'corresponds to value 1, and value character'a'corresponds to value 0. Here character '&' corresponds to the operation of logical AND, character '|' corresponds to the operation of logical OR.You are given expressions, defining functionf, where some operations and variables are missing. Also you know the values of the functionf(A,B,C,D)for somendistinct sets of variable values. Count the number of ways to restore the elements that are missing in the expression so that the resulting expression corresponded to the given information about functionfin the given variable sets. As the value of the result can be rather large, print its remainder modulo109+ 7.InputThe first line contains expressions(1 ≤ |s| ≤ 500), where some characters of the operators and/or variables are replaced by character '?'.The second line contains numbern(0 ≤n≤ 24) — the number of integers sets for which we know the value of functionf(A,B,C,D). Nextnlines contain the descriptions of the sets: thei-th of them contains five integersai,bi,ci,di,ei(0 ≤ai,bi,ci,di,ei≤ 1), separated by spaces and meaning thatf(ai,bi,ci,di) =ei.It is guaranteed that all the tuples (ai,bi,ci,di) are distinct.OutputIn a single line print the answer to the problem.ExamplesInput?21 0 1 0 10 1 1 0 1Output2Input(A)?(?)11 1 0 0 0Output4Input((?)&(?))|((?)&(?))0Output4096Inputb11 0 1 1 1Output1NoteIn the first sample the two valid expressions are 'C' and 'd'.In the second sample the expressions look as follows: '(A)&(a)', '(A)&(b)', '(A)&(C)', '(A)&(D)'.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "5c507d1a", "template_md5": "35d339e4", "result": "You are given a Boolean function with four variables, A, B, C, and D.  The function can use the following operations:\n\n* AND (&)\n* OR (|)\n* Negation (represented by lowercase letters, e.g., 'a' for not 'A')\n\nSome parts of the function are missing (represented by '?'). You are also given several sets of input values for A, B, C, and D, along with the corresponding output values for the function.\n\nYour task is to find the number of ways to fill in the missing parts of the function so that it produces the correct output for all the given input sets.  The answer should be the remainder when the number of valid functions is divided by 10^9 + 7. \n\n\n\nLet me know if you'd like me to elaborate on any part of this!"}, {"prompt_md5": "08d8e8a0", "template_md5": "465699a0", "result": "You are given a partially defined logical function with four inputs. You know the function's output for several different input combinations.  Find the number of ways to fill in the missing parts of the function definition so that it matches the known outputs.  The answer should be the remainder when the count is divided by 10^9 + 7."}]}