{"uid": "441-D", "url": "https://codeforces.com/contest/441/problem/D", "tags": ["constructive algorithms", " dsu", " graphs", " implementation", " math", " string suffix structures"], "title": "441-D", "statement": "D. Valera and Swapstime limit per test1 secondmemory limit per test256 megabytesinputstdinoutputstdoutApermutationpof lengthnis a sequence of distinct integersp1,p2, ...,pn(1 ≤pi≤n). A permutation is an identity permutation, if for anyithe following equation holdspi=i.Aswap(i,j)is the operation that swaps elementspiandpjin the permutation. Let's assume thatf(p)is the minimum number of swaps that you need to make the permutationpan identity permutation.Valera wonders, how he can transform permutationpinto any permutationq, such thatf(q) =m, using the minimum number of swaps. Help him do that.InputThe first line contains integern(1 ≤n≤ 3000) — the length of permutationp. The second line containsndistinct integersp1,p2, ...,pn(1 ≤pi≤n) — Valera's initial permutation. The last line contains integerm(0 ≤m<n).OutputIn the first line, print integerk— the minimum number of swaps.In the second line, print2kintegersx1,x2, ...,x2k— the description of the swap sequence. The printed numbers show that you need to consecutively make swaps(x1,x2),(x3,x4), ...,(x2k- 1,x2k).If there are multiple sequence swaps of the minimum length, print the lexicographically minimum one.ExamplesInput51 2 3 4 52Output21 2 1 3Input52 1 4 5 32Output11 2NoteSequencex1,x2, ...,xsis lexicographically smaller than sequencey1,y2, ...,ys, if there is such integerr(1 ≤r≤s), thatx1=y1,x2=y2, ...,xr- 1=yr- 1andxr<yr.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "5131877a", "template_md5": "35d339e4", "result": "You are given a permutation of length $n$ ($1 \\le n \\le 3000$). A permutation is a sequence of distinct integers from 1 to $n$.  \n\nAn identity permutation is a permutation where each element is in its original position (e.g., [1, 2, 3, 4, 5] is an identity permutation of length 5).\n\nA swap operation exchanges two elements in the permutation.\n\nThe function $f(p)$ represents the minimum number of swaps needed to transform a permutation $p$ into an identity permutation.\n\nYou are given another permutation $q$ and an integer $m$ ($0 \\le m < n$).  \n\nFind the minimum number of swaps needed to transform the given permutation into permutation $q$ such that $f(q) = m$. Output this minimum number of swaps and a sequence of swaps that achieves this transformation. If there are multiple valid sequences, output the lexicographically smallest one. \n\n\n\nLet me know if you'd like me to elaborate on any of these concepts!"}, {"prompt_md5": "23b95407", "template_md5": "465699a0", "result": "Given a list of numbers, find the fewest swaps needed to transform it into a specific target list.  Output the sequence of swaps required.  If there are multiple ways to achieve this with the same minimum number of swaps, choose the lexicographically smallest sequence."}]}