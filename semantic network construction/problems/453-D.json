{"uid": "453-D", "url": "https://codeforces.com/contest/453/problem/D", "tags": ["dp", " matrices"], "title": "453-D", "statement": "D. Little Pony and Elements of Harmonytime limit per test6 secondsmemory limit per test256 megabytesinputstdinoutputstdoutThe Elements of Harmony are six supernatural artifacts representing subjective aspects of harmony. They are arguably the most powerful force in Equestria. The inside of Elements of Harmony can be seen as a complete graph withnvertices labeled from 0 ton- 1, wherenis a power of two, equal to2m.The energy in Elements of Harmony is in constant movement. According to the ancient book, the energy of vertexuin timei(ei[u])equals to:Hereb[]is the transformation coefficient — an array ofm+ 1integers andf(u,v)is the number of ones in the binary representation of number(uxorv).Given the transformation coefficient and the energy distribution at time 0(e0[]). Help Twilight Sparkle predict the energy distribution at timet(et[]). The answer can be quite large, so output it modulop.InputThe first line contains three integersm,tandp(1 ≤m≤ 20; 0 ≤t≤ 1018; 2 ≤p≤ 109). The following line containsn(n= 2m) integerse0[i](1 ≤e0[i] ≤ 109; 0 ≤i<n). The next line containsm+ 1integersb[i](0 ≤b[i] ≤ 109; 0 ≤i≤m).OutputOutputnlines, thei-th line must contain a single integeret[i]modulop.ExamplesInput2 2 100004 1 2 30 1 0Output146614", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "ae8e64df", "template_md5": "35d339e4", "result": "You are given a complete graph with $n$ vertices labeled from 0 to $n-1$, where $n$ is a power of two ($n = 2^m$).  The energy at each vertex $u$ at time $i$ is calculated as follows:\n\n$$e_i[u] = (e_{i-1}[u] * b[k]) \\mod p$$\n\nwhere:\n\n* $e_{i-1}[u]$ is the energy at vertex $u$ at time $i-1$.\n* $b[k]$ is a transformation coefficient from an array of size $m+1$.\n* $k$ is determined by the binary representation of $(u \\oplus v)$, where $v$ is some other vertex.\n\nYou are given the initial energy distribution at time 0 ($e_0$) and the transformation coefficients ($b$).  Find the energy distribution at time $t$ ($e_t$) modulo $p$.\n\n**Input:**\n\n* Three integers $m$, $t$, and $p$ ($1 \\le m \\le 20$, $0 \\le t \\le 10^{18}$, $2 \\le p \\le 10^9$).\n* $n$ integers ($n = 2^m$) representing $e_0[i]$ ($1 \\le e_0[i] \\le 10^9$, $0 \\le i < n$).\n* $m+1$ integers representing $b[i]$ ($0 \\le b[i] \\le 10^9$, $0 \\le i \\le m$).\n\n**Output:**\n\n* $n$ integers, the $i$-th line containing $e_t[i]$ modulo $p$."}, {"prompt_md5": "e513db31", "template_md5": "465699a0", "result": "You are given a list of numbers representing the initial state of a system.  You are also given a set of transformation rules.  \n\nThe rules determine how the system changes over time.  \n\nYour task is to calculate the state of the system after a given number of time steps, modulo a given number."}]}