{"uid": "1437-F", "url": "https://codeforces.com/contest/1437/problem/F", "tags": ["combinatorics", " dp", " math", " two pointers"], "title": "1437-F", "statement": "F. Emotional Fishermentime limit per test4 secondsmemory limit per test1024 megabytesinputstandard inputoutputstandard output$$$n$$$ fishermen have just returned from a fishing vacation. The $$$i$$$-th fisherman has caught a fish of weight $$$a_i$$$.Fishermen are going to show off the fish they caught to each other. To do so, they firstly choose an order in which they show their fish (each fisherman shows his fish exactly once, so, formally, the order of showing fish is a permutation of integers from $$$1$$$ to $$$n$$$). Then they show the fish they caught according to the chosen order. When a fisherman shows his fish, he might either become happy, become sad, or stay content.Suppose a fisherman shows a fish of weight $$$x$$$, and the maximum weight of a previously shown fish is $$$y$$$ ($$$y = 0$$$ if that fisherman is the first to show his fish). Then:if $$$x \\\\ge 2y$$$, the fisherman becomes happy;if $$$2x \\\\le y$$$, the fisherman becomes sad;if none of these two conditions is met, the fisherman stays content.Let's call an order in which the fishermen show their fishemotionalif, after all fishermen show their fish according to this order, each fisherman becomes either happy or sad. Calculate the number ofemotionalorders modulo $$$998244353$$$.InputThe first line contains one integer $$$n$$$ ($$$2 \\\\le n \\\\le 5000$$$).The second line contains $$$n$$$ integers $$$a_1$$$, $$$a_2$$$, ..., $$$a_n$$$ ($$$1 \\\\le a_i \\\\le 10^9$$$).OutputPrint one integer â€” the number ofemotionalorders, taken modulo $$$998244353$$$.ExamplesInput4 1 1 4 9Output20Input4 4 3 2 1Output0Input3 4 2 1Output6Input8 42 1337 13 37 420 666 616 97Output19200", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "50625884", "template_md5": "35d339e4", "result": "There are $n$ fishermen who caught fish of weights $a_1, a_2, ..., a_n$.  They want to show their fish to each other in a specific order.  \n\nHere's how their emotions change based on the weight of their fish and the previous fish shown:\n\n* If a fisherman shows a fish of weight $x$ and the heaviest fish shown before was $y$, they become:\n    * Happy if $x \\ge 2y$\n    * Sad if $2x \\le y$\n    * Content otherwise\n\nAn \"emotional order\" is an order where every fisherman ends up either happy or sad.  \n\nFind the number of emotional orders, modulo 998244353."}, {"prompt_md5": "438cfe31", "template_md5": "465699a0", "result": "You are given a list of numbers representing the weight of fish caught by people.  People will show their fish to each other in a specific order.  A person's mood depends on the weight of their fish and the heaviest fish shown before them.  \n\nFind the number of possible orders where everyone either becomes happy or sad after seeing the fish."}]}