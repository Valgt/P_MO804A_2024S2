{"uid": "208-E", "url": "https://codeforces.com/contest/208/problem/E", "tags": ["binary search", " data structures", " dfs and similar", " trees"], "title": "208-E", "statement": "E. Blood Cousinstime limit per test2 secondsmemory limit per test256 megabytesinputstdinoutputstdoutPolycarpus got hold of a family relationship tree. The tree describes family relationships ofnpeople, numbered 1 throughn. Each person in the tree has no more than one parent.Let's call personaa 1-ancestor of personb, ifais the parent ofb.Let's call personaak-ancestor(k> 1)of personb, if personbhas a 1-ancestor, andais a(k- 1)-ancestor ofb's 1-ancestor.Family relationships don't form cycles in the found tree. In other words, there is no person who is his own ancestor, directly or indirectly (that is, who is anx-ancestor for himself, for somex,x> 0).Let's call two peoplexandy(x≠y)p-th cousins(p> 0), if there is personz, who is ap-ancestor ofxand ap-ancestor ofy.Polycarpus wonders how many counsins and what kinds of them everybody has. He took a piece of paper and wrotempairs of integersvi,pi. Help him to calculate the number ofpi-th cousins that personvihas, for each pairvi,pi.InputThe first input line contains a single integern(1 ≤n≤ 105)— the number of people in the tree. The next line containsnspace-separated integersr1,r2, ...,rn, whereri(1 ≤ri≤n)is the number of personi's parent or0, if personihas no parent. It is guaranteed that family relationships don't form cycles.The third line contains a single numberm(1 ≤m≤ 105)— the number of family relationship queries Polycarus has. Nextmlines contain pairs of space-separated integers. Thei-th line contains numbersvi,pi(1 ≤vi,pi≤n).OutputPrintmspace-separated integers — the answers to Polycarpus' queries. Print the answers to the queries in the order, in which the queries occur in the input.ExamplesInput60 1 1 0 4 471 11 22 12 24 15 16 1Output0 0 1 0 0 1 1", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "e6a4850b", "template_md5": "465699a0", "result": "Given a family tree with `n` people, determine for each person `v` and a given `p`, how many `p`th cousins person `v` has."}, {"prompt_md5": "65058649", "template_md5": "35d339e4", "result": "You are given a family tree with $n$ people numbered from 1 to $n$. Each person has at most one parent.  \n\n* **Ancestors:** Person $a$ is a $k$-ancestor of person $b$ if $a$ is the parent of $b$ and $k=1$, or if $a$ is a $(k-1)$-ancestor of $b$'s parent.\n\n* **Cousins:** Two people $x$ and $y$ ($x \\neq y$) are $p$-th cousins if there is a person $z$ who is a $p$-ancestor of both $x$ and $y$.\n\nYou are given the following information:\n\n1. A list of $n$ integers representing the parent of each person.  $r_i = 0$ means person $i$ has no parent (i.e., they are the root of the tree).\n2. A number $m$ representing the number of queries.\n3. $m$ pairs of integers $(v_i, p_i)$ representing queries. For each query, you need to find the number of $p_i$-th cousins that person $v_i$ has.\n\n**Output:** For each query, print the number of $p_i$-th cousins that person $v_i$ has."}]}