{"uid": "1981-F", "url": "https://codeforces.com/contest/1981/problem/F", "tags": ["data structures", " dp", " trees"], "title": "1981-F", "statement": "F. Turtle and Paths on a Treetime limit per test4 secondsmemory limit per test1024 megabytesinputstandard inputoutputstandard outputNote the unusual definition of $$$\\\\text{MEX}$$$ in this problem.Piggy gave Turtle abinary tree$$$^{\\\\dagger}$$$ with $$$n$$$ vertices and a sequence $$$a_1, a_2, \\\\ldots, a_n$$$ on his birthday. The binary tree is rooted at vertex $$$1$$$.If a set of paths $$$P = \\\\{(x_i, y_i)\\\\}$$$ in the tree covers each edgeexactly once, then Turtle will think that the set of paths isgood. Note that a good set of paths can cover a vertex twice or more.Turtle defines thevalueof a set of paths as $$$\\\\sum\\\\limits_{(x, y) \\\\in P} f(x, y)$$$, where $$$f(x, y)$$$ denotes the $$$\\\\text{MEX}^{\\\\ddagger}$$$ of all $$$a_u$$$ such that vertex $$$u$$$ is on the simple path from $$$x$$$ to $$$y$$$ in the tree (including the starting vertex $$$x$$$ and the ending vertex $$$y$$$).Turtle wonders theminimumvalue over all good sets of paths. Please help him calculate the answer!$$$^{\\\\dagger}$$$A binary tree is a tree where every non-leaf vertex has at most $$$2$$$ sons.$$$^{\\\\ddagger}\\\\text{MEX}$$$ of a collection of integers $$$c_1, c_2, \\\\ldots, c_k$$$ is defined as the smallestpositiveinteger $$$x$$$ which does not occur in the collection $$$c$$$. For example, $$$\\\\text{MEX}$$$ of $$$[3, 3, 1, 4]$$$ is $$$2$$$, $$$\\\\text{MEX}$$$ of $$$[2, 3]$$$ is $$$1$$$.InputEach test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \\\\le t \\\\le 10^4$$$). The description of the test cases follows.The first line of each test case contains a single integer $$$n$$$ ($$$2 \\\\le n \\\\le 2.5 \\\\cdot 10^4$$$) — the number of vertices in the tree.The second line of each test case contains $$$n$$$ integers $$$a_1, a_2, \\\\ldots, a_n$$$ ($$$1 \\\\le a_i \\\\le 10^9$$$) — the elements of the sequence $$$a$$$.The third line of each test case contains $$$n - 1$$$ integers $$$p_2, p_3, \\\\ldots, p_n$$$ ($$$1 \\\\le p_i < i$$$) — the parent of each vertex in the tree.Additional constraint on the input: the given tree is a binary tree, that is, every non-leaf vertex has at most $$$2$$$ sons.It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$10^5$$$.OutputFor each test case, output a single integer — the minimum value over all good sets of paths.ExampleInput553 2 2 1 11 1 2 253 2 1 1 11 1 2 261 2 1 2 1 31 2 3 3 472 1 2 3 1 2 11 1 2 2 3 3101 2 2 1 4 2 3 1 2 11 1 2 2 3 3 4 5 5Output4 6 6 6 7NoteIn the first test case, the tree is as follows. The number in brackets denotes the weight of the vertex:The good set of paths with the minimum value is $$$\\\\{(2, 3), (4, 5)\\\\}$$$.Note that in this test case $$$\\\\{(4, 5)\\\\}$$$ and $$$\\\\{(3, 4), (4, 5)\\\\}$$$ are not good sets of paths because each edge should be covered exactly once.In the second test case, the tree is as follows:The set of good paths with the minimum value is $$$\\\\{(1, 2), (1, 3), (4, 5)\\\\}$$$.In the third test case, the tree is as follows:The set of good paths with the minimum value is $$$\\\\{(1, 6), (3, 5)\\\\}$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "5141eb48", "template_md5": "35d339e4", "result": "You are given a binary tree with $n$ vertices and a sequence of $n$ integers $a_1, a_2, ..., a_n$.  \n\nA set of paths $P = \\{(x_i, y_i)\\}$ is considered \"good\" if it covers each edge of the tree exactly once. The value of a good set of paths is defined as the sum of the MEX values of all $a_u$ where vertex $u$ is on the simple path from $x$ to $y$ in the tree (including $x$ and $y$).\n\nThe MEX of a collection of integers $c_1, c_2, ..., c_k$ is the smallest positive integer that does not occur in the collection.\n\nFind the minimum value achievable over all good sets of paths. \n\n\nInput:\n\n* The first line contains the number of test cases $t$.\n* For each test case:\n    * The first line contains $n$, the number of vertices.\n    * The second line contains the sequence $a_1, a_2, ..., a_n$.\n    * The third line contains $n-1$ integers $p_2, p_3, ..., p_n$, where $p_i$ is the parent of vertex $i$.\n\nOutput:\n\nFor each test case, output the minimum value achievable."}, {"prompt_md5": "7d5a6491", "template_md5": "465699a0", "result": "You are given a tree with $n$ nodes and a sequence of numbers.  You need to find the minimum sum of \"MEX\" values for all possible sets of paths that cover each edge of the tree exactly once.  The MEX of a set of numbers is the smallest positive integer not present in the set."}]}