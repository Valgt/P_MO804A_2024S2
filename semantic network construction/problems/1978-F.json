{"uid": "1978-F", "url": "https://codeforces.com/contest/1978/problem/F", "tags": ["data structures", " dfs and similar", " dsu", " graphs", " number theory", " two pointers"], "title": "1978-F", "statement": "F. Large Graphtime limit per test4 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputGiven an array $$$a$$$ of length $$$n$$$. Let's construct a square matrix $$$b$$$ of size $$$n \\\\times n$$$, in which the $$$i$$$-th row contains the array $$$a$$$ cyclically shifted to the right by $$$(i - 1)$$$. For example, for the array $$$a = [3, 4, 5]$$$, the obtained matrix is$$$$$$b = \\\\begin{bmatrix} 3 & 4 & 5 \\\\\\\\ 5 & 3 & 4 \\\\\\\\ 4 & 5 & 3 \\\\end{bmatrix}$$$$$$Let's construct the following graph:The graph contains $$$n^2$$$ vertices, each of which corresponds to one of the elements of the matrix. Let's denote the vertex corresponding to the element $$$b_{i, j}$$$ as $$$(i, j)$$$.We will draw an edge between vertices $$$(i_1, j_1)$$$ and $$$(i_2, j_2)$$$ if $$$|i_1 - i_2| + |j_1 - j_2| \\\\le k$$$ and $$$\\\\gcd(b_{i_1, j_1}, b_{i_2, j_2}) > 1$$$, where $$$\\\\gcd(x, y)$$$ denotes thegreatest common divisorof integers $$$x$$$ and $$$y$$$.Your task is to calculate the number of connected components$$$^{\\\\dagger}$$$ in the obtained graph.$$$^{\\\\dagger}$$$A connected component of a graph is a set of vertices in which any vertex is reachable from any other via edges, and adding any other vertex to the set violates this rule.InputEach test consists of multiple test cases. The first line contains a single integer $$$t$$$ ($$$1 \\\\leq t \\\\leq 10^5$$$) — the number of test cases. The description of the test cases follows.The first line of each test case contains two integers $$$n$$$ and $$$k$$$ ($$$2 \\\\le n \\\\le 10^6$$$, $$$2 \\\\le k \\\\le 2 \\\\cdot 10^6$$$) — the length of the array and the parameter $$$k$$$.The second line of each test case contains $$$n$$$ integers $$$a_1, a_2, \\\\ldots, a_n$$$ ($$$1 \\\\le a_i \\\\le 10^6$$$) — the elements of the array $$$a$$$.It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$10^6$$$.OutputFor each test case, output a single integer — the number of connected components in the obtained graph.ExampleInput63 33 4 53 33 4 93 23 4 92 22 85 38 27 5 4 34 102 2 2 2Output3 2 3 1 4 1NoteIn the first test case, the matrix $$$b$$$ is given in the statement. The first connected component contains the vertices $$$(1, 1)$$$, $$$(2, 2)$$$, and $$$(3, 3)$$$. The second connected component contains the vertices $$$(1, 2)$$$, $$$(2, 3)$$$, and $$$(3, 1)$$$. The third connected component contains the vertices $$$(1, 3)$$$, $$$(2, 1)$$$, and $$$(3, 2)$$$. Thus, the graph has $$$3$$$ connected components.In the second test case, the following matrix is obtained:$$$$$$b = \\\\begin{bmatrix} 3 & 4 & 9 \\\\\\\\ 9 & 3 & 4 \\\\\\\\ 4 & 9 & 3 \\\\end{bmatrix}$$$$$$The first connected component contains all vertices corresponding to elements with values $$$3$$$ and $$$9$$$. The second connected component contains all vertices corresponding to elements with the value $$$4$$$.In the fourth test case, all vertices are in one connected component.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "e3e78364", "template_md5": "35d339e4", "result": "You are given an array of integers $a$ of length $n$.  \n\n1. Create an $n \\times n$ matrix $b$ where the $i$-th row is the array $a$ shifted to the right by $(i-1)$ positions.\n\n2. Create a graph with $n^2$ vertices, one for each element in the matrix $b$.  \n\n3. Connect two vertices $(i_1, j_1)$ and $(i_2, j_2)$ in the graph if:\n    *  $|i_1 - i_2| + |j_1 - j_2| \\le k$ \n    *  The greatest common divisor (GCD) of the elements $b_{i_1, j_1}$ and $b_{i_2, j_2}$ is greater than 1.\n\n4.  Determine the number of connected components in this graph.\n\n**Input:**\n\n*  The first line contains an integer $t$ (the number of test cases).\n*  For each test case:\n    *  The first line contains two integers $n$ and $k$.\n    *  The second line contains $n$ integers, the elements of array $a$.\n\n**Output:**\n\nFor each test case, output the number of connected components in the graph."}, {"prompt_md5": "07ffa5e5", "template_md5": "465699a0", "result": "You are given a list of numbers. Create a square matrix where each row is the list shifted to the right by a certain amount.  \n\nBuild a graph where each number in the matrix is a point. Connect two points if the distance between them is less than or equal to a given value and the greatest common divisor of the two numbers is greater than 1. Count the number of groups of connected points."}]}