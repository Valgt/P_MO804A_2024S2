{"uid": "1139-D", "url": "https://codeforces.com/contest/1139/problem/D", "tags": ["dp", " math", " number theory", " probabilities"], "title": "1139-D", "statement": "D. Steps to Onetime limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputVivek initially has an empty array $$$a$$$ and some integer constant $$$m$$$.He performs the following algorithm:Select a random integer $$$x$$$ uniformly in range from $$$1$$$ to $$$m$$$ and append it to the end of $$$a$$$.Compute the greatest common divisor of integers in $$$a$$$.In case it equals to $$$1$$$, breakOtherwise, return to step $$$1$$$.Find the expected length of $$$a$$$. It can be shown that it can be represented as $$$\\\\frac{P}{Q}$$$ where $$$P$$$ and $$$Q$$$ are coprime integers and $$$Q\\\\neq 0 \\\\pmod{10^9+7}$$$. Print the value of $$$P \\\\cdot Q^{-1} \\\\pmod{10^9+7}$$$.InputThe first and only line contains a single integer $$$m$$$ ($$$1 \\\\leq m \\\\leq 100000$$$).OutputPrint a single integer — the expected length of the array $$$a$$$ written as $$$P \\\\cdot Q^{-1} \\\\pmod{10^9+7}$$$.ExamplesInput1Output1Input2Output2Input4Output333333338NoteIn the first example, since Vivek can choose only integers from $$$1$$$ to $$$1$$$, he will have $$$a=[1]$$$ after the first append operation, and after that quit the algorithm. Hence the length of $$$a$$$ is always $$$1$$$, so its expected value is $$$1$$$ as well.In the second example, Vivek each time will append either $$$1$$$ or $$$2$$$, so after finishing the algorithm he will end up having some number of $$$2$$$'s (possibly zero), and a single $$$1$$$ in the end. The expected length of the list is $$$1\\\\cdot \\\\frac{1}{2} + 2\\\\cdot \\\\frac{1}{2^2} + 3\\\\cdot \\\\frac{1}{2^3} + \\\\ldots = 2$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "cef4eb5f", "template_md5": "35d339e4", "result": "You are given an integer $m$.  An algorithm is performed as follows:\n\n1. Choose a random integer $x$ between 1 and $m$ (inclusive).\n2. Append $x$ to the end of an initially empty array.\n3. Calculate the greatest common divisor (GCD) of all the integers in the array.\n4. If the GCD is 1, stop.\n5. Otherwise, go back to step 1.\n\nFind the expected length of the array after the algorithm terminates.  The answer can be expressed as a fraction $\\frac{P}{Q}$ where $P$ and $Q$ are coprime integers and $Q \\neq 0 \\pmod{10^9 + 7}$. Output the value of $P \\cdot Q^{-1} \\pmod{10^9 + 7}$."}, {"prompt_md5": "55b28aa5", "template_md5": "465699a0", "result": "You are given a number *m*.  A program repeatedly picks a random number between 1 and *m* and adds it to a list. If the greatest common divisor of all the numbers in the list is 1, the program stops. Otherwise, it continues. What is the average length of the list when the program stops?"}]}