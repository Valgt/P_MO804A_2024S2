{"uid": "1677-D", "url": "https://codeforces.com/contest/1677/problem/D", "tags": ["dp", " math"], "title": "1677-D", "statement": "D. Tokitsukaze and Permutationstime limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputTokitsukaze has a permutation $$$p$$$. She performed the following operation to $$$p$$$exactly$$$k$$$ times: in one operation, for each $$$i$$$ from $$$1$$$ to $$$n - 1$$$ in order, if $$$p_i$$$ > $$$p_{i+1}$$$, swap $$$p_i$$$, $$$p_{i+1}$$$. After exactly $$$k$$$ times of operations, Tokitsukaze got a new sequence $$$a$$$, obviously the sequence $$$a$$$ is also a permutation.After that, Tokitsukaze wrote down the value sequence $$$v$$$ of $$$a$$$ on paper. Denote the value sequence $$$v$$$ of the permutation $$$a$$$ of length $$$n$$$ as $$$v_i=\\\\sum_{j=1}^{i-1}[a_i < a_j]$$$, where the value of $$$[a_i < a_j]$$$ define as if $$$a_i < a_j$$$, the value is $$$1$$$, otherwise is $$$0$$$ (in other words, $$$v_i$$$ is equal to the number of elements greater than $$$a_i$$$ that are to the left of position $$$i$$$). Then Tokitsukaze went out to work.There are three naughty cats in Tokitsukaze's house. When she came home, she found the paper with the value sequence $$$v$$$ to be bitten out by the cats, leaving several holes, so that the value of some positions could not be seen clearly. She forgot what the original permutation $$$p$$$ was. She wants to know how many different permutations $$$p$$$ there are, so that the value sequence $$$v$$$ of the new permutation $$$a$$$ afterexactly$$$k$$$ operations is the same as the $$$v$$$ written on the paper (not taking into account the unclear positions).Since the answer may be too large, print it modulo $$$998\\\\,244\\\\,353$$$.InputThe first line contains a single integer $$$t$$$ ($$$1 \\\\leq t \\\\leq 1000$$$) — the number of test cases. Each test case consists of two lines.The first line contains two integers $$$n$$$ and $$$k$$$ ($$$1 \\\\leq n \\\\leq 10^6$$$; $$$0 \\\\leq k \\\\leq n-1$$$) — the length of the permutation and the exactly number of operations.The second line contains $$$n$$$ integers $$$v_1, v_2, \\\\dots, v_n$$$ ($$$-1 \\\\leq v_i \\\\leq i-1$$$) — the value sequence $$$v$$$. $$$v_i = -1$$$ means the $$$i$$$-th position of $$$v$$$ can't be seen clearly.It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$10^6$$$.OutputFor each test case, print a single integer — the number of different permutations modulo $$$998\\\\,244\\\\,353$$$.ExampleInput35 00 1 2 3 45 2-1 1 2 0 05 20 1 1 0 0Output1 6 6NoteIn the first test case, only permutation $$$p=[5,4,3,2,1]$$$ satisfies the constraint condition.In the second test case, there are $$$6$$$ permutations satisfying the constraint condition, which are:$$$[3,4,5,2,1]$$$ $$$\\\\rightarrow$$$ $$$[3,4,2,1,5]$$$ $$$\\\\rightarrow$$$ $$$[3,2,1,4,5]$$$$$$[3,5,4,2,1]$$$ $$$\\\\rightarrow$$$ $$$[3,4,2,1,5]$$$ $$$\\\\rightarrow$$$ $$$[3,2,1,4,5]$$$$$$[4,3,5,2,1]$$$ $$$\\\\rightarrow$$$ $$$[3,4,2,1,5]$$$ $$$\\\\rightarrow$$$ $$$[3,2,1,4,5]$$$$$$[4,5,3,2,1]$$$ $$$\\\\rightarrow$$$ $$$[4,3,2,1,5]$$$ $$$\\\\rightarrow$$$ $$$[3,2,1,4,5]$$$$$$[5,3,4,2,1]$$$ $$$\\\\rightarrow$$$ $$$[3,4,2,1,5]$$$ $$$\\\\rightarrow$$$ $$$[3,2,1,4,5]$$$$$$[5,4,3,2,1]$$$ $$$\\\\rightarrow$$$ $$$[4,3,2,1,5]$$$ $$$\\\\rightarrow$$$ $$$[3,2,1,4,5]$$$So after exactly $$$2$$$ times of swap they will all become $$$a=[3,2,1,4,5]$$$, whose value sequence is $$$v=[0,1,2,0,0]$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "6c62768f", "template_md5": "465699a0", "result": "You are given a sequence of numbers. This sequence represents the result of a series of swaps on a hidden original sequence.  You need to find how many different original sequences could have produced this result."}, {"prompt_md5": "7fd0af66", "template_md5": "35d339e4", "result": "You are given a sequence $v$ of length $n$. This sequence represents the value sequence of a permutation $a$ after a specific number of operations. \n\nThe operations are as follows:\n\n1. Iterate through the permutation $a$ from index 1 to $n-1$.\n2. If $a_i > a_{i+1}$, swap $a_i$ and $a_{i+1}$.\n\nYou perform this operation exactly $k$ times.\n\nThe value sequence $v_i$ is defined as the number of elements in $a$ that are greater than $a_i$ and are to the left of position $i$.\n\nYou need to find the number of different permutations $p$ that could have resulted in the given value sequence $v$ after $k$ operations.\n\n**Input:**\n\n* $t$ - the number of test cases\n* For each test case:\n    * $n$ - the length of the permutation\n    * $k$ - the number of operations\n    * $v_1, v_2, ..., v_n$ - the value sequence\n\n**Output:**\n\nFor each test case, print the number of possible permutations modulo $998244353$."}]}