{"uid": "1832-D2", "url": "https://codeforces.com/contest/1832/problem/D2", "tags": ["binary search", " constructive algorithms", " greedy", " implementation", " math"], "title": "1832-D2", "statement": "D2. Red-Blue Operations (Hard Version)time limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputThe only difference between easy and hard versions is the maximum values of $$$n$$$ and $$$q$$$.You are given an array, consisting of $$$n$$$ integers. Initially, all elements are red.You can apply the following operation to the array multiple times. During the $$$i$$$-th operation, you select an element of the array; then:if the element is red, it increases by $$$i$$$ and becomes blue;if the element is blue, it decreases by $$$i$$$ and becomes red.The operations are numbered from $$$1$$$, i. e. during the first operation some element is changed by $$$1$$$ and so on.You are asked $$$q$$$ queries of the following form:given an integer $$$k$$$, what can the largest minimum in the array be if you applyexactly$$$k$$$ operations to it?Note that the operations don't affect the array between queries, all queries are asked on the initial array $$$a$$$.InputThe first line contains two integers $$$n$$$ and $$$q$$$ ($$$1 \\\\le n, q \\\\le 2 \\\\cdot 10^5$$$) — the number of elements in the array and the number of queries.The second line contains $$$n$$$ integers $$$a_1, a_2, \\\\dots, a_n$$$ ($$$1 \\\\le a_i \\\\le 10^9$$$).The third line contains $$$q$$$ integers $$$k_1, k_2, \\\\dots, k_q$$$ ($$$1 \\\\le k_j \\\\le 10^9$$$).OutputFor each query, print a single integer — the largest minimum that the array can have after you applyexactly$$$k$$$ operations to it.ExamplesInput4 10 5 2 8 4 1 2 3 4 5 6 7 8 9 10Output3 4 5 6 7 8 8 10 8 12Input5 10 5 2 8 4 4 1 2 3 4 5 6 7 8 9 10Output3 4 5 6 7 8 9 8 11 8Input2 5 2 3 10 6 8 1 3Output10 7 8 3 3", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "09ea901d", "template_md5": "35d339e4", "result": "You are given an array of $n$ integers. Each integer is initially red. You can perform the following operation on the array:\n\n* **Select an integer in the array.**\n* **If the integer is red:** Increase it by the current operation number and change its color to blue.\n* **If the integer is blue:** Decrease it by the current operation number and change its color to red.\n\nYou are asked $q$ queries. Each query has an integer $k$. For each query, determine the largest possible minimum value in the array after performing exactly $k$ operations. \n\n**Input:**\n\n* The first line contains two integers $n$ and $q$ ($1 \\le n, q \\le 2 \\cdot 10^5$) - the number of integers in the array and the number of queries.\n* The second line contains $n$ integers $a_1, a_2, ..., a_n$ ($1 \\le a_i \\le 10^9$) - the initial values of the array.\n* The third line contains $q$ integers $k_1, k_2, ..., k_q$ ($1 \\le k_j \\le 10^9$) - the values for each query.\n\n**Output:**\n\n* For each query, print a single integer - the largest possible minimum value in the array after performing exactly $k$ operations."}, {"prompt_md5": "808d7e71", "template_md5": "465699a0", "result": "You have a list of numbers. You can repeatedly change each number by adding or subtracting a value based on the operation number.  You are asked multiple times to find the largest possible smallest number in the list after a specific number of operations."}]}