{"uid": "986-E", "url": "https://codeforces.com/contest/986/problem/E", "tags": ["brute force", " data structures", " math", " number theory", " trees"], "title": "986-E", "statement": "E. Prince's Problemtime limit per test3 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputLet the main characters of this problem be personages from some recent movie. New Avengers seem to make a lot of buzz. I didn't watch any part of the franchise and don't know its heroes well, but it won't stop me from using them in this problem statement. So, Thanos and Dr. Strange are doing their superhero and supervillain stuff, but then suddenly they stumble across a regular competitive programming problem.You are given a tree with $$$n$$$ vertices.In each vertex $$$v$$$ there is positive integer $$$a_{v}$$$.You have to answer $$$q$$$ queries.Each query has a from $$$u$$$ $$$v$$$ $$$x$$$.You have to calculate $$$\\\\prod_{w \\\\in P} gcd(x, a_{w}) \\\\mod (10^{9} + 7)$$$, where $$$P$$$ is a set of vertices on path from $$$u$$$ to $$$v$$$. In other words, you are to calculate the product of $$$gcd(x, a_{w})$$$ for all vertices $$$w$$$ on the path from $$$u$$$ to $$$v$$$. As it might be large, compute it modulo $$$10^9+7$$$. Here $$$gcd(s, t)$$$ denotes the greatest common divisor of $$$s$$$ and $$$t$$$.Note that the numbers in verticesdo notchange after queries.I suppose that you are more interested in superhero business of Thanos and Dr. Strange than in them solving the problem. So you are invited to solve this problem instead of them.InputIn the first line of input there is one integer $$$n$$$ ($$$1 \\\\le n \\\\le 10^{5}$$$) — the size of the tree.In the next $$$n-1$$$ lines the edges of the tree are described. The $$$i$$$-th edge is described with two integers $$$u_{i}$$$ and $$$v_{i}$$$ ($$$1 \\\\le u_{i}, v_{i} \\\\le n$$$) and it connects the vertices $$$u_{i}$$$ and $$$v_{i}$$$. It is guaranteed that graph with these edges is a tree.In the next line there are $$$n$$$ integers $$$a_1, a_2, \\\\ldots, a_n$$$ ($$$1 \\\\le a_{v} \\\\le 10^{7}$$$).In the next line there is one integer $$$q$$$ ($$$1 \\\\le q \\\\le 10^{5}$$$) — the number of queries.And in the next $$$q$$$ lines the queries are described. Each query is described with three integers $$$u_{i}$$$, $$$v_{i}$$$ and $$$x_{i}$$$ ($$$1 \\\\le u_{i}, v_{i} \\\\le n$$$, $$$1 \\\\le x_{i} \\\\le 10^{7}$$$).OutputPrint $$$q$$$ numbers — the answers to the queries in the order they are given in the input. Print each answer modulo $$$10^9+7 = 1000000007$$$. Print each number on a separate line.ExamplesInput41 21 31 46 4 9 532 3 62 3 23 4 7Output3641Input61 22 32 41 55 6100000 200000 500000 40000 800000 25000033 5 100000006 2 35000004 1 64000Output19600012250999998215", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "d0da3843", "template_md5": "35d339e4", "result": "You are given a tree with $n$ vertices. Each vertex has a positive integer value $a_v$. \n\nYou need to answer $q$ queries. Each query consists of three integers $u$, $v$, and $x$. For each query, you need to calculate the product of the greatest common divisors (GCD) of $x$ and the values of all vertices on the path from $u$ to $v$.  \n\nThe GCD of two numbers is the largest number that divides both of them evenly.  \n\nThe product should be calculated modulo $10^9 + 7$.\n\n**Input:**\n\n* The first line contains an integer $n$ (the number of vertices).\n* The next $n-1$ lines describe the edges of the tree with two integers $u_i$ and $v_i$ (the vertices connected by the edge).\n* The next line contains $n$ integers $a_1, a_2, ..., a_n$ (the values of each vertex).\n* The next line contains an integer $q$ (the number of queries).\n* The next $q$ lines describe the queries, each with three integers $u_i$, $v_i$, and $x_i$.\n\n**Output:**\n\nPrint $q$ numbers, each representing the answer to a query, modulo $10^9 + 7$. Each answer should be printed on a separate line."}, {"prompt_md5": "d9323214", "template_md5": "465699a0", "result": "You are given a tree with numbered nodes, each node having a value. You need to answer multiple queries. Each query consists of three numbers: a starting node, an ending node, and a target value. For each query, calculate the product of the greatest common divisor of the target value and the value of each node on the path from the starting node to the ending node. The result should be taken modulo 10^9 + 7."}]}