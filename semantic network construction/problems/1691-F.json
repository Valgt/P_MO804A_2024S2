{"uid": "1691-F", "url": "https://codeforces.com/contest/1691/problem/F", "tags": ["combinatorics", " dfs and similar", " dp", " math", " trees"], "title": "1691-F", "statement": "F. K-Set Treetime limit per test3 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputYou are given a tree $$$G$$$ with $$$n$$$ vertices and an integer $$$k$$$. The vertices of the tree are numbered from $$$1$$$ to $$$n$$$.For a vertex $$$r$$$ and a subset $$$S$$$ of vertices of $$$G$$$, such that $$$|S| = k$$$, we define $$$f(r, S)$$$ as the size of the smallest rooted subtree containing all vertices in $$$S$$$ when the tree is rooted at $$$r$$$. A set of vertices $$$T$$$ is called a rooted subtree, if all the vertices in $$$T$$$ are connected, and for each vertex in $$$T$$$, all its descendants belong to $$$T$$$.You need to calculate the sum of $$$f(r, S)$$$ overall possible distinct combinationsof vertices $$$r$$$ and subsets $$$S$$$, where $$$|S| = k$$$. Formally, compute the following: $$$$$$\\\\sum_{r \\\\in V} \\\\sum_{S \\\\subseteq V, |S| = k} f(r, S),$$$$$$ where $$$V$$$ is the set of vertices in $$$G$$$.Output the answer modulo $$$10^9 + 7$$$.InputThe first line contains two integers $$$n$$$ and $$$k$$$ ($$$3 \\\\le n \\\\le 2 \\\\cdot 10^5$$$, $$$1 \\\\le k \\\\le n$$$).Each of the following $$$n - 1$$$ lines contains two integers $$$x$$$ and $$$y$$$ ($$$1 \\\\le x, y \\\\le n$$$), denoting an edge between vertex $$$x$$$ and $$$y$$$.It is guaranteed that the given edges form a tree.OutputPrint the answer modulo $$$10^9 + 7$$$.ExamplesInput3 2 1 2 1 3Output25Input7 2 1 2 2 3 2 4 1 5 4 6 4 7Output849NoteThe tree in the second example is given below:We have $$$21$$$ subsets of size $$$2$$$ in the given tree. Hence, $$$$$$S \\\\in \\\\left\\\\{\\\\{1, 2\\\\}, \\\\{1, 3\\\\}, \\\\{1, 4\\\\}, \\\\{1, 5\\\\}, \\\\{1, 6\\\\}, \\\\{1, 7\\\\}, \\\\{2, 3\\\\}, \\\\{2, 4\\\\}, \\\\{2, 5\\\\}, \\\\{2, 6\\\\}, \\\\{2, 7\\\\}, \\\\{3, 4\\\\}, \\\\{3, 5\\\\}, \\\\{3, 6\\\\}, \\\\{3, 7\\\\}, \\\\{4, 5\\\\}, \\\\{4, 6\\\\}, \\\\{4, 7\\\\}, \\\\{5, 6\\\\}, \\\\{5, 7\\\\}, \\\\{6, 7\\\\} \\\\right\\\\}.$$$$$$ And since we have $$$7$$$ vertices, $$$1 \\\\le r \\\\le 7$$$. We need to find the sum of $$$f(r, S)$$$ over all possible pairs of $$$r$$$ and $$$S$$$.Below we have listed the value of $$$f(r, S)$$$ for some combinations of $$$r$$$ and $$$S$$$.$$$r = 1$$$, $$$S = \\\\{3, 7\\\\}$$$. The value of $$$f(r, S)$$$ is $$$5$$$ and the corresponding subtree is $$$\\\\{2, 3, 4, 6, 7\\\\}$$$.$$$r = 1$$$, $$$S = \\\\{5, 4\\\\}$$$. The value of $$$f(r, S)$$$ is $$$7$$$ and the corresponding subtree is $$$\\\\{1, 2, 3, 4, 5, 6, 7\\\\}$$$.$$$r = 1$$$, $$$S = \\\\{4, 6\\\\}$$$. The value of $$$f(r, S)$$$ is $$$3$$$ and the corresponding subtree is $$$\\\\{4, 6, 7\\\\}$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "08d7fc2f", "template_md5": "35d339e4", "result": "You are given a tree with $n$ vertices.  Each vertex is numbered from 1 to $n$.  You are also given an integer $k$.\n\nFor each vertex $r$ and each subset $S$ of vertices in the tree with $|S| = k$, find the size of the smallest subtree rooted at $r$ that contains all the vertices in $S$.\n\nCalculate the sum of these subtree sizes for all possible pairs of $r$ and $S$. Output the sum modulo $10^9 + 7$."}, {"prompt_md5": "c4ad01ea", "template_md5": "465699a0", "result": "You are given a tree with  'n' nodes.  You need to find the sum of the sizes of the smallest subtrees that contain 'k' specific nodes, for all possible combinations of a node and a set of 'k' nodes.  The answer should be given modulo 10^9 + 7."}]}