{"uid": "1611-E2", "url": "https://codeforces.com/contest/1611/problem/E2", "tags": ["dfs and similar", " dp", " greedy", " shortest paths", " trees"], "title": "1611-E2", "statement": "E2. Escape The Maze (hard version)time limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputThe only difference with E1 is the question of the problem.Vlad built a maze out of $$$n$$$ rooms and $$$n-1$$$ bidirectional corridors. From any room $$$u$$$ any other room $$$v$$$ can be reached through a sequence of corridors. Thus, the room system forms an undirected tree.Vlad invited $$$k$$$ friends to play a game with them.Vlad starts the game in the room $$$1$$$ and wins if he reaches a room other than $$$1$$$, into which exactly one corridor leads. Friends are placed in the maze: the friend with number $$$i$$$ is in the room $$$x_i$$$, and no two friends are in the same room (that is, $$$x_i \\\\neq x_j$$$ for all $$$i \\\\neq j$$$). Friends win if one of them meets Vlad in any room or corridor before he wins.For one unit of time, each participant of the game can go through one corridor. All participants move at the same time. Participants may not move. Each room can fit all participants at the same time.Friends know the plan of a maze and intend to win. They don't want to waste too much energy. They ask you to determine if they can win and if they can, whatminimumnumber of friends must remain in the maze so that they can always catch Vlad.In other words, you need to determine the size of the minimum (by the number of elements) subset of friends who can catch Vlad or say that such a subset does not exist.InputThe first line of the input contains an integer $$$t$$$ ($$$1 \\\\le t \\\\le 10^4$$$) — the number of test cases in the input. The input contains an empty string before each test case.The first line of the test case contains two numbers $$$n$$$ and $$$k$$$ ($$$1 \\\\le k < n \\\\le 2\\\\cdot 10^5$$$) — the number of rooms and friends, respectively.The next line of the test case contains $$$k$$$ integers $$$x_1, x_2, \\\\dots, x_k$$$ ($$$2 \\\\le x_i \\\\le n$$$) — numbers of rooms with friends. All $$$x_i$$$ are different.The next $$$n-1$$$ lines contain descriptions of the corridors, two numbers per line $$$v_j$$$ and $$$u_j$$$ ($$$1 \\\\le u_j, v_j \\\\le n$$$) — numbers of rooms that connect the $$$j$$$ corridor. All corridors are bidirectional. From any room, you can go to any other by moving along the corridors.It is guaranteed that the sum of the values $$$n$$$ over all test cases in the test is not greater than $$$2\\\\cdot10^5$$$.OutputPrint $$$t$$$ lines, each line containing the answer to the corresponding test case. The answer to a test case should be $$$-1$$$ if Vlad wins anyway and a minimal number of friends otherwise.ExampleInput4  8 2 5 3 4 7 2 5 1 6 3 6 7 2 1 7 6 8  8 4 6 5 7 3 4 7 2 5 1 6 3 6 7 2 1 7 6 8  3 1 2 1 2 2 3  3 2 2 3 3 1 1 2Output-1 2 1 2NoteIn the first set of inputs, even if all the friends stay in the maze, Vlad can still win. Therefore, the answer is \"-1\".In the second set of inputs it is enough to leave friends from rooms $$$6$$$ and $$$7$$$. Then Vlad will not be able to win. The answer is \"2\".In the third and fourth sets of inputs Vlad cannot win only if all his friends stay in the maze. Therefore the answers are \"1\" and \"2\".", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "a0e3c6cb", "template_md5": "35d339e4", "result": "There is a tree with $n$ rooms and $n-1$ bidirectional corridors.  Each room can hold all the people.\n\nThere are $k$ people, each starting in a different room.  \n\nOne person starts in room 1 and wants to reach any room with only one corridor leading out.\n\nPeople can move one room at a time, simultaneously.\n\n* **Question 1:** Can the people stop the person in room 1 from winning?\n\n* **Question 2:** If yes, what is the minimum number of people needed to guarantee they can stop the person in room 1 from winning? \n\n\n\nInput:\n\n* $t$: the number of test cases\n* For each test case:\n    * $n$: the number of rooms\n    * $k$: the number of people\n    * $x_1, x_2, ..., x_k$: the rooms where each person starts\n    * $n-1$ lines, each with two numbers $v_j$ and $u_j$: representing a corridor between rooms $v_j$ and $u_j$.\n\nOutput:\n\n* For each test case, print:\n    * $-1$ if the person in room 1 can always win\n    * The minimum number of people needed to stop the person in room 1 from winning if they can."}, {"prompt_md5": "5ca0f49f", "template_md5": "465699a0", "result": "There is a tree with rooms connected by paths.  A person starts in one room and wants to reach a room with only one path leading out.  Other people are in different rooms.  The people can move one room at a time, simultaneously.  Determine the minimum number of people needed to guarantee that at least one person will meet the first person before they reach the target room, or if it's impossible."}]}