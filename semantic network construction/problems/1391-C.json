{"uid": "1391-C", "url": "https://codeforces.com/contest/1391/problem/C", "tags": ["combinatorics", " dp", " graphs", " math"], "title": "1391-C", "statement": "C. Cyclic Permutationstime limit per test1 secondmemory limit per test256 megabytesinputstandard inputoutputstandard outputA permutation of length $$$n$$$ is an array consisting of $$$n$$$ distinct integers from $$$1$$$ to $$$n$$$ in arbitrary order. For example, $$$[2,3,1,5,4]$$$ is a permutation, but $$$[1,2,2]$$$ is not a permutation ($$$2$$$ appears twice in the array) and $$$[1,3,4]$$$ is also not a permutation ($$$n=3$$$ but there is $$$4$$$ in the array).Consider a permutation $$$p$$$ of length $$$n$$$, we build a graph of size $$$n$$$ using it as follows:For every $$$1 \\\\leq i \\\\leq n$$$, find thelargest$$$j$$$ such that $$$1 \\\\leq j < i$$$ and $$$p_j > p_i$$$, and add an undirected edge between node $$$i$$$ and node $$$j$$$For every $$$1 \\\\leq i \\\\leq n$$$, find thesmallest$$$j$$$ such that $$$i < j \\\\leq n$$$ and $$$p_j > p_i$$$, and add an undirected edge between node $$$i$$$ and node $$$j$$$In cases where no such $$$j$$$ exists, we make no edges. Also, note that we make edges between the corresponding indices, not the values at those indices.For clarity, consider as an example $$$n = 4$$$, and $$$p = [3,1,4,2]$$$; here, the edges of the graph are $$$(1,3),(2,1),(2,3),(4,3)$$$.A permutation $$$p$$$ iscyclicif the graph built using $$$p$$$ has at least one simple cycle.Given $$$n$$$, find the number of cyclic permutations of length $$$n$$$. Since the number may be very large, output it modulo $$$10^9+7$$$.Please refer to the Notes section for the formal definition of a simple cycleInputThe first and only line contains a single integer $$$n$$$ ($$$3 \\\\le n \\\\le 10^6$$$).OutputOutput a single integer $$$0 \\\\leq x < 10^9+7$$$, the number of cyclic permutations of length $$$n$$$ modulo $$$10^9+7$$$.ExamplesInput4Output16Input583291Output135712853NoteThere are $$$16$$$ cyclic permutations for $$$n = 4$$$. $$$[4,2,1,3]$$$ is one such permutation, having a cycle of length four: $$$4 \\\\rightarrow 3 \\\\rightarrow 2 \\\\rightarrow 1 \\\\rightarrow 4$$$.Nodes $$$v_1$$$, $$$v_2$$$, $$$\\\\ldots$$$, $$$v_k$$$ form a simple cycle if the following conditions hold:$$$k \\\\geq 3$$$.$$$v_i \\\\neq v_j$$$ for any pair of indices $$$i$$$ and $$$j$$$. ($$$1 \\\\leq i < j \\\\leq k$$$)$$$v_i$$$ and $$$v_{i+1}$$$ share an edge for all $$$i$$$ ($$$1 \\\\leq i < k$$$), and $$$v_1$$$ and $$$v_k$$$ share an edge.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "31cddbf9", "template_md5": "35d339e4", "result": "You are given an integer $n$.  A permutation of length $n$ is an array of $n$ distinct integers from 1 to $n$.\n\nFor a permutation $p$ of length $n$, we build a graph with $n$ nodes.  For each $i$ from 1 to $n$:\n\n* Find the largest $j$ such that $1 \\le j < i$ and $p_j > p_i$. Add an edge between node $i$ and node $j$.\n* Find the smallest $j$ such that $i < j \\le n$ and $p_j > p_i$. Add an edge between node $i$ and node $j$.\n\nA permutation is *cyclic* if the graph built using it has at least one cycle.\n\nFind the number of cyclic permutations of length $n$.  Since the number may be very large, output it modulo $10^9 + 7$."}, {"prompt_md5": "d8f85fc9", "template_md5": "465699a0", "result": "You are given a number *n*.  Find the number of ways to arrange *n* distinct objects in a circle such that there is at least one closed loop in the arrangement.  The number of arrangements can be very large, so output it modulo 10^9+7."}]}