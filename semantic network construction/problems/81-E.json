{"uid": "81-E", "url": "https://codeforces.com/contest/81/problem/E", "tags": ["dfs and similar", " dp", " dsu", " graphs", " implementation", " trees"], "title": "81-E", "statement": "E. Pairstime limit per test1 secondmemory limit per test256 megabytesinputstdinoutputstdoutThere arenstudents in Polycarp's class (including himself). A few days ago all students wrote an essay \"My best friend\". Each student's essay was dedicated to one of the students of class, to his/her best friend. Note that studentb's best friend is not necessarily studenta, ifa's best friend isb.And now the teacher leads the whole class to the museum of the history of sports programming. Exciting stories of legendary heroes await the students: tourist, Petr, tomek, SnapDragon — that's who they will hear about!The teacher decided to divide students into pairs so that each pair consisted of a student and his best friend. She may not be able to split all the students into pairs, it's not a problem — she wants to pick out the maximum number of such pairs. If there is more than one variant of doing so, she wants to pick out the pairs so that there were as much boy-girl pairs as possible. Of course, each student must not be included in more than one pair.InputThe first line contains an integern(2 ≤n≤ 105),nis the number of students per class. Next,nlines contain information about the students, one per line. Each line contains two integersfi,si(1 ≤fi≤n,fi≠i, 1 ≤si≤ 2), wherefiis the number ofi-th student's best friend andsidenotes thei-th pupil's sex (si= 1for a boy andsi= 2for a girl).OutputPrint on the first line two numberst,e, wheretis the maximum number of formed pairs, andeis the maximum number of boy-girl type pairs among them. Then printtlines, each line must contain a pairai,bi(1 ≤ai,bi≤n), they are numbers of pupils in thei-th pair. Print the pairs in any order. Print the numbers in pairs in any order. If there are several solutions, output any of them.ExamplesInput55 23 25 12 14 2Output2 25 34 2Input65 23 25 12 14 23 1Output3 14 25 13 6Input82 23 25 13 16 15 18 27 1Output4 15 63 42 17 8NoteThe picture corresponds to the first sample. On the picture rhomb stand for boys, squares stand for girls, arrows lead from a pupil to his/her best friend. Bold non-dashed arrows stand for pairs in the answer.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "63b489db", "template_md5": "35d339e4", "result": "There are $n$ students in a class ($2 \\le n \\le 10^5$). Each student has a best friend who is also in the class.  The input describes each student and their best friend.  \n\n* The $i$-th line of input contains two integers:\n    * $f_i$: the number of the $i$-th student's best friend.\n    * $s_i$: the gender of the $i$-th student (1 for boy, 2 for girl).\n\nThe teacher wants to form as many pairs as possible, where each pair consists of a student and their best friend.  If there are multiple ways to form pairs, the teacher prefers to form as many boy-girl pairs as possible.\n\nOutput:\n\n* The first line should contain two integers:\n    * $t$: the maximum number of pairs that can be formed.\n    * $e$: the maximum number of boy-girl pairs.\n* The next $t$ lines should each contain two integers, representing a pair of students."}, {"prompt_md5": "bc08861c", "template_md5": "465699a0", "result": "You are given a list of people and who each person considers their best friend.  Find the maximum number of pairs you can make where each pair consists of a person and their best friend.  If there are multiple solutions, choose the one with the most boy-girl pairs."}]}