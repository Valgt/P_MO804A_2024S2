{"uid": "1495-D", "url": "https://codeforces.com/contest/1495/problem/D", "tags": ["combinatorics", " dfs and similar", " graphs", " math", " shortest paths", " trees"], "title": "1495-D", "statement": "D. BFS Treestime limit per test2.5 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputWe define a spanning tree of a graph to be a BFS treerooted atvertex $$$s$$$ if and only if for every node $$$t$$$ the shortest distance between $$$s$$$ and $$$t$$$ in the graph is equal to the shortest distance between $$$s$$$ and $$$t$$$ in the spanning tree.Given a graph, we define $$$f(x,y)$$$ to be the number of spanning trees of that graph that are BFS trees rooted at vertices $$$x$$$ and $$$y$$$ at the same time.You are given an undirected connected graph with $$$n$$$ vertices and $$$m$$$ edges. Calculate $$$f(i,j)$$$ for all $$$i$$$, $$$j$$$ by modulo $$$998\\\\,244\\\\,353$$$.InputThe first line contains two integers $$$n$$$, $$$m$$$ ($$$1 \\\\le n \\\\le 400$$$, $$$0 \\\\le m \\\\le 600$$$) — the number of vertices and the number of edges in the graph.The $$$i$$$-th of the next $$$m$$$ lines contains two integers $$$a_i$$$, $$$b_i$$$ ($$$1 \\\\leq a_i, b_i \\\\leq n$$$, $$$a_i < b_i$$$), representing an edge connecting $$$a_i$$$ and $$$b_i$$$.It is guaranteed that all edges are distinct and the graph is connected.OutputPrint $$$n$$$ lines, each consisting of $$$n$$$ integers.The integer printed in the row $$$i$$$ and the column $$$j$$$ should be $$$f(i,j) \\\\bmod 998\\\\,244\\\\,353$$$.ExamplesInput4 4 1 2 2 3 3 4 1 4Output2 1 0 1 1 2 1 0 0 1 2 1 1 0 1 2Input8 9 1 2 1 3 1 4 2 7 3 5 3 6 4 8 2 3 3 4Output1 0 0 0 0 0 0 0 0 2 0 0 0 0 2 0 0 0 1 0 1 1 0 0 0 0 0 2 0 0 0 2 0 0 1 0 1 1 0 0 0 0 1 0 1 1 0 0 0 2 0 0 0 0 2 0 0 0 0 2 0 0 0 2NoteThe following picture describes the first example.The tree with red edges is a BFS tree rooted at both $$$1$$$ and $$$2$$$.Similarly, the BFS tree for other adjacent pairs of vertices can be generated in this way.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "5ce71402", "template_md5": "35d339e4", "result": "You are given a connected graph with $n$ vertices and $m$ edges.  \n\nFor any two vertices $i$ and $j$, find the number of spanning trees of the graph that are BFS trees rooted at both $i$ and $j$ simultaneously.  \n\nOutput the number of such spanning trees for all pairs $(i,j)$ modulo $998244353$."}, {"prompt_md5": "e85eb709", "template_md5": "465699a0", "result": "You are given a connected graph.  Find the number of spanning trees of the graph that are also BFS trees rooted at each pair of vertices.  The output is the count modulo 998244353."}]}