{"uid": "1732-D2", "url": "https://codeforces.com/contest/1732/problem/D2", "tags": ["brute force", " data structures", " number theory"], "title": "1732-D2", "statement": "D2. Balance (Hard version)time limit per test3 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputThis is the hard version of the problem. The only difference is that in this version there are remove queries.Initially you have a set containing one element — $$$0$$$. You need to handle $$$q$$$ queries of the following types:+$$$x$$$ — add the integer $$$x$$$ to the set. It is guaranteed that this integer is not contained in the set;-$$$x$$$ — remove the integer $$$x$$$ from the set. It is guaranteed that this integer is contained in the set;?$$$k$$$ — find the $$$k\\\\text{-mex}$$$ of the set.In our problem, we define the $$$k\\\\text{-mex}$$$ of a set of integers as the smallest non-negative integer $$$x$$$ that is divisible by $$$k$$$ and which is not contained in the set.InputThe first line contains an integer $$$q$$$ ($$$1 \\\\leq q \\\\leq 2 \\\\cdot 10^5$$$) — the number of queries.The following $$$q$$$ lines describe the queries.An addition query of integer $$$x$$$ is given in the format+$$$x$$$ ($$$1 \\\\leq x \\\\leq 10^{18}$$$). It is guaranteed that $$$x$$$ is not contained in the set.A remove query of integer $$$x$$$ is given in the format-$$$x$$$ ($$$1 \\\\leq x \\\\leq 10^{18}$$$). It is guaranteed that $$$x$$$ is contained in the set.A search query of $$$k\\\\text{-mex}$$$ is given in the format?$$$k$$$ ($$$1 \\\\leq k \\\\leq 10^{18}$$$).It is guaranteed that there is at least one query of type?.OutputFor each query of type?output a single integer — the $$$k\\\\text{-mex}$$$ of the set.ExamplesInput18+ 1+ 2? 1+ 4? 2+ 6? 3+ 7+ 8? 1? 2+ 5? 1+ 1000000000000000000? 1000000000000000000- 4? 1? 2Output3 6 3 3 10 3 2000000000000000000 3 4Input10+ 100? 100+ 200? 100- 100? 100+ 50? 50- 50? 50Output200 300 100 100 50NoteIn the first example:After the first and second queries, the set will contain elements $$$\\\\{0, 1, 2\\\\}$$$. The smallest non-negative number that is divisible by $$$1$$$ and is not in the set is $$$3$$$.After the fourth query, the set will contain the elements $$$\\\\{0, 1, 2, 4\\\\}$$$. The smallest non-negative number that is divisible by $$$2$$$ and is not in the set is $$$6$$$.In the second example:Initially, the set contains only the element $$$\\\\{0\\\\}$$$.After adding an integer $$$100$$$ the set contains elements $$$\\\\{0, 100\\\\}$$$.$$$100\\\\text{-mex}$$$ of the set is $$$200$$$.After adding an integer $$$200$$$ the set contains elements $$$\\\\{0, 100, 200\\\\}$$$.$$$100\\\\text{-mex}$$$ of the set $$$300$$$.After removing an integer $$$100$$$ the set contains elements $$$\\\\{0, 200\\\\}$$$.$$$100\\\\text{-mex}$$$ of the set is $$$100$$$.After adding an integer $$$50$$$ the set contains elements $$$\\\\{0, 50, 200\\\\}$$$.$$$50\\\\text{-mex}$$$ of the set is $$$100$$$.After removing an integer $$$50$$$ the set contains elements $$$\\\\{0, 200\\\\}$$$.$$$100\\\\text{-mex}$$$ of the set is $$$50$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "7453b068", "template_md5": "35d339e4", "result": "You start with a set containing only the number 0. You will be given a series of queries to perform on this set. \n\nThere are three types of queries:\n\n* **+x:** Add the integer *x* to the set.  *x* will not already be in the set.\n* **-x:** Remove the integer *x* from the set. *x* will be in the set.\n* **?k:** Find the *k*-mex of the set.\n\nThe *k*-mex of a set is the smallest non-negative integer *x* that is divisible by *k* and is not in the set.\n\n**Input:**\n\nThe first line contains an integer *q* (1 ≤ *q* ≤ 2 * 10^5) representing the number of queries.\n\nThe following *q* lines describe the queries. Each line will be one of the following formats:\n\n* +*x* (1 ≤ *x* ≤ 10^18)\n* -*x* (1 ≤ *x* ≤ 10^18)\n* ?*k* (1 ≤ *k* ≤ 10^18)\n\n**Output:**\n\nFor each ?*k* query, output a single integer representing the *k*-mex of the set."}, {"prompt_md5": "a3bb8835", "template_md5": "465699a0", "result": "You start with a set containing only the number 0. You will be given a series of commands:\n\n* **+x:** Add the number *x* to the set.\n* **-x:** Remove the number *x* from the set.\n* **?k:** Find the smallest number divisible by *k* that is not in the set."}]}