{"uid": "1986-G2", "url": "https://codeforces.com/contest/1986/problem/G2", "tags": ["brute force", " data structures", " hashing", " math", " number theory"], "title": "1986-G2", "statement": "G2. Permutation Problem (Hard Version)time limit per test3 secondsmemory limit per test128 megabytesinputstandard inputoutputstandard outputThis is the hard version of the problem. The only difference is that in this version $$$n \\\\leq 5 \\\\cdot 10^5$$$ and the sum of $$$n$$$ for all sets of input data does not exceed $$$5 \\\\cdot 10^5$$$.You are given a permutation $$$p$$$ of length $$$n$$$. Calculate the number of index pairs $$$1 \\\\leq i < j \\\\leq n$$$ such that $$$p_i \\\\cdot p_j$$$ is divisible by $$$i \\\\cdot j$$$ without remainder.A permutation is a sequence of $$$n$$$ integers, in which each integer from $$$1$$$ to $$$n$$$ occurs exactly once. For example, $$$[1]$$$, $$$[3,5,2,1,4]$$$, $$$[1,3,2]$$$ are permutations, while $$$[2,3,2]$$$, $$$[4,3,1]$$$, $$$[0]$$$ are not.InputEach test consists of several sets of input data. The first line contains a single integer $$$t$$$ ($$$1 \\\\leq t \\\\leq 10^4$$$) — the number of sets of input data. Then follows their description.The first line of each set of input data contains a single integer $$$n$$$ ($$$1 \\\\leq n \\\\leq 5 \\\\cdot 10^5$$$) — the length of the permutation $$$p$$$.The second line of each set of input data contains $$$n$$$ distinct integers $$$p_1, p_2, \\\\ldots, p_n$$$ ($$$1 \\\\leq p_i \\\\leq n$$$) — the permutation $$$p$$$.It is guaranteed that the sum of $$$n$$$ for all sets of input data does not exceed $$$5 \\\\cdot 10^5$$$.OutputFor each set of input data, output the number of index pairs $$$1 \\\\leq i < j \\\\leq n$$$ such that $$$p_i \\\\cdot p_j$$$ is divisible by $$$i \\\\cdot j$$$ without remainder.ExampleInput61121 232 3 152 4 1 3 5128 9 7 12 1 10 6 3 2 4 11 5151 2 4 6 8 10 12 14 3 9 15 5 7 11 13Output0 1 1 3 9 3NoteIn the first set of input data, there are no index pairs, as the size of the permutation is $$$1$$$.In the second set of input data, there is one index pair $$$(1, 2)$$$ and it is valid.In the third set of input data, the index pair $$$(1, 2)$$$ is valid.In the fourth set of input data, the index pairs $$$(1, 2)$$$, $$$(1, 5)$$$, and $$$(2, 5)$$$ are valid.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "a2eea808", "template_md5": "35d339e4", "result": "You are given a sequence of $n$ distinct numbers called a permutation.  Find the number of pairs of indices $(i, j)$ where $1 \\le i < j \\le n$ such that the product of the numbers at those indices, $p_i \\cdot p_j$, is perfectly divisible by the product of the indices, $i \\cdot j$.\n\n**Input:**\n\n* The first line contains an integer $t$ representing the number of test cases.\n* For each test case:\n    * The first line contains an integer $n$ representing the length of the permutation.\n    * The second line contains $n$ distinct integers representing the permutation.\n\n**Output:**\n\nFor each test case, output the number of valid index pairs."}, {"prompt_md5": "d59c6284", "template_md5": "465699a0", "result": "You are given a list of numbers.  Find the number of pairs of numbers in the list where the product of the two numbers is divisible by the product of their positions in the list."}]}