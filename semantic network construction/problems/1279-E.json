{"uid": "1279-E", "url": "https://codeforces.com/contest/1279/problem/E", "tags": ["combinatorics", " dp"], "title": "1279-E", "statement": "E. New Year Permutationstime limit per test1 secondmemory limit per test256 megabytesinputstandard inputoutputstandard outputYeah, we failed to make up a New Year legend for this problem.A permutation of length $$$n$$$ is an array of $$$n$$$ integers such that every integer from $$$1$$$ to $$$n$$$ appears in it exactly once.An element $$$y$$$ of permutation $$$p$$$ is reachable from element $$$x$$$ if $$$x = y$$$, or $$$p_x = y$$$, or $$$p_{p_x} = y$$$, and so on.Thedecompositionof a permutation $$$p$$$ is defined as follows: firstly, we have a permutation $$$p$$$, all elements of which arenot marked, and an empty list $$$l$$$. Then we do the following: while there is at least onenot markedelement in $$$p$$$, we find the leftmost such element, list all elements that are reachable from itin the order they appear in $$$p$$$, mark all of these elements, then cyclically shift the list of those elements so that the maximum appears at the first position, and add this listas an elementof $$$l$$$. After all elements are marked, $$$l$$$ is the result of this decomposition.For example, if we want to build a decomposition of $$$p = [5, 4, 2, 3, 1, 7, 8, 6]$$$, we do the following:initially $$$p = [5, 4, 2, 3, 1, 7, 8, 6]$$$ (bold elements are marked), $$$l = []$$$;the leftmost unmarked element is $$$5$$$; $$$5$$$ and $$$1$$$ are reachable from it, so the list we want to shift is $$$[5, 1]$$$; there is no need to shift it, since maximum is already the first element;$$$p = [\\\\textbf{5}, 4, 2, 3, \\\\textbf{1}, 7, 8, 6]$$$, $$$l = [[5, 1]]$$$;the leftmost unmarked element is $$$4$$$, the list of reachable elements is $$$[4, 2, 3]$$$; the maximum is already the first element, so there's no need to shift it;$$$p = [\\\\textbf{5}, \\\\textbf{4}, \\\\textbf{2}, \\\\textbf{3}, \\\\textbf{1}, 7, 8, 6]$$$, $$$l = [[5, 1], [4, 2, 3]]$$$;the leftmost unmarked element is $$$7$$$, the list of reachable elements is $$$[7, 8, 6]$$$; we have to shift it, so it becomes $$$[8, 6, 7]$$$;$$$p = [\\\\textbf{5}, \\\\textbf{4}, \\\\textbf{2}, \\\\textbf{3}, \\\\textbf{1}, \\\\textbf{7}, \\\\textbf{8}, \\\\textbf{6}]$$$, $$$l = [[5, 1], [4, 2, 3], [8, 6, 7]]$$$;all elements are marked, so $$$[[5, 1], [4, 2, 3], [8, 6, 7]]$$$ is the result.TheNew Year transformationof a permutation is defined as follows: we build the decomposition of this permutation; then we sort all lists in decomposition in ascending order of the first elements (we don't swap the elements in these lists, only the lists themselves); then we concatenate the lists into one list which becomes a new permutation. For example, theNew Year transformationof $$$p = [5, 4, 2, 3, 1, 7, 8, 6]$$$ is built as follows:the decomposition is $$$[[5, 1], [4, 2, 3], [8, 6, 7]]$$$;after sorting the decomposition, it becomes $$$[[4, 2, 3], [5, 1], [8, 6, 7]]$$$;$$$[4, 2, 3, 5, 1, 8, 6, 7]$$$ is the result of the transformation.We call a permutationgoodif the result of its transformation is the same as the permutation itself. For example, $$$[4, 3, 1, 2, 8, 5, 6, 7]$$$ is a good permutation; and $$$[5, 4, 2, 3, 1, 7, 8, 6]$$$ is bad, since the result of transformation is $$$[4, 2, 3, 5, 1, 8, 6, 7]$$$.Your task is the following: given $$$n$$$ and $$$k$$$, find the $$$k$$$-th (lexicographically) good permutation of length $$$n$$$.InputThe first line contains one integer $$$t$$$ ($$$1 \\\\le t \\\\le 1000$$$) â€” the number of test cases.Then the test cases follow. Each test case is represented by one line containing two integers $$$n$$$ and $$$k$$$ ($$$1 \\\\le n \\\\le 50$$$, $$$1 \\\\le k \\\\le 10^{18}$$$).OutputFor each test case, print the answer to it as follows: if the number of good permutations of length $$$n$$$ is less than $$$k$$$, print one integer $$$-1$$$; otherwise, print the $$$k$$$-th good permutation on $$$n$$$ elements (in lexicographical order).ExampleInput5 3 3 5 15 4 13 6 8 4 2Output2 1 3  3 1 2 5 4  -1 1 2 6 3 4 5  1 2 4 3", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "a85afd1a", "template_md5": "35d339e4", "result": "You are given two integers $n$ and $k$.  \n\nA permutation of length $n$ is an array of $n$ distinct integers from 1 to $n$.\n\nDefine a \"decomposition\" of a permutation as follows:\n\n1. Start with the permutation and an empty list.\n2. While there is at least one unmarked element in the permutation:\n   - Find the leftmost unmarked element.\n   - List all elements reachable from this element (an element is reachable if it's the element itself, or its value in the permutation, or the value of the element at that value in the permutation, and so on).\n   - Mark all these reachable elements.\n   - Cyclically shift the list of reachable elements so the maximum element is at the beginning.\n   - Add this shifted list to the result list.\n\nThe \"New Year transformation\" of a permutation is:\n\n1. Build its decomposition.\n2. Sort the lists in the decomposition in ascending order based on their first element (don't swap elements within the lists).\n3. Concatenate the sorted lists into a single list.\n\nA permutation is \"good\" if its New Year transformation is the same as the original permutation.\n\nYour task is to find the $k$-th good permutation of length $n$ (lexicographically). If there are fewer than $k$ good permutations, print -1."}, {"prompt_md5": "f743c43e", "template_md5": "465699a0", "result": "Given a number 'n' and a number 'k', find the k-th permutation of length 'n' that, after a specific rearrangement process, results in the same permutation. If there are fewer than 'k' such permutations, output -1."}]}