{"uid": "1207-D", "url": "https://codeforces.com/contest/1207/problem/D", "tags": ["combinatorics"], "title": "1207-D", "statement": "D. Number Of Permutationstime limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputYou are given a sequence of $$$n$$$ pairs of integers: $$$(a_1, b_1), (a_2, b_2), \\\\dots , (a_n, b_n)$$$. This sequence is called bad if it is sorted in non-descending order by first elements or if it is sorted in non-descending order by second elements. Otherwise the sequence is good. There are examples of good and bad sequences:$$$s = [(1, 2), (3, 2), (3, 1)]$$$ is bad because the sequence of first elements is sorted: $$$[1, 3, 3]$$$;$$$s = [(1, 2), (3, 2), (1, 2)]$$$ is bad because the sequence of second elements is sorted: $$$[2, 2, 2]$$$;$$$s = [(1, 1), (2, 2), (3, 3)]$$$ is bad because both sequences (the sequence of first elements and the sequence of second elements) are sorted;$$$s = [(1, 3), (3, 3), (2, 2)]$$$ is good because neither the sequence of first elements $$$([1, 3, 2])$$$ nor the sequence of second elements $$$([3, 3, 2])$$$ is sorted.Calculate the number of permutations of size $$$n$$$ such that after applying this permutation to the sequence $$$s$$$ it turns into a good sequence.A permutation $$$p$$$ of size $$$n$$$ is a sequence $$$p_1, p_2, \\\\dots , p_n$$$ consisting of $$$n$$$ distinct integers from $$$1$$$ to $$$n$$$ ($$$1 \\\\le p_i \\\\le n$$$). If you apply permutation $$$p_1, p_2, \\\\dots , p_n$$$ to the sequence $$$s_1, s_2, \\\\dots , s_n$$$ you get the sequence $$$s_{p_1}, s_{p_2}, \\\\dots , s_{p_n}$$$. For example, if $$$s = [(1, 2), (1, 3), (2, 3)]$$$ and $$$p = [2, 3, 1]$$$ then $$$s$$$ turns into $$$[(1, 3), (2, 3), (1, 2)]$$$.InputThe first line contains one integer $$$n$$$ ($$$1 \\\\le n \\\\le 3 \\\\cdot 10^5$$$).The next $$$n$$$ lines contains description of sequence $$$s$$$. The $$$i$$$-th line contains two integers $$$a_i$$$ and $$$b_i$$$ ($$$1 \\\\le a_i, b_i \\\\le n$$$) — the first and second elements of $$$i$$$-th pair in the sequence.The sequence $$$s$$$ may contain equal elements.OutputPrint the number of permutations of size $$$n$$$ such that after applying this permutation to the sequence $$$s$$$ it turns into a good sequence. Print the answer modulo $$$998244353$$$ (a prime number).ExamplesInput3 1 1 2 2 3 1Output3Input4 2 3 2 2 2 1 2 4Output0Input3 1 1 1 1 2 3Output4NoteIn first test case there are six permutations of size $$$3$$$:if $$$p = [1, 2, 3]$$$, then $$$s = [(1, 1), (2, 2), (3, 1)]$$$ — bad sequence (sorted by first elements);if $$$p = [1, 3, 2]$$$, then $$$s = [(1, 1), (3, 1), (2, 2)]$$$ — bad sequence (sorted by second elements);if $$$p = [2, 1, 3]$$$, then $$$s = [(2, 2), (1, 1), (3, 1)]$$$ — good sequence;if $$$p = [2, 3, 1]$$$, then $$$s = [(2, 2), (3, 1), (1, 1)]$$$ — good sequence;if $$$p = [3, 1, 2]$$$, then $$$s = [(3, 1), (1, 1), (2, 2)]$$$ — bad sequence (sorted by second elements);if $$$p = [3, 2, 1]$$$, then $$$s = [(3, 1), (2, 2), (1, 1)]$$$ — good sequence.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "96f3daa5", "template_md5": "35d339e4", "result": "You are given a sequence of $n$ pairs of integers: $(a_1, b_1), (a_2, b_2), ..., (a_n, b_n)$.  A sequence is considered \"bad\" if the sequence of first elements is sorted in non-decreasing order or if the sequence of second elements is sorted in non-decreasing order. Otherwise, the sequence is \"good\".\n\nFind the number of ways to rearrange (permutate) the order of the pairs so that the resulting sequence is good.  \n\n**Input:**\n\n* The first line contains an integer $n$ ($1 \\le n \\le 3 \\cdot 10^5$).\n* The next $n$ lines each contain two integers $a_i$ and $b_i$ ($1 \\le a_i, b_i \\le n$) representing a pair.\n\n**Output:**\n\nPrint the number of good permutations modulo 998244353."}, {"prompt_md5": "80169ae8", "template_md5": "465699a0", "result": "You are given a list of pairs of numbers.  Determine how many ways you can rearrange the list so that the order of the first numbers in each pair and the order of the second numbers in each pair are not both increasing."}]}