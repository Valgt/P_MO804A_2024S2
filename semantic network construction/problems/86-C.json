{"uid": "86-C", "url": "https://codeforces.com/contest/86/problem/C", "tags": ["dp", " string suffix structures", " trees"], "title": "86-C", "statement": "C. Genetic engineeringtime limit per test2 secondsmemory limit per test256 megabytesinputstdinoutputstdout\"Multidimensional spaces are completely out of style these days, unlike genetics problems\" — thought physicist Woll and changed his subject of study to bioinformatics. Analysing results of sequencing he faced the following problem concerning DNA sequences. We will further think of a DNA sequence as an arbitrary string of uppercase letters \"A\", \"C\", \"G\" and \"T\" (of course, this is a simplified interpretation).Letwbe a long DNA sequence ands1,s2, ...,sm— collection of short DNA sequences. Let us say that the collectionfilterswiffwcan be covered with the sequences from the collection. Certainly, substrings corresponding to the different positions of the string may intersect or even cover each other. More formally: denote by|w|the length ofw, let symbols ofwbe numbered from1to|w|. Then for each positioniinwthere exist pair of indicesl,r(1 ≤l≤i≤r≤ |w|) such that the substringw[l...r]equals one of the elementss1,s2, ...,smof the collection.Woll wants to calculate the number of DNA sequences of a given length filtered by a given collection, but he doesn't know how to deal with it. Help him! Your task is to find the number of different DNA sequences of lengthnfiltered by the collection{si}.Answer may appear very large, so output it modulo1000000009.InputFirst line contains two integer numbersnandm(1 ≤n≤ 1000, 1 ≤m≤ 10) — the length of the string and the number of sequences in the collection correspondently.Nextmlines contain the collection sequencessi, one per line. Eachsiis a nonempty string of length not greater than10. All the strings consist of uppercase letters \"A\", \"C\", \"G\", \"T\". The collection may contain identical strings.OutputOutput should contain a single integer — the number of strings filtered by the collection modulo1000000009(109+ 9).ExamplesInput2 1AOutput1Input6 2CATTACTOutput2NoteIn the first sample, a string has to be filtered by \"A\". Clearly, there is only one such string: \"AA\".In the second sample, there exist exactly two different strings satisfying the condition (see the pictures below).", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "2439af57", "template_md5": "35d339e4", "result": "Given a length $n$ and a collection of $m$ short DNA sequences ($s_1, s_2, ..., s_m$), find the number of different DNA sequences of length $n$ that can be formed using these sequences. \n\nA DNA sequence is considered \"filtered\" if it can be constructed by piecing together the given short sequences, allowing for overlap.\n\nThe answer should be output modulo $1000000009$."}, {"prompt_md5": "cf6500ca", "template_md5": "465699a0", "result": "Given a target length and a set of shorter strings, count how many different strings of the target length can be formed using only the strings in the set.  The strings in the set can overlap.  The answer should be given modulo 1000000009."}]}