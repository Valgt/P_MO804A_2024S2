{"uid": "1436-F", "url": "https://codeforces.com/contest/1436/problem/F", "tags": ["combinatorics", " math", " number theory"], "title": "1436-F", "statement": "F. Sum Over Subsetstime limit per test1 secondmemory limit per test256 megabytesinputstandard inputoutputstandard outputYou are given a multiset $$$S$$$. Over all pairs of subsets $$$A$$$ and $$$B$$$, such that:$$$B \\\\subset A$$$;$$$|B| = |A| - 1$$$;greatest common divisor of all elements in $$$A$$$ is equal to one;find the sum of $$$\\\\sum_{x \\\\in A}{x} \\\\cdot \\\\sum_{x \\\\in B}{x}$$$, modulo $$$998\\\\,244\\\\,353$$$.InputThe first line contains one integer $$$m$$$ ($$$1 \\\\le m \\\\le 10^5$$$): the number of different values in the multiset $$$S$$$.Each of the next $$$m$$$ lines contains two integers $$$a_i$$$, $$$freq_i$$$ ($$$1 \\\\le a_i \\\\le 10^5, 1 \\\\le freq_i \\\\le 10^9$$$). Element $$$a_i$$$ appears in the multiset $$$S$$$ $$$freq_i$$$ times. All $$$a_i$$$ are different.OutputPrint the required sum, modulo $$$998\\\\,244\\\\,353$$$.ExamplesInput2 1 1 2 1Output9Input4 1 1 2 1 3 1 6 1Output1207Input1 1 5Output560NoteA multiset is a set where elements are allowed to coincide. $$$|X|$$$ is the cardinality of a set $$$X$$$, the number of elements in it.$$$A \\\\subset B$$$: Set $$$A$$$ is a subset of a set $$$B$$$.In the first example $$$B=\\\\{1\\\\}, A=\\\\{1,2\\\\}$$$ and $$$B=\\\\{2\\\\}, A=\\\\{1, 2\\\\}$$$ have a product equal to $$$1\\\\cdot3 + 2\\\\cdot3=9$$$. Other pairs of $$$A$$$ and $$$B$$$ don't satisfy the given constraints.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "275f67b5", "template_md5": "35d339e4", "result": "You are given a set of numbers, where some numbers appear multiple times.  \n\nFind the sum of the products of the sums of all possible pairs of subsets. \n\nHere are the rules for the subsets:\n\n* One subset must be a subset of the other.\n* The smaller subset must have one fewer element than the larger subset.\n* The greatest common divisor (GCD) of all the numbers in the larger subset must be 1.\n\nCalculate the sum of the products of the sums of the subsets, and output the result modulo 998244353."}, {"prompt_md5": "b51bd386", "template_md5": "465699a0", "result": "You are given a collection of numbers and their frequencies. Find the sum of the products of the sums of all possible pairs of subsets, where one subset is a smaller subset of the other, and the smaller subset has one fewer element. The sum should be taken modulo 998244353."}]}