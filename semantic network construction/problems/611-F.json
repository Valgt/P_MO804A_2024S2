{"uid": "611-F", "url": "https://codeforces.com/contest/611/problem/F", "tags": ["binary search", " implementation"], "title": "611-F", "statement": "F. New Year and Cleaningtime limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputLimak is a little polar bear. His parents told him to clean a house before the New Year's Eve. Their house is a rectangular grid withhrows andwcolumns. Each cell is an empty square.He is a little bear and thus he can't clean a house by himself. Instead, he is going to use a cleaning robot.A cleaning robot has a built-in pattern ofnmoves, defined by a string of the lengthn. A single move (character) moves a robot to one of four adjacent cells. Each character is one of the following four: 'U' (up), 'D' (down), 'L' (left), 'R' (right). One move takes one minute.A cleaning robot must be placed and started in some cell. Then it repeats its pattern of moves till it hits a wall (one of four borders of a house). After hitting a wall it can be placed and used again.Limak isn't sure if placing a cleaning robot in one cell will be enough. Thus, he is going to start itw·htimes, one time in each cell. Maybe some cells will be cleaned more than once but who cares?Limak asks you one question. How much time will it take to clean a house? Find and print the number of minutes modulo109+ 7. It's also possible that a cleaning robot will never stop — then print \"-1\" (without the quotes) instead.Placing and starting a robot takes no time, however, you must count a move when robot hits a wall. Take a look into samples for further clarification.InputThe first line contains three integersn,handw(1 ≤n,h,w≤ 500 000) — the length of the pattern, the number of rows and the number of columns, respectively.The second line contains a string of lengthn— the pattern ofnmoves. Each character is one of uppercase letters 'U', 'D', 'L' or 'R'.OutputPrint one line with the answer.If a cleaning robot will never stop, print \"-1\" (without the quotes). Otherwise, print the number of minutes it will take to clean a house modulo109+ 7.ExamplesInput1 10 2ROutput30Input3 4 6RULOutput134Input4 1 500000RLRLOutput-1NoteIn the first sample house is a grid with10rows and2columns. Starting a robot anywhere in the second column will result in only one move (thus, one minute of cleaning) in which robot will hit a wall — he tried to go right but there is no third column. Starting a robot anywhere in the first column will result in two moves. The total number of minutes is10·1 + 10·2 = 30.In the second sample a started robot will try to move \"RULRULRULR...\" For example, for the leftmost cell in the second row robot will make5moves before it stops because of hitting an upper wall.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "10b29ddb", "template_md5": "35d339e4", "result": "You are given a rectangular grid with $h$ rows and $w$ columns. Each cell is empty.\n\nA cleaning robot follows a pattern of $n$ moves, represented by a string of length $n$. Each move is either 'U' (up), 'D' (down), 'L' (left), or 'R' (right). The robot starts in a cell and repeats its pattern until it hits a wall (the edge of the grid).\n\nThe robot can be placed and started in any cell.  You need to determine the total time it takes to clean the entire grid, considering that the robot can be placed and started in each cell.\n\n**Input:**\n\n* $n$: the length of the robot's move pattern\n* $h$: the number of rows in the grid\n* $w$: the number of columns in the grid\n* A string of length $n$ representing the robot's move pattern\n\n**Output:**\n\n* The total time it takes to clean the grid, modulo $10^9 + 7$. \n* If the robot never stops moving, output \"-1\"."}, {"prompt_md5": "1c5f0991", "template_md5": "465699a0", "result": "A rectangular grid needs to be cleaned. A robot cleans by following a set pattern of moves (up, down, left, right). The robot cleans until it hits a wall.  The robot can be placed in any cell and started repeatedly.  Find the total cleaning time in minutes, modulo 10^9 + 7, or -1 if the robot never stops."}]}