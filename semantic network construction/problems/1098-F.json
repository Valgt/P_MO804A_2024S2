{"uid": "1098-F", "url": "https://codeforces.com/contest/1098/problem/F", "tags": ["string suffix structures", " strings"], "title": "1098-F", "statement": "F. Ж-functiontime limit per test6 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputThe length of the longest common prefix of two strings $$$s=s_1 s_2 \\\\ldots s_n$$$ and $$$t = t_1 t_2 \\\\ldots t_m$$$ is defined as the maximum $$$k \\\\le \\\\min(n, m)$$$ such that $$$s_1 s_2 \\\\ldots s_k$$$ equals $$$t_1 t_2 \\\\ldots t_k$$$. Let's denote the longest common prefix of two strings $$$s$$$ and $$$t$$$ as $$$lcp(s,t)$$$.Z-function of a string $$$s_1 s_2 \\\\dots s_n$$$ is a sequence of integers $$$z_1, z_2, \\\\ldots, z_n$$$, where $$$z_i = lcp(s_1 s_2 \\\\ldots s_n,\\\\ \\\\ s_i s_{i+1} \\\\dots s_n)$$$.Ж-functionof a string $$$s$$$ is defined as $$$z_1 + z_2 + \\\\ldots + z_n$$$.You're given a string $$$s=s_1 s_2 \\\\ldots s_n$$$ and $$$q$$$ queries. Each query is described by two integers $$$l_i$$$ and $$$r_i$$$, where $$$1 \\\\le l_i \\\\le r_i \\\\le n$$$. The answer for the query is defined as Ж-function of the string $$$s_{l_i} s_{l_i +1} \\\\ldots s_{r_i}$$$.InputThe first line contains the string $$$s$$$, consisting of lowercase English letters ($$$1 \\\\leq |s| \\\\leq 200\\\\,000$$$). The second line contains one integer $$$q$$$ — the number of queries ($$$1 \\\\leq q \\\\leq 200\\\\,000$$$). Each of the following $$$q$$$ lines contains two integers $$$l_i$$$ and $$$r_i$$$, describing the query ($$$1 \\\\leq l_i \\\\leq r_i \\\\leq |s|$$$).OutputFor every query output one integer: the value of Ж-function of the corresponding substring.ExamplesInputabbd 4 2 3 1 3 3 3 1 4Output3 3 1 4Inputbbaaa 5 2 4 1 5 1 5 3 3 1 2Output3 6 6 1 3NoteIn the first sample case there are four queries:the first query corresponds to the substringbb, and its Ж-function equals $$$2 + 1 = 3$$$;the second query corresponds to the substringabb, and its Ж-function equals $$$3 + 0 + 0 = 3$$$;the third query corresponds to the substringb, and its Ж-function equals $$$1$$$.the fourth query corresponds to the substringabdd, and its Ж-function equals $$$4 + 0 + 0 + 0= 4$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "e0342bd9", "template_md5": "35d339e4", "result": "You are given a string  $s$ of lowercase English letters. You need to calculate the Ж-function for several substrings of $s$.\n\nThe Ж-function of a string is the sum of its Z-values. The Z-value of a string $s_i$ is the length of the longest common prefix of $s$ and the substring starting at index $i$ ($s_i s_{i+1} ... s_n$).\n\nFor example, if $s = \"abbd\"$, then the Z-values are:\n\n* $z_1 = lcp(s, s_1) = lcp(\"abbd\", \"abbd\") = 4$\n* $z_2 = lcp(s, s_2s_3) = lcp(\"abbd\", \"b bd\") = 1$\n* $z_3 = lcp(s, s_3s_4) = lcp(\"abbd\", \"bd\") = 0$\n* $z_4 = lcp(s, s_4) = lcp(\"abbd\", \"d\") = 0$\n\nTherefore, the Ж-function of $s$ is $4 + 1 + 0 + 0 = 5$.\n\nYou will be given a string $s$ and $q$ queries. Each query is defined by two integers $l_i$ and $r_i$, representing a substring of $s$ from index $l_i$ to $r_i$ (inclusive). For each query, you need to calculate the Ж-function of the corresponding substring."}, {"prompt_md5": "81d50765", "template_md5": "465699a0", "result": "You are given a string and a number of queries. Each query specifies a substring within the string. For each query, calculate the sum of the lengths of the longest common prefixes of the substring with all of its suffixes."}]}