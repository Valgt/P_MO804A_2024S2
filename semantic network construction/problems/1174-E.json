{"uid": "1174-E", "url": "https://codeforces.com/contest/1174/problem/E", "tags": ["combinatorics", " dp", " math", " number theory"], "title": "1174-E", "statement": "E. Ehab and the Expected GCD Problemtime limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputLet's define a function $$$f(p)$$$ on a permutation $$$p$$$ as follows. Let $$$g_i$$$ be thegreatest common divisor (GCD)of elements $$$p_1$$$, $$$p_2$$$, ..., $$$p_i$$$ (in other words, it is the GCD of the prefix of length $$$i$$$). Then $$$f(p)$$$ is the number ofdistinctelements among $$$g_1$$$, $$$g_2$$$, ..., $$$g_n$$$.Let $$$f_{max}(n)$$$ be the maximum value of $$$f(p)$$$ among all permutations $$$p$$$ of integers $$$1$$$, $$$2$$$, ..., $$$n$$$.Given an integers $$$n$$$, count the number of permutations $$$p$$$ of integers $$$1$$$, $$$2$$$, ..., $$$n$$$, such that $$$f(p)$$$ is equal to $$$f_{max}(n)$$$. Since the answer may be large, print the remainder of its division by $$$1000\\\\,000\\\\,007 = 10^9 + 7$$$.InputThe only line contains the integer $$$n$$$ ($$$2 \\\\le n \\\\le 10^6$$$) — the length of the permutations.OutputThe only line should contain your answer modulo $$$10^9+7$$$.ExamplesInput2Output1Input3Output4Input6Output120NoteConsider the second example: these are the permutations of length $$$3$$$:$$$[1,2,3]$$$, $$$f(p)=1$$$.$$$[1,3,2]$$$, $$$f(p)=1$$$.$$$[2,1,3]$$$, $$$f(p)=2$$$.$$$[2,3,1]$$$, $$$f(p)=2$$$.$$$[3,1,2]$$$, $$$f(p)=2$$$.$$$[3,2,1]$$$, $$$f(p)=2$$$.The maximum value $$$f_{max}(3) = 2$$$, and there are $$$4$$$ permutations $$$p$$$ such that $$$f(p)=2$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "e1b495b9", "template_md5": "35d339e4", "result": "Given a positive integer $n$, find the number of permutations of the integers from 1 to $n$ where the number of distinct greatest common divisors (GCD) of the prefix sums of the permutation is maximum.  Output the answer modulo $10^9 + 7$.\n\nFor example, for $n=3$, the maximum number of distinct GCDs is 2, and there are 4 permutations that achieve this."}, {"prompt_md5": "0b0369d7", "template_md5": "465699a0", "result": "Given a number *n*, find the number of ways to arrange the numbers 1 to *n* so that the number of unique greatest common divisors of the prefix sums of the arrangement is the maximum possible.  The answer should be the remainder when divided by 10^9 + 7."}]}