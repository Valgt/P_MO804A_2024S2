{"uid": "1797-E", "url": "https://codeforces.com/contest/1797/problem/E", "tags": ["brute force", " data structures", " dsu", " math", " number theory", " two pointers"], "title": "1797-E", "statement": "E. Li Hua and Arraytime limit per test3 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputLi Hua wants to solve a problem about $$$\\\\varphi$$$ — Euler's totient function. Please recall that $$$\\\\varphi(x)=\\\\sum\\\\limits_{i=1}^x[\\\\gcd(i,x)=1]$$$.$$$^{\\\\dagger,\\\\ddagger}$$$He has a sequence $$$a_1,a_2,\\\\cdots,a_n$$$ and he wants to perform $$$m$$$ operations:\"1 $$$l$$$ $$$r$$$\" ($$$1\\\\le l\\\\le r\\\\le n$$$) — foreach$$$x\\\\in[l,r]$$$, change $$$a_x$$$ into $$$\\\\varphi(a_x)$$$.\"2 $$$l$$$ $$$r$$$\" ($$$1\\\\le l\\\\le r\\\\le n$$$) — find out the minimum changes needed to make sure $$$a_l=a_{l+1}=\\\\cdots=a_r$$$. In each change, he choosesone$$$x\\\\in[l,r]$$$, change $$$a_x$$$ into $$$\\\\varphi(a_x)$$$. Each operation of this type is independent, which means the array doesn't actually change.Suppose you were Li Hua, please solve this problem.$$$^\\\\dagger$$$ $$$\\\\gcd(x,y)$$$ denotes thegreatest common divisor (GCD)of integers $$$x$$$ and $$$y$$$.$$$^\\\\ddagger$$$ The notation $$$[\\\\textrm{cond}]$$$ equals $$$1$$$ if the condition $$$\\\\textrm{cond}$$$ is true, and $$$0$$$ otherwise.InputThe first line contains two integers $$$n$$$ and $$$m$$$ ($$$1\\\\le n,m\\\\le 10^{5}$$$) — the number of elements in the array and the number of operations to process, respectively.The second line contains $$$n$$$ integers $$$a_{1},a_{2},\\\\cdots ,a_{n}$$$ ($$$1\\\\le a_{i}\\\\le 5\\\\cdot 10^{6}$$$) — the elements of the array.Next $$$m$$$ lines, each line contains three integers $$$t_{i},l_{i},r_{i}$$$ ($$$t_i\\\\in\\\\{1,2\\\\},1\\\\le l_i\\\\le r_i\\\\le n$$$) — the $$$i$$$-th operation.OutputFor each \"2 $$$l$$$ $$$r$$$\", output the answer in an separate line.ExampleInput5 4 8 1 6 3 7 2 1 5 2 3 4 1 1 3 2 3 4Output10 2 1NoteDenote $$$\\\\varphi^k(x)=\\\\begin{cases}x,&k=0\\\\\\\\\\\\varphi(\\\\varphi^{k-1}(x)),&k > 0\\\\end{cases}$$$.At first, $$$a=[8,1,6,3,7]$$$.To make sure $$$a_1=a_2=a_3=a_4=a_5$$$, we can change $$$a$$$ to $$$a'=[\\\\varphi^3(8),\\\\varphi^0(1),\\\\varphi^2(6),\\\\varphi^2(3),\\\\varphi^3(7)]=[1,1,1,1,1]$$$, using $$$3+0+2+2+3=10$$$ changes.To make sure $$$a_3=a_4$$$, we can change $$$a$$$ to $$$a'=[\\\\varphi^0(8),\\\\varphi^0(1),\\\\varphi^1(6),\\\\varphi^1(3),\\\\varphi^0(7)]=[8,1,2,2,7]$$$, using $$$0+0+1+1+0=2$$$ changes.After \"1 $$$1$$$ $$$3$$$\", $$$a$$$ is changed to $$$a=[\\\\varphi^1(8),\\\\varphi^1(1),\\\\varphi^1(6),\\\\varphi^0(3),\\\\varphi^0(7)]=[4,1,2,3,7]$$$.To make sure $$$a_3=a_4$$$, we can change $$$a$$$ to $$$a'=[\\\\varphi^0(4),\\\\varphi^0(1),\\\\varphi^0(2),\\\\varphi^1(3),\\\\varphi^0(7)]=[4,1,2,2,7]$$$, using $$$0+0+0+1+0=1$$$ change.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "50d4b84a", "template_md5": "35d339e4", "result": "You are given an array of integers $a_1, a_2, ..., a_n$. You can perform two types of operations:\n\n1. **Change elements:** For a given range $[l, r]$, change each element $a_i$ in the range to $\\varphi(a_i)$, where $\\varphi(x)$ is Euler's totient function.\n\n2. **Find minimum changes:** For a given range $[l, r]$, find the minimum number of operations of type 1 needed to make all elements in the range equal.\n\nInput:\n\n* The first line contains two integers $n$ and $m$ ($1 \\le n, m \\le 10^5$) representing the size of the array and the number of operations, respectively.\n* The second line contains $n$ integers $a_1, a_2, ..., a_n$ ($1 \\le a_i \\le 5 \\cdot 10^6$).\n* The next $m$ lines, each line contains three integers $t_i, l_i, r_i$ ($t_i \\in \\{1, 2\\}$, $1 \\le l_i \\le r_i \\le n$) representing the type of operation and the range.\n\nOutput:\n\nFor each operation of type 2, output the minimum number of changes needed on a separate line."}, {"prompt_md5": "8a8674dc", "template_md5": "465699a0", "result": "You are given an array of numbers. You can perform two types of operations:\n\n1. Change each number in a given range to its totient value.\n2. Find the minimum number of operations needed to make all numbers in a given range equal. \n\nOutput the result for each operation of type 2."}]}