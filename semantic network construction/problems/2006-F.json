{"uid": "2006-F", "url": "https://codeforces.com/contest/2006/problem/F", "tags": ["brute force", " combinatorics", " constructive algorithms", " graphs", " implementation"], "title": "2006-F", "statement": "F. Dora's Painttime limit per test3 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputSadly, Dora poured the paint when painting the class mural. Dora considers the mural as the matrix $$$b$$$ of size $$$n \\\\times n$$$. Initially, $$$b_{i,j} = 0$$$ for all $$$1 \\\\le i, j \\\\le n$$$.Dora has only two brushes which have two different colors. In one operation, she can paint the matrix with one of two brushes:The first brush has color $$$1$$$ on it and can paint one column of the matrix. That is, Dora chooses $$$1 \\\\leq j \\\\leq n$$$ and makes $$$b_{i,j} := 1$$$ for all $$$1 \\\\leq i \\\\leq n$$$;The second brush has color $$$2$$$ on it and can paint one row of the matrix. That is, Dora chooses $$$1 \\\\leq i \\\\leq n$$$ and makes $$$b_{i,j} := 2$$$ for all $$$1 \\\\leq j \\\\leq n$$$.Dora paints the matrix so that the resulting matrix $$$b$$$contains only$$$1$$$ and $$$2$$$.For a matrix $$$b$$$, let $$$f(b)$$$ denote the minimum number of operations needed to turn the initial matrix (containing only $$$0$$$) into $$$b$$$. Thebeautyof a matrix $$$b$$$ is the number of ways to paint the initial matrix in exactly $$$f(b)$$$ operations to turn it into $$$b$$$. If there's no way to turn the initial matrix into $$$b$$$, the beauty of $$$b$$$ is $$$0$$$.However, Dora made a uniformly random mistake; there'sexactly oneelement different in the matrix $$$a$$$ given to you from the real matrix $$$b$$$. That is, there is exactly one pair $$$(i, j)$$$ such that $$$a_{i, j} = 3 - b_{i, j}$$$.Please help Dora compute the expected beauty of the real matrix $$$b$$$ modulo $$$998\\\\,244\\\\,353$$$ (all possible $$$n^2$$$ mistakes have equal probability).Since the size of the matrix is too large, Dora will only tell you the positions of $$$m$$$ elements of color $$$1$$$, and the remaining $$$n^2-m$$$ elements have color $$$2$$$.InputEach test consists of multiple test cases. The first line contains a single integer $$$t$$$ ($$$1 \\\\leq t \\\\leq 10^4$$$) — the number of test cases. The description of the test cases follows.The first line of each test case contains two integers $$$n$$$ and $$$m$$$ ($$$2 \\\\leq n \\\\leq 2 \\\\cdot 10^5$$$, $$$0 \\\\leq m \\\\leq \\\\min(10^6, n^2)$$$) — the size of the matrix and the number of elements of color $$$1$$$.Then $$$m$$$ lines follow, each containing two positive integers $$$x_i$$$ and $$$y_i$$$ ($$$1 \\\\leq x_i, y_i \\\\leq n$$$) — denoting that $$$a_{x_i, y_i} = 1$$$.It is guaranteed that if $$$i \\\\neq j$$$, then $$$(x_i, y_i) \\\\neq (x_j, y_j)$$$.It is also guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$4\\\\cdot10^5$$$, and the sum of $$$m$$$ over all test cases does not exceed $$$10^6$$$.OutputFor each test case, output a single integer — the expected beauty of the real matrix $$$b$$$, modulo $$$998\\\\,244\\\\,353$$$.ExampleInput72 21 11 22 11 13 21 13 36 05 101 11 21 32 12 35 15 25 35 45 53 51 11 32 23 13 34 31 12 32 4Output1 499122178 665496236 120 79859554 776412275 1NoteIn the first test case, the matrix $$$a = \\\\left[\\\\begin{matrix}1&1\\\\\\\\2&2\\\\end{matrix}\\\\right]$$$. Let's consider changing the element $$$(1,1)$$$ to calculate the answer.It can be proved that the minimum steps to paint the initial matrix into $$$\\\\left[\\\\begin{matrix}2&1\\\\\\\\2&2\\\\end{matrix}\\\\right]$$$ is $$$3$$$. We can first paint the first row into color $$$2$$$, then paint the second column into color $$$1$$$, and finally paint the second row into color $$$2$$$. The process is listed below:$$$$$$\\\\left[\\\\begin{matrix}0&0\\\\\\\\0&0\\\\end{matrix}\\\\right]\\\\Rightarrow\\\\left[\\\\begin{matrix}2&2\\\\\\\\0&0\\\\end{matrix}\\\\right]\\\\Rightarrow\\\\left[\\\\begin{matrix}2&1\\\\\\\\0&1\\\\end{matrix}\\\\right]\\\\Rightarrow\\\\left[\\\\begin{matrix}2&1\\\\\\\\2&2\\\\end{matrix}\\\\right]$$$$$$It can be proved that this is the only way to paint the matrix in $$$3$$$ steps. So the beauty of the matrix $$$\\\\left[\\\\begin{matrix}2&1\\\\\\\\2&2\\\\end{matrix}\\\\right]$$$ is $$$1$$$. Similarly, if any other element of the matrix is changed, the beauty is always $$$1$$$, so the expected beauty of the real matrix $$$b$$$ is $$$1$$$.In the second test case, the matrix $$$a = \\\\left[\\\\begin{matrix}1&2\\\\\\\\2&2\\\\end{matrix}\\\\right]$$$. Let's consider changing the element $$$(2, 2)$$$ to calculate the answer.It can be proven that it's impossible to paint the initial matrix into $$$\\\\left[\\\\begin{matrix}1&2\\\\\\\\2&1\\\\end{matrix}\\\\right]$$$, so its beauty is $$$0$$$. If any other element of the matrix is changed, the beauty is always $$$2$$$, so the expected beauty is $$$\\\\frac{0 + 2 + 2 + 2}{4} = \\\\frac{6}{4} \\\\equiv 499\\\\,122\\\\,178 \\\\pmod {998\\\\,244\\\\,353}$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "6c59bc77", "template_md5": "35d339e4", "result": "You are given a matrix of size $n \\times n$ with elements that are either 0, 1, or 2.  \n\nThere are two operations you can perform:\n\n1. Paint an entire column with color 1.\n2. Paint an entire row with color 2.\n\nYou know that the matrix was originally all 0s and that exactly one element in the given matrix is different from the true matrix. This means there is exactly one pair $(i, j)$ such that $a_{i,j} = 3 - b_{i,j}$.\n\nYou are given the positions of $m$ elements that are equal to 1 in the matrix. The remaining $n^2 - m$ elements are equal to 2.\n\nFind the expected beauty of the true matrix, modulo 998244353. The beauty of a matrix is the number of ways to paint the original matrix (all 0s) to get that matrix using the minimum number of operations.\n\n**Input:**\n\n* The first line contains the number of test cases, $t$.\n* For each test case:\n    * The first line contains two integers, $n$ and $m$.\n    * The next $m$ lines each contain two integers, $x_i$ and $y_i$, representing the position of an element equal to 1 in the matrix.\n\n**Output:**\n\n* For each test case, output a single integer representing the expected beauty of the true matrix, modulo 998244353."}, {"prompt_md5": "e133c7c6", "template_md5": "465699a0", "result": "You are given a partially filled grid. Some cells are filled with 1, some with 2, and some are empty. You can fill a whole row or a whole column with either 1 or 2.  You need to find the average number of ways to fill the entire grid with 1s and 2s, given that exactly one cell in the partially filled grid is incorrect."}]}