{"uid": "1085-G", "url": "https://codeforces.com/contest/1085/problem/G", "tags": ["combinatorics", " data structures", " dp"], "title": "1085-G", "statement": "G. Beautiful Matrixtime limit per test4 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputPetya collectsbeautifulmatrix.A matrix of size $$$n \\\\times n$$$ isbeautifulif:All elements of the matrix are integers between $$$1$$$ and $$$n$$$;For every row of the matrix, all elements of this row are different;For every pair of vertically adjacent elements, these elements are different.Today Petya bought abeautifulmatrix $$$a$$$ of size $$$n \\\\times n$$$, and now he wants to determine its rarity.The rarity of the matrix is its index in the list ofbeautifulmatrices of size $$$n \\\\times n$$$, sorted in lexicographical order. Matrix comparison is done row by row. (The index of lexicographically smallest matrix iszero).Since the number ofbeautifulmatrices may be huge, Petya wants you to calculate the rarity of the matrix $$$a$$$ modulo $$$998\\\\,244\\\\,353$$$.InputThe first line contains one integer $$$n$$$ ($$$1 \\\\le n \\\\le 2000$$$) — the number of rows and columns in $$$a$$$.Each of the next $$$n$$$ lines contains $$$n$$$ integers $$$a_{i,j}$$$ ($$$1 \\\\le a_{i,j} \\\\le n$$$) — the elements of $$$a$$$.It is guaranteed that $$$a$$$ is abeautifulmatrix.OutputPrint one integer — the rarity of matrix $$$a$$$, taken modulo $$$998\\\\,244\\\\,353$$$.ExamplesInput2 2 1 1 2Output1Input3 1 2 3 2 3 1 3 1 2Output1Input3 1 2 3 3 1 2 2 3 1Output3NoteThere are only $$$2$$$beautifulmatrices of size $$$2 \\\\times 2$$$:There are the first $$$5$$$beautifulmatrices of size $$$3 \\\\times 3$$$ in lexicographical order:", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "824b6b2f", "template_md5": "35d339e4", "result": "You are given a square matrix of size $n \\times n$ where all elements are integers between 1 and $n$.  \n\nThe matrix is considered \"beautiful\" if:\n\n* All elements in each row are different.\n* All elements in adjacent columns are different.\n\nYour task is to determine the \"rarity\" of this matrix. The rarity is its position in a sorted list of all beautiful matrices of size $n \\times n$, ordered lexicographically (row by row).  \n\nThe output should be the rarity of the matrix modulo 998244353."}, {"prompt_md5": "a34c221d", "template_md5": "465699a0", "result": "You are given a square matrix of numbers.  Determine the order of this matrix in a sorted list of all possible square matrices of the same size, where the sorting is done row by row. The output should be the order modulo 998244353."}]}