{"uid": "1718-F", "url": "https://codeforces.com/contest/1718/problem/F", "tags": ["data structures", " math", " number theory"], "title": "1718-F", "statement": "F. Burenka, an Array and Queriestime limit per test3 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputEugene got Burenka an array $$$a$$$ of length $$$n$$$ of integers from $$$1$$$ to $$$m$$$ for her birthday. Burenka knows that Eugene really likescoprimeintegers (integers $$$x$$$ and $$$y$$$ such that they have only one common factor (equal to $$$1$$$)) so she wants to to ask Eugene $$$q$$$ questions about the present.Each time Burenka will choose a subsegment $$$a_l, a_{l + 1}, \\\\ldots, a_r$$$ of array $$$a$$$, and compute the product of these numbers $$$p = a_l \\\\cdot a_{l + 1} \\\\cdot \\\\ldots \\\\cdot a_r$$$. Then she will ask Eugene to count the number of integers between $$$1$$$ and $$$C$$$ inclusive which are coprime with $$$p$$$.Help Eugene answer all the questions!InputIn the first line of input there are four integers $$$n$$$, $$$m$$$, $$$C$$$, $$$q$$$ ($$$1 \\\\leq n, q \\\\leq 10^5$$$, $$$1 \\\\leq m \\\\leq 2\\\\cdot 10^4$$$, $$$1 \\\\leq C \\\\leq 10^5$$$) — the length of the array $$$a$$$, the maximum possible value of $$$a_{i}$$$, the value $$$C$$$, and the number of queries.The second line contains $$$n$$$ integers $$$a_1, a_2, \\\\ldots, a_n$$$ ($$$1 \\\\leq a_{i} \\\\leq m$$$) — the array $$$a$$$ .In the next $$$q$$$ lines the queries are given. Each query consists of two integers $$$l$$$ and $$$r$$$ ($$$1 \\\\leq l \\\\leq r \\\\leq n$$$).OutputPrint $$$q$$$ integers — the answers to Burenka's queries.ExampleInput5 5 5 3 1 2 3 2 5 1 1 2 4 4 5Output5 2 2NoteHere's an explanation for the example:in the first query, the product is equal to $$$1$$$, which is coprime with $$$1,2,3,4,5$$$.in the second query, the product is equal to $$$12$$$, which is coprime with $$$1$$$ and $$$5$$$.in the third query, the product is equal to $$$10$$$, which is coprime with $$$1$$$ and $$$3$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "b586ec76", "template_md5": "35d339e4", "result": "You are given an array of $n$ integers, $a_1, a_2, ..., a_n$, where each integer is between 1 and $m$ inclusive. You will be asked $q$ queries. Each query consists of two integers $l$ and $r$, representing a subsegment of the array, $a_l, a_{l+1}, ..., a_r$.\n\nFor each query, you need to calculate the product of the numbers in the subsegment, $p = a_l \\cdot a_{l+1} \\cdot ... \\cdot a_r$. Then, count how many integers between 1 and $C$ inclusive are coprime with $p$. \n\nOutput the count of coprime integers for each query."}, {"prompt_md5": "69f6f1be", "template_md5": "465699a0", "result": "You are given an array of numbers.  You will be asked multiple times to find the number of numbers between 1 and a given limit that are relatively prime to the product of a sub-array."}]}