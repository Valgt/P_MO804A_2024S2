{"uid": "997-D", "url": "https://codeforces.com/contest/997/problem/D", "tags": ["combinatorics", " divide and conquer", " trees"], "title": "997-D", "statement": "D. Cycles in producttime limit per test7 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputConsider a tree (that is, an undirected connected graph without loops) $$$T_1$$$ and a tree $$$T_2$$$. Let's define theircartesian product$$$T_1 \\\\times T_2$$$ in a following way.Let $$$V$$$ be the set of vertices in $$$T_1$$$ and $$$U$$$ be the set of vertices in $$$T_2$$$.Then the set of vertices of graph $$$T_1 \\\\times T_2$$$ is $$$V \\\\times U$$$, that is, a set of ordered pairs of vertices, where the first vertex in pair is from $$$V$$$ and the second — from $$$U$$$.Let's draw the following edges:Between $$$(v, u_1)$$$ and $$$(v, u_2)$$$ there is an undirected edge, if $$$u_1$$$ and $$$u_2$$$ are adjacent in $$$U$$$.Similarly, between $$$(v_1, u)$$$ and $$$(v_2, u)$$$ there is an undirected edge, if $$$v_1$$$ and $$$v_2$$$ are adjacent in $$$V$$$.Please see the notes section for the pictures of products of trees in the sample tests.Let's examine the graph $$$T_1 \\\\times T_2$$$. How much cycles (not necessarily simple) of length $$$k$$$ it contains? Since this number can be very large, print it modulo $$$998244353$$$.The sequence of vertices $$$w_1$$$, $$$w_2$$$, ..., $$$w_k$$$, where $$$w_i \\\\in V \\\\times U$$$ called cycle, if any neighboring vertices are adjacent and $$$w_1$$$ is adjacent to $$$w_k$$$. Cycles that differ only by the cyclic shift or direction of traversal are still considereddifferent.InputFirst line of input contains three integers — $$$n_1$$$, $$$n_2$$$ and $$$k$$$ ($$$2 \\\\le n_1, n_2 \\\\le 4000$$$, $$$2 \\\\le k \\\\le 75$$$) — number of vertices in the first tree, number of vertices in the second tree and the cycle length respectively.Then follow $$$n_1 - 1$$$ lines describing the first tree. Each of this lines contains two integers — $$$v_i, u_i$$$ ($$$1 \\\\le v_i, u_i \\\\le n_1$$$), which define edges of the first tree.Then follow $$$n_2 - 1$$$ lines, which describe the second tree in the same format.It is guaranteed, that given graphs are trees.OutputPrint one integer — number of cycles modulo $$$998244353$$$.ExamplesInput2 2 21 21 2Output8Input2 2 41 21 2Output32Input2 3 41 21 21 3Output70Input4 2 21 21 31 41 2Output20NoteThe following three pictures illustrate graph, which are products of the trees from sample tests.In the first example, the list of cycles of length $$$2$$$ is as follows:«AB», «BA»«BC», «CB»«AD», «DA»«CD», «DC»", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "0c190817", "template_md5": "35d339e4", "result": "You are given two trees, $T_1$ with $n_1$ vertices and $T_2$ with $n_2$ vertices.  The Cartesian product of these trees, $T_1 \\times T_2$, is a new tree formed as follows:\n\n* The vertices of $T_1 \\times T_2$ are all pairs of vertices, one from $T_1$ and one from $T_2$.\n* There is an edge between two vertices $(v_1, u_1)$ and $(v_2, u_2)$ in $T_1 \\times T_2$ if either:\n    * $u_1$ and $u_2$ are adjacent in $T_2$ \n    * $v_1$ and $v_2$ are adjacent in $T_1$\n\nFind the number of cycles of length $k$ in the tree $T_1 \\times T_2$.  Since this number can be large, print it modulo 998244353.\n\n\n\nThe input will consist of:\n\n* $n_1$, $n_2$, and $k$ (the number of vertices in each tree and the desired cycle length).\n* $n_1-1$ lines describing the edges of $T_1$.\n* $n_2-1$ lines describing the edges of $T_2$. \n\n\n\nOutput a single integer representing the number of cycles of length $k$ modulo 998244353."}, {"prompt_md5": "254e96e3", "template_md5": "465699a0", "result": "You are given two trees.  Find the number of cycles of a specific length in their Cartesian product. The Cartesian product of two trees is a new tree formed by combining all possible pairs of vertices from the original trees.  Print the answer modulo 998244353."}]}