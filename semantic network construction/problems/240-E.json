{"uid": "240-E", "url": "https://codeforces.com/contest/240/problem/E", "tags": ["dfs and similar", " graphs", " greedy"], "title": "240-E", "statement": "E. Road Repairstime limit per test2 secondsmemory limit per test256 megabytesinputinput.txtoutputoutput.txtA country named Berland hasncities. They are numbered with integers from1ton. City with index1is the capital of the country. Some pairs of cities have monodirectional roads built between them. However, not all of them are in good condition. For each road we know whether it needs repairing or not. If a road needs repairing, then it is forbidden to use it. However, the Berland government can repair the road so that it can be used.Right now Berland is being threatened by the war with the neighbouring state. So the capital officials decided to send a military squad to each city. The squads can move only along the existing roads, as there's no time or money to build new roads. However, some roads will probably have to be repaired in order to get to some cities.Of course the country needs much resources to defeat the enemy, so you want to be careful with what you're going to throw the forces on. That's why the Berland government wants to repair the minimum number of roads that is enough for the military troops to get to any city from the capital, driving along good or repaired roads. Your task is to help the Berland government and to find out, which roads need to be repaired.InputThe first line contains two space-separated integersnandm(1 ≤n,m≤ 105)— the number of cities and the number of roads in Berland.Nextmlines contain three space-separated integersai,bi,ci(1 ≤ai,bi≤n,ai≠bi, 0 ≤ci≤ 1), describing the road from cityaito citybi. Ifciequals0, than the given road is in a good condition. Ifciequals1, then it needs to be repaired.It is guaranteed that there is not more than one road between the cities in each direction.OutputIf even after all roads are repaired, it is still impossible to get to some city from the capital, print- 1. Otherwise, on the first line print the minimum number of roads that need to be repaired, and on the second line print the numbers of these roads, separated by single spaces.The roads are numbered starting from1in the order, in which they are given in the input.If there are multiple sets, consisting of the minimum number of roads to repair to make travelling to any city from the capital possible, print any of them.If it is possible to reach any city, driving along the roads that already are in a good condition, print0in the only output line.ExamplesInput3 21 3 03 2 1Output12Input4 42 3 03 4 04 1 04 2 1Output-1Input4 31 2 01 3 01 4 0Output0", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "3df3dc4b", "template_md5": "35d339e4", "result": "There are $n$ cities and $m$ roads connecting them. Each road connects two cities and can be either in good condition (cost 0 to travel) or need repair (cost 1 to travel).  You need to find the minimum number of roads to repair so that you can travel from city 1 (the capital) to any other city. \n\n**Input:**\n\n* The first line contains two integers, $n$ and $m$, the number of cities and roads.\n* The next $m$ lines each contain three integers, $a$, $b$, and $c$, representing a road from city $a$ to city $b$. If $c$ is 0, the road is in good condition. If $c$ is 1, the road needs repair.\n\n**Output:**\n\n* If it's impossible to reach all cities from the capital even after repairing all roads, print -1.\n* Otherwise, print the minimum number of roads to repair on the first line.\n* On the second line, print the numbers of those roads, separated by spaces."}, {"prompt_md5": "4e85aecf", "template_md5": "465699a0", "result": "You are given a map with cities connected by roads. Some roads are in good condition, while others need repair.  You need to figure out the minimum number of roads to repair so that you can travel from a starting city to every other city on the map."}]}