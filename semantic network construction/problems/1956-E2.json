{"uid": "1956-E2", "url": "https://codeforces.com/contest/1956/problem/E2", "tags": ["brute force", " greedy", " implementation", " math"], "title": "1956-E2", "statement": "E2. Nene vs. Monsters (Hard Version)time limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputThis is the hard version of the problem. The only difference between the versions is the constraints on $$$a_i$$$. You can make hacks only if both versions of the problem are solved.Nene is fighting with $$$n$$$ monsters, located in a circle. These monsters are numbered from $$$1$$$ to $$$n$$$, and the $$$i$$$-th ($$$1 \\\\le i \\\\le n$$$) monster's current energy level is $$$a_i$$$.Since the monsters are too strong, Nene decided to fight with them using theAttack Your Neighbourspell. When Nene uses this spell, the following actions happen in the following orderone by one:The $$$1$$$-st monster attacks the $$$2$$$-nd monster;The $$$2$$$-nd monster attacks the $$$3$$$-rd monster;$$$\\\\ldots$$$The $$$(n-1)$$$-th monster attacks the $$$n$$$-th monster;The $$$n$$$-th monster attacks the $$$1$$$-st monster.When the monster with energy level $$$x$$$ attacks the monster with the energy level $$$y$$$, the energy level of the defending monster becomes $$$\\\\max(0, y-x)$$$ (the energy level of the attacking monster remains equal to $$$x$$$).Nene is going to use this spell $$$10^{100}$$$ times and deal with the monsters that will still have a non-zero energy level herself. She wants you to determine which monsters will have a non-zero energy level once she will use the described spell $$$10^{100}$$$ times.InputEach test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \\\\le t \\\\le 10^4$$$). The description of test cases follows.The first line contains a single integer $$$n$$$ ($$$2 \\\\le n \\\\le 2 \\\\cdot 10^5$$$) — the number of monsters.The second line contains $$$n$$$ integers $$$a_1, a_2, \\\\ldots, a_n$$$ ($$$0 \\\\le a_i \\\\le 10^9$$$) — the current energy levels of monsters.It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$2 \\\\cdot 10^5$$$.OutputFor each test case,in the first line output an integer $$$m$$$ — the number of monsters with non-zero energy level after $$$10^{100}$$$ uses of the spell;in the second line of output $$$m$$$ integers $$$i_1,i_2,\\\\ldots,i_m$$$ ($$$1 \\\\le i_1 < i_2 < \\\\ldots < i_m \\\\le n$$$) — the indices of these monsters in the increasing order.If $$$m=0$$$, you may either output an empty line or don't output it.ExampleInput532 5 320 041 5 7 244 2 1 2131 1 4 5 1 4 1 9 1 9 8 1 0Output1 1  0  1 1  2 1 3  6 1 3 6 8 10 12NoteIn the first test case, the following actions happen during the first $$$3$$$ uses of the spell in this order:Nene uses theAttack Your Neighbourspell for the first time;the $$$1$$$-st monster attacks the $$$2$$$-nd monster, after the attack the energy level of the $$$2$$$-nd monster becomes equal to $$$\\\\max(0, 5-2)=3$$$;the $$$2$$$-nd monster attacks the $$$3$$$-rd monster, after the attack the energy level of the $$$3$$$-rd monster becomes equal to $$$\\\\max(0, 3-3)=0$$$;the $$$3$$$-rd monster attacks the $$$1$$$-st monster, after the attack the energy level of the $$$1$$$-st monster becomes equal to $$$\\\\max(0, 2-0)=2$$$;Nene uses theAttack Your Neighbourspell for the second time;the $$$1$$$-st monster attacks the $$$2$$$-nd monster, after the attack the energy level of the $$$2$$$-nd monster becomes equal to $$$\\\\max(0, 3-2)=1$$$;the $$$2$$$-nd monster attacks the $$$3$$$-rd monster, after the attack the energy level of the $$$3$$$-rd monster becomes equal to $$$\\\\max(0, 0-1)=0$$$;the $$$3$$$-rd monster attacks the $$$1$$$-st monster, after the attack the energy level of the $$$1$$$-st monster becomes equal to $$$\\\\max(0, 2-0)=2$$$;Nene uses theAttack Your Neighbourspell for the third time;the $$$1$$$-st monster attacks the $$$2$$$-nd monster, after the attack the energy level of the $$$2$$$-nd monster becomes equal to $$$\\\\max(0, 1-2)=0$$$;the $$$2$$$-nd monster attacks the $$$3$$$-rd monster, after the attack the energy level of the $$$3$$$-rd monster becomes equal to $$$\\\\max(0, 0-0)=0$$$;the $$$3$$$-rd monster attacks the $$$1$$$-st monster, after the attack the energy level of the $$$1$$$-st monster becomes equal to $$$\\\\max(0, 2-0)=2$$$.After each of the next uses of the spell, energy levels of monsters do not change. Thus, only the $$$1$$$-st monster has a non-zero energy level in the end.In the second test case, both monsters initially have zero energy level.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "11faf438", "template_md5": "35d339e4", "result": "You are given an array of $n$ integers, $a_1, a_2, ..., a_n$, representing the energy levels of $n$ monsters in a circle.  \n\nThe monsters attack each other in a circular fashion.  Each attack reduces the target monster's energy to the maximum of 0 and the difference between the attacker's energy and the target's energy.  The attacker's energy remains the same.\n\nThis attack pattern repeats for a very large number of times ($10^{100}$).\n\nDetermine which monsters will have a non-zero energy level after all the attacks are complete. Output the number of such monsters and their indices."}, {"prompt_md5": "6a6a4b6d", "template_md5": "465699a0", "result": "You are given a list of numbers representing the energy levels of monsters in a circle.  The monsters attack their neighbors in a cycle repeatedly.  Each attack reduces the target's energy to the maximum of 0 and the difference between the attacker's energy and the target's energy.  The attacker's energy remains the same.  \n\nDetermine which monsters will have energy remaining after a very large number of attacks."}]}