{"uid": "1699-E", "url": "https://codeforces.com/contest/1699/problem/E", "tags": ["data structures", " dp", " greedy", " math", " number theory", " two pointers"], "title": "1699-E", "statement": "E. Three Days Gracetime limit per test4 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputIbti was thinking about a good title for this problem that would fit the round theme (numerus ternarium). He immediately thought about the third derivative, but that was pretty lame so he decided to include the best band in the world —Three Days Grace.You are given a multiset $$$A$$$ with initial size $$$n$$$, whose elements are integers between $$$1$$$ and $$$m$$$. In one operation, do the following:select a value $$$x$$$ from the multiset $$$A$$$, thenselect two integers $$$p$$$ and $$$q$$$ such that $$$p, q > 1$$$ and $$$p \\\\cdot q = x$$$. Insert $$$p$$$ and $$$q$$$ to $$$A$$$, delete $$$x$$$ from $$$A$$$.Note that the size of the multiset $$$A$$$ increases by $$$1$$$ after each operation.We define the balance of the multiset $$$A$$$ as $$$\\\\max(a_i) - \\\\min(a_i)$$$. Find the minimum possible balance after performing any number (possible zero) of operations.InputThe first line of the input contains a single integer $$$t$$$ ($$$1 \\\\le t \\\\le 10^5$$$) — the number of test cases.The second line of each test case contains two integers $$$n$$$ and $$$m$$$ ($$$1 \\\\le n \\\\le 10^6$$$, $$$1 \\\\le m \\\\le 5 \\\\cdot 10^6$$$) — the initial size of the multiset, and the maximum value of an element.The third line of each test case contains $$$n$$$ integers $$$a_1, a_2, \\\\ldots, a_n$$$ ($$$1 \\\\le a_i \\\\le m$$$) — the elements in the initial multiset.It is guaranteed that the sum of $$$n$$$ across all test cases does not exceed $$$10^6$$$ and the sum of $$$m$$$ across all test cases does not exceed $$$5 \\\\cdot 10^6$$$.OutputFor each test case, print a single integer — the minimum possible balance.ExampleInput45 102 4 2 4 23 5012 2 32 406 352 51 5Output0 1 2 4NoteIn the first test case, we can apply the operation on each of the $$$4$$$s with $$$(p,q) = (2,2)$$$ and make the multiset $$$\\\\{2,2,2,2,2,2,2\\\\}$$$ with balance $$$\\\\max(\\\\{2,2,2,2,2,2,2\\\\}) - \\\\min(\\\\{2,2,2,2,2,2,2\\\\}) = 0$$$. It is obvious we cannot make this balance less than $$$0$$$.In the second test case, we can apply an operation on $$$12$$$ with $$$(p,q) = (3,4)$$$. After this our multiset will be $$$\\\\{3,4,2,3\\\\}$$$. We can make one more operation on $$$4$$$ with $$$(p,q) = (2,2)$$$, making the multiset $$$\\\\{3,2,2,2,3\\\\}$$$ with balance equal to $$$1$$$.In the third test case, we can apply an operation on $$$35$$$ with $$$(p,q) = (5,7)$$$. The final multiset is $$$\\\\{6,5,7\\\\}$$$ and has a balance equal to $$$7-5 = 2$$$.In the forth test case, we cannot apply any operation, so the balance is $$$5 - 1 = 4$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "e4283a7a", "template_md5": "35d339e4", "result": "You are given a set of integers $A$ with $n$ elements, where each element is between 1 and $m$.  You can perform the following operation any number of times:\n\n1. Choose an element $x$ from the set $A$.\n2. Find two integers $p$ and $q$ such that $p, q > 1$ and $p \\cdot q = x$.\n3. Add $p$ and $q$ to the set $A$.\n4. Remove $x$ from the set $A$.\n\nThe size of the set $A$ increases by 1 after each operation.\n\nThe balance of the set $A$ is defined as the difference between the maximum and minimum elements in the set:  $\\max(a_i) - \\min(a_i)$.\n\nFind the minimum possible balance of the set $A$ after performing any number of operations.\n\n\n\nInput:\n\n* The first line contains the number of test cases $t$.\n* For each test case:\n    * The second line contains two integers $n$ and $m$, the initial size of the set and the maximum value of an element.\n    * The third line contains $n$ integers, the elements of the initial set.\n\nOutput:\n\nFor each test case, print the minimum possible balance."}, {"prompt_md5": "6f8536a0", "template_md5": "465699a0", "result": "You have a set of numbers. You can repeatedly choose a number from the set and split it into two smaller numbers, adding those two smaller numbers to the set while removing the original number. What is the smallest possible difference between the largest and smallest numbers in the set after you can perform this operation any number of times?"}]}