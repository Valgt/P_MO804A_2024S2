{"uid": "362-D", "url": "https://codeforces.com/contest/362/problem/D", "tags": ["data structures", " dfs and similar", " dsu", " graphs", " greedy"], "title": "362-D", "statement": "D. Fools and Foolproof Roadstime limit per test1 secondmemory limit per test256 megabytesinputstdinoutputstdoutYou must have heard all about the Foolland on your Geography lessons. Specifically, you must know that federal structure of this country has been the same for many centuries. The country consists ofncities, some pairs of cities are connected by bidirectional roads, each road is described by its lengthli.The fools lived in their land joyfully, but a recent revolution changed the king. Now the king is Vasily the Bear. Vasily divided the country cities into regions, so that any two cities of the same region have a path along the roads between them and any two cities of different regions don't have such path. Then Vasily decided to upgrade the road network and construct exactlypnew roads in the country. Constructing a road goes like this:We choose a pair ofdistinctcitiesu,vthat will be connected by a new road (at that, it is possible that there already is a road between these cities).We define the length of the new road: if citiesu,vbelong to distinct regions, then the length is calculated asmin(109,S+ 1)(S— the total length of all roads that exist in the linked regions), otherwise we assume that the length equals1000.We build a road of the specified length between the chosen cities. If the new road connects two distinct regions, after construction of the road these regions are combined into one new region.Vasily wants the road constructing process to result in the country that consists exactly ofqregions. Your task is to come up with such road constructing plan for Vasily that it meets the requirement and minimizes the total length of the built roads.InputThe first line contains four integersn(1 ≤n≤ 105),m(0 ≤m≤ 105),p(0 ≤p≤ 105),q(1 ≤q≤n) — the number of cities in the Foolland, the number of existing roads, the number of roads that are planned to construct and the required number of regions.Nextmlines describe the roads that exist by the moment upgrading of the roads begun. Each of these lines contains three integersxi,yi,li:xi,yi— the numbers of the cities connected by this road (1 ≤xi,yi≤n,xi≠yi),li— length of the road (1 ≤li≤ 109). Note that one pair of cities can be connected with multiple roads.OutputIf constructing the roads in the required way is impossible, print a single string \"NO\" (without the quotes). Otherwise, in the first line print word \"YES\" (without the quotes), and in the nextplines print the road construction plan. Each line of the plan must consist of two distinct integers, giving the numbers of the cities connected by a road. The road must occur in the plan in the order they need to be constructed. If there are multiple optimal solutions, you can print any of them.ExamplesInput9 6 2 21 2 23 2 14 6 201 3 87 8 35 7 2OutputYES9 51 9Input2 0 1 2OutputNOInput2 0 0 2OutputYESNoteConsider the first sample. Before the reform the Foolland consists of four regions. The first region includes cities1,2,3, the second region has cities4and6, the third region has cities5,7,8, the fourth region has city9. The total length of the roads in these cities is11,20,5and0, correspondingly. According to the plan, we first build the road of length6between cities5and9, then the road of length23between cities1and9. Thus, the total length of the built roads equals29.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "abcad88f", "template_md5": "35d339e4", "result": "You are given a country with $n$ cities and $m$ existing roads connecting them. Each road has a length $l_i$. The goal is to construct $p$ new roads to divide the country into exactly $q$ regions. \n\nHere are the rules for constructing roads:\n\n*  Two cities belong to the same region if there is a path between them using existing and newly constructed roads.\n*  The length of a new road between cities $u$ and $v$ is:\n    *  $\\min(10^9, S + 1)$ if cities $u$ and $v$ belong to different regions, where $S$ is the total length of all roads in the regions containing $u$ and $v$.\n    *  $1000$ if cities $u$ and $v$ belong to the same region.\n\nDetermine if it is possible to construct the roads in a way that meets the requirements and find a plan that minimizes the total length of the built roads. If it is impossible, output \"NO\". Otherwise, output \"YES\" followed by a list of the cities to be connected by each new road, in the order they should be built."}, {"prompt_md5": "ac14a185", "template_md5": "465699a0", "result": "You are given a map with cities connected by roads of varying lengths. You need to build new roads to divide the cities into a specific number of regions, where cities within a region can reach each other, but cities in different regions cannot.  The cost of building a road depends on whether it connects cities in the same or different regions. Find the cheapest way to build the required number of roads to achieve the desired regional division. If it's impossible, say so."}]}