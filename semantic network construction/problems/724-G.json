{"uid": "724-G", "url": "https://codeforces.com/contest/724/problem/G", "tags": ["bitmasks", " graphs", " math", " number theory", " trees"], "title": "724-G", "statement": "G. Xor-matic Number of the Graphtime limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputYou are given an undirected graph, constisting ofnvertices andmedges. Each edge of the graph has some non-negative integer written on it.Let's call a triple(u,v,s)interesting, if1 ≤u<v≤nand there is a path (possibly non-simple, i.e. it can visit the same vertices and edges multiple times) between verticesuandvsuch that xor of all numbers written on the edges of this path is equal tos.When we compute the value s for some path, each edge is counted in xor as many times, as it appear on this path.It's not hard to prove that there are finite number of such triples.Calculate the sum over modulo109+ 7of the values ofsover allinterestingtriples.InputThe first line of the input contains two integersnandm(1 ≤n≤ 100 000,0 ≤m≤ 200 000) — numbers of vertices and edges in the given graph.The followmlines contain three integersui,viandti(1 ≤ui,vi≤n,0 ≤ti≤ 1018,ui≠vi) — vertices connected by the edge and integer written on it. It is guaranteed that graph doesn't contain self-loops and multiple edges.OutputPrint the single integer, equal to the described sum over modulo109+ 7.ExamplesInput4 41 2 11 3 22 3 33 4 1Output12Input4 41 2 12 3 23 4 44 1 8Output90Input8 61 2 22 3 12 4 44 5 54 6 37 8 5Output62NoteIn the first example the are6interesting triples:(1, 2, 1)(1, 3, 2)(1, 4, 3)(2, 3, 3)(2, 4, 2)(3, 4, 1)The sum is equal to1 + 2 + 3 + 3 + 2 + 1 = 12.In the second example the are12interesting triples:(1, 2, 1)(2, 3, 2)(1, 3, 3)(3, 4, 4)(2, 4, 6)(1, 4, 7)(1, 4, 8)(2, 4, 9)(3, 4, 11)(1, 3, 12)(2, 3, 13)(1, 2, 14)The sum is equal to1 + 2 + 3 + 4 + 6 + 7 + 8 + 9 + 11 + 12 + 13 + 14 = 90.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "3880cd11", "template_md5": "35d339e4", "result": "You are given a graph with $n$ vertices and $m$ edges. Each edge has a non-negative integer written on it.  \n\nAn interesting triple $(u, v, s)$ is defined as follows:\n\n* $1 \\le u < v \\le n$ \n* There is a path (which can visit vertices and edges multiple times) between vertices $u$ and $v$.\n* The XOR of all the numbers on the edges of this path is equal to $s$.\n\nCalculate the sum of all possible values of $s$ for all interesting triples, modulo $10^9 + 7$.\n\n\n\nLet me know if you'd like me to elaborate on any part of the problem statement."}, {"prompt_md5": "d1eab649", "template_md5": "465699a0", "result": "You are given a graph with nodes and edges. Each edge has a number on it.  Find the sum of all possible numbers you can get by adding up the numbers on paths between pairs of nodes.  The sum is calculated modulo 10^9 + 7."}]}