{"uid": "1585-E", "url": "https://codeforces.com/contest/1585/problem/E", "tags": ["data structures", " dfs and similar", " trees"], "title": "1585-E", "statement": "E. Frequency Queriestime limit per test4 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputPetya has a rooted tree with an integer written on each vertex. The vertex $$$1$$$ is the root. You are to answer some questions about the tree.A tree is a connected graph without cycles. A rooted tree has a special vertex called the root. The parent of a node $$$v$$$ is the next vertex on the shortest path from $$$v$$$ to the root.Each question is defined by three integers $$$v$$$, $$$l$$$, and $$$k$$$. To get the answer to the question, you need to perform the following steps:First, write down the sequence of all integers written on the shortest path from the vertex $$$v$$$ to the root (including those written in the $$$v$$$ and the root).Count the number of times each integer occurs. Remove all integers with less than $$$l$$$ occurrences.Replace the sequence, removing all duplicates and ordering the elements by the number of occurrences in the original list in increasing order. In case of a tie, you can choose the order of these elements arbitrary.The answer to the question is the $$$k$$$-th number in the remaining sequence. Note that the answer is not always uniquely determined, because there could be several orderings. Also, it is possible that the length of the sequence on this step is less than $$$k$$$, in this case the answer is $$$-1$$$.For example, if the sequence of integers on the path from $$$v$$$ to the root is $$$[2, 2, 1, 7, 1, 1, 4, 4, 4, 4]$$$, $$$l = 2$$$ and $$$k = 2$$$, then the answer is $$$1$$$.Please answer all questions about the tree.InputEach test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \\\\leq t \\\\leq 10^6$$$). Description of the test cases follows.The first line of each test case contains two integers $$$n$$$, $$$q$$$ ($$$1 \\\\leq n, q \\\\leq 10^6$$$) — the number of vertices in the tree and the number of questions.The second line contains $$$n$$$ integers $$$a_1, a_2, \\\\ldots, a_n$$$ ($$$1 \\\\leq a_i \\\\leq n$$$), where $$$a_i$$$ is the number written on the $$$i$$$-th vertex.The third line contains $$$n-1$$$ integers $$$p_2, p_3, \\\\ldots, p_n$$$ ($$$1 \\\\leq p_i \\\\leq n$$$), where $$$p_i$$$ is the parent of node $$$i$$$. It's guaranteed that the values $$$p$$$ define a correct tree.Each of the next $$$q$$$ lines contains three integers $$$v$$$, $$$l$$$, $$$k$$$ ($$$1 \\\\leq v, l, k \\\\leq n$$$) — descriptions of questions.It is guaranteed that the sum of $$$n$$$ and the sum of $$$q$$$ over all test cases do not exceed $$$10^6$$$.OutputFor each question of each test case print the answer to the question. In case of multiple answers, print any.ExampleInput2 3 3 1 1 1 1 2 3 1 1 3 1 2 3 2 1 5 5 1 2 1 1 2 1 1 2 2 3 1 1 2 1 2 4 1 1 4 2 1 4 2 2Output1 -1 1  1 1 2 1 -1", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "e38202b8", "template_md5": "465699a0", "result": "You are given a tree (a connected graph with no cycles) where each node has a number.  You need to answer queries about the numbers on paths from a given node to the root of the tree. \n\nFor each query, you:\n\n1. List the numbers on the path from the given node to the root.\n2. Count how many times each number appears.\n3. Remove numbers that appear fewer than a specified number of times.\n4. Order the remaining numbers by their count (lowest count first), and in case of ties, the order doesn't matter.\n5. The answer to the query is the k-th number in the ordered list. If there are fewer than k numbers left, the answer is -1."}, {"prompt_md5": "b78a53cb", "template_md5": "35d339e4", "result": "You are given a tree with $n$ vertices, where each vertex has an integer value.  You need to answer $q$ queries.\n\nEach query is defined by three integers $v$, $l$, and $k$.  For each query:\n\n1.  Find the shortest path from vertex $v$ to the root of the tree.\n2.  Count the occurrences of each integer on this path.\n3.  Remove any integers that appear fewer than $l$ times.\n4.  Order the remaining integers by their frequency (from least to greatest). If two integers have the same frequency, their order is arbitrary.\n5.  The answer to the query is the $k$-th integer in the ordered list. If there are fewer than $k$ integers remaining, the answer is $-1$.\n\n\n\nProvide the answer to each query."}]}