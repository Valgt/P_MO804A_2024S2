{"uid": "1017-H", "url": "https://codeforces.com/contest/1017/problem/H", "tags": ["brute force"], "title": "1017-H", "statement": "H. The Filmstime limit per test5 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputIn \"The Man in the High Castle\" world, there are $$$m$$$ different film endings.Abendsen owns a storage and a shelf. At first, he has $$$n$$$ ordered films on the shelf. In the $$$i$$$-th month he will do:Empty the storage.Put $$$k_i \\\\cdot m$$$ films into the storage, $$$k_i$$$ films for each ending.He will think about a question: if he puts all the films from the shelf into the storage, then randomly picks $$$n$$$ films (from all the films in the storage) and rearranges them on the shelf, what is the probability that sequence of endings in $$$[l_i, r_i]$$$ on the shelf will not be changed? Notice, he just thinks about this question, so the shelf will not actually be changed.Answer all Abendsen's questions.Let the probability be fraction $$$P_i$$$. Let's say that the total number of ways to take $$$n$$$ films from the storage for $$$i$$$-th month is $$$A_i$$$, so $$$P_i \\\\cdot A_i$$$ is always an integer. Print for each month $$$P_i \\\\cdot A_i \\\\pmod {998244353}$$$.$$$998244353$$$ is a prime number and it is equal to $$$119 \\\\cdot 2^{23} + 1$$$.It is guaranteed that there will be only no more than $$$100$$$ different $$$k$$$ values.InputThe first line contains three integers $$$n$$$, $$$m$$$, and $$$q$$$ ($$$1 \\\\le n, m, q \\\\le 10^5$$$, $$$n+q\\\\leq 10^5$$$) — the number of films on the shelf initially, the number of endings, and the number of months.The second line contains $$$n$$$ integers $$$e_1, e_2, \\\\ldots, e_n$$$ ($$$1\\\\leq e_i\\\\leq m$$$) — the ending of the $$$i$$$-th film on the shelf.Each of the next $$$q$$$ lines contains three integers $$$l_i$$$, $$$r_i$$$, and $$$k_i$$$ ($$$1 \\\\le l_i \\\\le r_i \\\\le n, 0 \\\\le k_i \\\\le 10^5$$$) — the $$$i$$$-th query.It is guaranteed that there will be only no more than $$$100$$$ different $$$k$$$ values.OutputPrint the answer for each question in a separate line.ExamplesInput6 4 41 2 3 4 4 41 4 01 3 21 4 21 5 2Output626730121504860Input5 5 31 2 3 4 51 2 1000001 4 43 5 5Output49494221813125151632NoteIn the first sample in the second query, after adding $$$2 \\\\cdot m$$$ films into the storage, the storage will look like this: $$$\\\\{1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 4, 4\\\\}$$$.There are $$$26730$$$ total ways of choosing the films so that $$$e_l, e_{l+1}, \\\\ldots, e_r$$$ will not be changed, for example, $$$[1, 2, 3, 2, 2]$$$ and $$$[1, 2, 3, 4, 3]$$$ are such ways.There are $$$2162160$$$ total ways of choosing the films, so you're asked to print $$$(\\\\frac{26730}{2162160} \\\\cdot 2162160) \\\\mod 998244353 = 26730$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "09c4ae99", "template_md5": "35d339e4", "result": "There are $n$ films on a shelf, each with an ending numbered from 1 to $m$.  Each month, the following happens:\n\n1. All films are removed from the shelf.\n2. $k_i \\cdot m$ new films are added to a storage, with $k_i$ films for each ending.\n\nFor each month $i$, you are asked to find the probability that if $n$ films are randomly chosen from the storage and placed back on the shelf, the order of the endings in the range $[l_i, r_i]$ on the shelf will remain the same.\n\n**Input:**\n\n* $n$: the number of films on the shelf initially\n* $m$: the number of possible film endings\n* $q$: the number of months\n* $e_1, e_2, ..., e_n$: the ending of each film on the shelf\n* $l_i$, $r_i$, $k_i$: for each month $i$, the range of films to check and the number of new films added\n\n**Output:**\n\nFor each month $i$, print the probability multiplied by the total number of ways to choose $n$ films from the storage, all modulo 998244353."}, {"prompt_md5": "710dc76f", "template_md5": "465699a0", "result": "You have a shelf with a certain number of items. Each month, you add a multiple of a given number of new items to a storage. You then randomly select a set of items from the storage to put back on the shelf.  For each month, calculate the probability that a specific range of items on the shelf will remain in the same order after this process."}]}