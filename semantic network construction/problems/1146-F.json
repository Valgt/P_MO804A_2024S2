{"uid": "1146-F", "url": "https://codeforces.com/contest/1146/problem/F", "tags": ["dp", " trees"], "title": "1146-F", "statement": "F. Leaf Partitiontime limit per test1 secondmemory limit per test256 megabytesinputstandard inputoutputstandard outputYou are given a rooted tree with $$$n$$$ nodes, labeled from $$$1$$$ to $$$n$$$. The tree is rooted at node $$$1$$$. The parent of the $$$i$$$-th node is $$$p_i$$$. A leaf is node with no children. For a given set of leaves $$$L$$$, let $$$f(L)$$$ denote the smallest connected subgraph that contains all leaves $$$L$$$.You would like to partition the leaves such that for any two different sets $$$x, y$$$ of the partition, $$$f(x)$$$ and $$$f(y)$$$ are disjoint.Count the number of ways to partition the leaves, modulo $$$998244353$$$. Two ways are different if there are two leaves such that they are in the same set in one way but in different sets in the other.InputThe first line contains an integer $$$n$$$ ($$$2 \\\\leq n \\\\leq 200\\\\,000$$$) — the number of nodes in the tree.The next line contains $$$n-1$$$ integers $$$p_2, p_3, \\\\ldots, p_n$$$ ($$$1 \\\\leq p_i < i$$$).OutputPrint a single integer, the number of ways to partition the leaves, modulo $$$998244353$$$.ExamplesInput5 1 1 1 1Output12Input10 1 2 3 4 5 6 7 8 9Output1NoteIn the first example, the leaf nodes are $$$2,3,4,5$$$. The ways to partition the leaves are in the following imageIn the second example, the only leaf is node $$$10$$$ so there is only one partition. Note that node $$$1$$$ is not a leaf.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "785e85fb", "template_md5": "35d339e4", "result": "You are given a tree with $n$ nodes, labeled from 1 to $n$. The parent of the $i$-th node is $p_i$. A leaf is a node with no children. \n\nYou need to divide the leaf nodes into groups.  The groups must be such that no two groups share any nodes in the tree.\n\nFind the number of ways to divide the leaf nodes into these groups, and output the result modulo 998244353."}, {"prompt_md5": "feb5999c", "template_md5": "465699a0", "result": "You have a tree with numbered nodes.  Some nodes are leaves (nodes with no children).  You need to divide the leaves into groups so that no two groups share any connected nodes within the tree.  Count how many ways you can do this."}]}