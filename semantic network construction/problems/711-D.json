{"uid": "711-D", "url": "https://codeforces.com/contest/711/problem/D", "tags": ["combinatorics", " dfs and similar", " graphs", " math"], "title": "711-D", "statement": "D. Directed Roadstime limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputZS the Coder and Chris the Baboon has explored Udayland for quite some time. They realize that it consists ofntowns numbered from1ton.There arendirected roads in the Udayland.i-th of them goes from townito some other townai(ai≠i). ZS the Coder can flip the direction of any road in Udayland, i.e. if it goes from townAto townBbefore the flip, it will go from townBto townAafter.ZS the Coder considers the roads in the Udaylandconfusing, if there is a sequence of distinct townsA1,A2, ...,Ak(k> 1) such that for every1 ≤i<kthere is a road from townAito townAi+ 1and another road from townAkto townA1. In other words, the roads are confusing ifsome of themform a directed cycle of some towns.Now ZS the Coder wonders how many sets of roads (there are2nvariants) in initial configuration can he choose to flip such that after flipping each road in the set exactly once, the resulting network willnotbe confusing.Note that it is allowed that after the flipping there are more than one directed road from some town and possibly some towns with no roads leading out of it, or multiple roads between any pair of cities.InputThe first line of the input contains single integern(2 ≤n≤ 2·105) — the number of towns in Udayland.The next line containsnintegersa1,a2, ...,an(1 ≤ai≤n,ai≠i),aidenotes a road going from townito townai.OutputPrint a single integer — the number of ways to flip some set of the roads so that the resulting whole set of all roads is not confusing. Since this number may be too large, print the answer modulo109+ 7.ExamplesInput32 3 1Output6Input42 1 1 1Output8Input52 4 2 5 3Output28NoteConsider the first sample case. There are3towns and3roads. The towns are numbered from1to3and the roads are,,initially. Number the roads1to3in this order.The sets of roads that ZS the Coder can flip (to make them not confusing) are{1}, {2}, {3}, {1, 2}, {1, 3}, {2, 3}. Note that the empty set is invalid because if no roads are flipped, then towns1, 2, 3is form a directed cycle, so it is confusing. Similarly, flipping all roads is confusing too. Thus, there are a total of6possible sets ZS the Coder can flip.The sample image shows all possible ways of orienting the roads from the first sample such that the network isnot confusing.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "53a0c162", "template_md5": "35d339e4", "result": "There are $n$ towns numbered from 1 to $n$. There are $n$ directed roads, the $i$-th road goes from town $i$ to town $a_i$ ($a_i \\neq i$). \n\nYou can flip the direction of any road.  A set of roads is confusing if there is a cycle of towns, meaning you can travel from a town back to itself by following a sequence of roads.\n\nFind the number of sets of roads you can flip so that the resulting network of roads is not confusing.  The answer should be modulo $10^9 + 7$."}, {"prompt_md5": "55bdd202", "template_md5": "465699a0", "result": "You are given a network of directed roads connecting towns.  You can flip the direction of any road.  Find the number of sets of roads you can flip so that the resulting network has no cycles."}]}