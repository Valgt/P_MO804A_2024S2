{"uid": "832-E", "url": "https://codeforces.com/contest/832/problem/E", "tags": ["matrices"], "title": "832-E", "statement": "E. Vasya and Shiftstime limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputVasya has a set of4nstrings of equal length, consisting of lowercase English letters \"a\", \"b\", \"c\", \"d\" and \"e\". Moreover, the set is split intongroups of4equal strings each. Vasya also has one special stringaof the same length, consisting of letters \"a\" only.Vasya wants to obtain from stringasome fixed stringb, in order to do this, he can use the strings from his set in any order. When he uses some stringx, each of the letters in stringareplaces with the next letter in alphabet as many times as the alphabet position, counting from zero, of the corresponding letter in stringx. Within this process the next letter in alphabet after \"e\" is \"a\".For example, if some letter inaequals \"b\", and the letter on the same position inxequals \"c\", then the letter inabecomes equal \"d\", because \"c\" is the second alphabet letter, counting from zero. If some letter inaequals \"e\", and on the same position inxis \"d\", then the letter inabecomes \"c\". For example, if the stringaequals \"abcde\", and stringxequals \"baddc\", thenabecomes \"bbabb\".A used string disappears, but Vasya can use equal strings several times.Vasya wants to know forqgiven stringsb, how many ways there are to obtain from the stringastringbusing the given set of4nstrings? Two ways are different if the number of strings used from some group of4strings is different. Help Vasya compute the answers for these questions modulo109+ 7.InputThe first line contains two integersnandm(1 ≤n,m≤ 500) — the number of groups of four strings in the set, and the length of all strings.Each of the nextnlines contains a stringsof lengthm, consisting of lowercase English letters \"a\", \"b\", \"c\", \"d\" and \"e\". This means that there is a group of four strings equal tos.The next line contains single integerq(1 ≤q≤ 300) — the number of stringsbVasya is interested in.Each of the nextqstrings contains a stringbof lengthm, consisting of lowercase English letters \"a\", \"b\", \"c\", \"d\" and \"e\" — a string Vasya is interested in.OutputFor each string Vasya is interested in print the number of ways to obtain it from stringa, modulo109+ 7.ExamplesInput1 1b2aeOutput11Input2 4aaaabbbb1ccccOutput5NoteIn the first example, we have4strings \"b\". Then we have the only way for each stringb: select0strings \"b\" to get \"a\" and select4strings \"b\" to get \"e\", respectively. So, we have1way for each request.In the second example, note that the choice of the string \"aaaa\" does not change anything, that is we can choose any amount of it (from0to4, it's5different ways) and we have to select the line \"bbbb\"2times, since other variants do not fit. We get that we have5ways for the request.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "9e0b3175", "template_md5": "35d339e4", "result": "You are given a set of $4n$ strings, each of length $m$, consisting of the letters \"a\", \"b\", \"c\", \"d\", and \"e\". The set is divided into $n$ groups of four strings each. You are also given a special string $a$ of length $m$, consisting only of the letter \"a\".\n\nYou want to transform string $a$ into a target string $b$ of length $m$ using the strings from the set.  Here's how the transformation works:\n\n1. Choose one string $x$ from the set.\n2. For each letter in string $a$, replace it with the next letter in the alphabet (wrapping around from \"e\" to \"a\"). The number of times you shift each letter is equal to the alphabet position (0-indexed) of the corresponding letter in string $x$.\n\nFor example, if $a = \"abcde\"$ and $x = \"baddc\"$, then after applying the transformation, $a$ becomes \"bbabb\".\n\nA used string is removed from the set. You can use the same string multiple times.\n\nYou are given $q$ target strings $b$. For each target string $b$, find the number of ways to transform string $a$ into it using the given set of strings, considering that using a different number of strings from each group of four is considered a different way.  The answer should be modulo $10^9 + 7$."}, {"prompt_md5": "79795252", "template_md5": "465699a0", "result": "You have a set of groups of four strings, each string is the same length. You also have a special string of the same length made up of only \"a\"s. You want to transform the special string into a target string using the strings from the set.  Each time you use a string from the set, each letter in the target string is shifted forward in the alphabet by the position of the corresponding letter in the used string.  The alphabet wraps around (e.g., \"e\" becomes \"a\").  \n\nYou can use the same string from the set multiple times.  \n\nGiven a target string, find how many ways you can transform the special string into it, considering that using a different number of strings from each group is considered a different way.  The answer should be modulo 10^9 + 7."}]}