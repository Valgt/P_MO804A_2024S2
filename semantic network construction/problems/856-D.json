{"uid": "856-D", "url": "https://codeforces.com/contest/856/problem/D", "tags": ["dp", " trees"], "title": "856-D", "statement": "D. Masha and Cactustime limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputMasha is fond of cacti. When she was a little girl, she decided to plant a tree. Now Masha wants to make a nice cactus out of her tree.Recall thattreeis a connected undirected graph that has no cycles.Cactusis a connected undirected graph such that each vertex belongs to at most one cycle.Masha has some additional edges that she can add to a tree. For each edge she knows which vertices it would connect and thebeautyof this edge. Masha can add some of these edges to the graph if the resulting graph is a cactus.Beautyof the resulting cactus is sum of beauties of all added edges.Help Masha find out what maximumbeautyof the resulting cactus she can achieve.InputThe first line of the input data contains two integersnandm— the number of vertices in a tree, and the number of additional edges available (3 ≤n≤ 2·105;0 ≤m≤ 2·105).Let us describe Masha's tree. It has a root at vertex 1. The second line containsn- 1integers:p2,p3, ...,pn, herepi— is the parent of a vertexi— the first vertex on a path from the vertexito the root of the tree (1 ≤pi<i).The followingmlines contain three integersui,viandci— pairs of vertices to be connected by the additional edges that Masha can add to the tree andbeautyof edge (1 ≤ui,vi≤n;ui≠vi;1 ≤ci≤ 104).It is guaranteed that no additional edge coincides with the edge of the tree.OutputOutput one integer — the maximumbeautyof a cactus Masha can achieve.ExampleInput7 31 1 2 2 3 34 5 16 7 12 3 1Output2", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "a36dbebd", "template_md5": "35d339e4", "result": "You are given a tree with $n$ vertices.  There are $m$ additional edges that can be added to the tree. Each additional edge connects two vertices and has a given beauty.  \n\nThe goal is to add some of these edges to the tree to create a cactus (a connected graph where each vertex is in at most one cycle). The beauty of the resulting cactus is the sum of the beauties of the added edges.\n\nFind the maximum beauty of a cactus that can be created. \n\n**Input:**\n\n* The first line contains two integers, $n$ and $m$, the number of vertices in the tree and the number of additional edges.\n* The second line contains $n-1$ integers, representing the parent of each vertex in the tree (vertex 1 is the root).\n* The following $m$ lines each contain three integers, $u$, $v$, and $c$, representing an additional edge that connects vertices $u$ and $v$ with beauty $c$.\n\n**Output:**\n\n* Output a single integer, the maximum beauty of a cactus that can be created."}, {"prompt_md5": "f5b00297", "template_md5": "465699a0", "result": "You are given a tree with a specific structure. You also have a set of edges that can be added to the tree.  Each edge has a weight.  The goal is to add some of these edges to the tree to create a cactus (a special type of graph) and find the maximum total weight of the added edges."}]}