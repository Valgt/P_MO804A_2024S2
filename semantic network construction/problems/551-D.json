{"uid": "551-D", "url": "https://codeforces.com/contest/551/problem/D", "tags": ["combinatorics", " implementation", " math", " matrices", " number theory"], "title": "551-D", "statement": "D. GukiZ and Binary Operationstime limit per test1 secondmemory limit per test256 megabytesinputstandard inputoutputstandard outputWe all know that GukiZ often plays with arrays.Now he is thinking about this problem: how many arraysa, of lengthn, with non-negative elementsstrictly lessthen2lmeet the following condition:? Here operationmeans bitwise AND (inPascalit is equivalent toand, inC/C++/Java/Pythonit is equivalent to&), operationmeans bitwise OR (inPascalit is equivalent to, inC/C++/Java/Pythonit is equivalent to|).Because the answer can be quite large, calculate it modulom. This time GukiZ hasn't come up with solution, and needs you to help him!InputFirst and the only line of input contains four integersn,k,l,m(2 ≤n≤ 1018,0 ≤k≤ 1018,0 ≤l≤ 64,1 ≤m≤ 109+ 7).OutputIn the single line print the number of arrays satisfying the condition above modulom.ExamplesInput2 1 2 10Output3Input2 1 1 3Output1Input3 3 2 10Output9NoteIn the first sample, satisfying arrays are{1, 1}, {3, 1}, {1, 3}.In the second sample, only satisfying array is{1, 1}.In the third sample, satisfying arrays are{0, 3, 3}, {1, 3, 2}, {1, 3, 3}, {2, 3, 1}, {2, 3, 3}, {3, 3, 0}, {3, 3, 1}, {3, 3, 2}, {3, 3, 3}.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "fcfa76ed", "template_md5": "35d339e4", "result": "Given integers $n$, $k$, $l$, and $m$ ($2 \\le n \\le 10^{18}$, $0 \\le k \\le 10^{18}$, $0 \\le l \\le 64$, $1 \\le m \\le 10^9 + 7$), find the number of arrays of length $n$ with non-negative elements strictly less than $2^l$ that satisfy the following condition:\n\nThe bitwise AND of all elements in the array is less than or equal to $k$, and the bitwise OR of all elements in the array is greater than or equal to $k$.\n\nCalculate the answer modulo $m$."}, {"prompt_md5": "bef754b0", "template_md5": "465699a0", "result": "Find the number of arrays of a given length, where each element is a non-negative integer less than 2^k, that satisfy the condition: the bitwise AND of all elements is less than 2^l and the bitwise OR of all elements is less than 2^l. The answer should be calculated modulo m."}]}