{"uid": "1868-D", "url": "https://codeforces.com/contest/1868/problem/D", "tags": ["constructive algorithms", " graphs", " greedy", " implementation", " trees"], "title": "1868-D", "statement": "D. Flower-like Pseudotreetime limit per test3 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputApseudotreeis a connected graph which hasexactly onecycle andnoself-loops. Note that a pseudotreemay contain multiple-edges. It can be shown that a pseudotree with $$$n$$$ vertices always contains $$$n$$$ edges.After deleting all edges on the cycle in the pseudotree, a forest$$$^{\\\\dagger}$$$ will be formed. It can be shown that each tree in the forest will contain exactly one vertex which is on cycle before removing the edges. If all trees in the forest have the same depth$$$^{\\\\ddagger}$$$ when picking the vertex on cycle as root, we call the original pseudotreeflower-like.Our friend sszcdjr, had a flower-like pseudotree with $$$n$$$ vertices and $$$n$$$ edges. However, he forgot all the edges in the pseudotree. Fortunately, he still remembers the degrees of vertices. Specifically, the degree of the $$$i$$$-th vertex is $$$d_i$$$.You have to help sszcdjr construct a possible flower-like pseudotree with $$$n$$$ vertices, where the degree of the $$$i$$$-th vertex isexactly$$$d_i$$$, or tell him that it is impossible.$$$^{\\\\dagger}$$$ A forest is a graph in which all connectivity components are trees. A connected graph without cycles and self-loops is called a tree.$$$^{\\\\ddagger}$$$ The depth of a tree with a root is the maximum distance from the root to the vertex of this tree.InputThe first line of the input contains a single integer $$$t$$$ ($$$1\\\\leq t\\\\leq 10^5$$$) — the number of test cases. The description of test cases follows.The first line of each test case contains a single integer $$$n$$$ ($$$2\\\\leq n\\\\leq 10^6$$$) — the number of vertices.The second line of each test case contains $$$n$$$ integers $$$d_1,d_2,\\\\ldots,d_n$$$ ($$$1\\\\leq d_i\\\\leq n$$$) — the degree of each vertex.It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$10^6$$$.OutputFor each test case, if there exist a possible flower-like pseudotree:Print \"Yes\" (without quotes) in the first line.Then, output $$$n$$$ lines, in each line print two integers $$$u_i$$$ and $$$v_i$$$ — the two vertices that the $$$i$$$-th edge connects.If there are multiple answers, you may output any of them.Otherwise, print \"No\" (without quotes) in the only line of output.You can output the first line of each test case in any case (upper or lower). For example, the strings \"yEs\", \"yes\", \"Yes\", and \"YES\" will be recognized as positive responses.ExampleInput632 2 241 2 3 474 3 3 1 1 1 161 1 2 2 3 3101 1 5 2 1 1 1 1 1 691 1 3 1 1 4 1 1 5OutputYes 1 2 2 3 3 1 No Yes 1 2 2 3 3 1 1 4 1 5 2 6 3 7 Yes 5 6 6 5 1 3 2 4 3 5 4 6 No Yes 3 6 6 9 9 3 1 3 2 6 4 6 5 9 7 9 8 9NoteIn the first test case, the only possible flower-like psuedotree is:After deleting all edges on the cycle in the pseudotree, each tree has depth $$$0$$$.In the second test case, it can be proven that there's no such flower-like psuedotree.In the third test case, one of the possible flower-like psuedotrees is:", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "de8a5e98", "template_md5": "35d339e4", "result": "You are given a number $n$ and a list of $n$ integers $d_1, d_2, ..., d_n$ representing the degrees of vertices in a pseudotree. A pseudotree is a connected graph with exactly one cycle and no self-loops.  \n\nDetermine if it is possible to construct a flower-like pseudotree with these degrees. A flower-like pseudotree is a pseudotree where, after removing the edges of the cycle, each resulting tree has the same depth when the vertex on the cycle is the root.\n\nIf a flower-like pseudotree is possible, output \"Yes\" followed by $n$ lines, each containing two integers representing an edge in the pseudotree. If it is not possible, output \"No\"."}, {"prompt_md5": "178daa33", "template_md5": "465699a0", "result": "You are given a list of numbers representing the degree (number of connections) of each node in a special type of tree.  Determine if it's possible to construct this tree, and if so, provide one possible arrangement of the connections."}]}