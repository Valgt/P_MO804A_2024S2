{"uid": "804-D", "url": "https://codeforces.com/contest/804/problem/D", "tags": ["binary search", " brute force", " dfs and similar", " dp", " sortings", " trees"], "title": "804-D", "statement": "D. Expected diameter of a treetime limit per test3 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputPasha is a good student and one of MoJaK's best friends. He always have a problem to think about. Today they had a talk about the following problem.We have a forest (acyclic undirected graph) withnvertices andmedges. There areqqueries we should answer. In each query two verticesvanduare given. LetVbe the set of vertices in the connected component of the graph that containsv, andUbe the set of vertices in the connected component of the graph that containsu. Let's add an edge between some vertexand some vertex inand compute the valuedof the resulting component. If the resulting component is a tree, the valuedis thediameterof the component, and it is equal to-1otherwise. What is the expected value ofd, if we choose verticesaandbfrom the sets uniformly at random?Can you help Pasha to solve this problem?Thediameterof the component is the maximumdistanceamong some pair of vertices in the component. Thedistancebetween two vertices is the minimum number of edges on some path between the two vertices.Note that queries don't add edges to the initial forest.InputThe first line contains three integersn,mandq(1 ≤n,m,q≤ 105) — the number of vertices, the number of edges in the graph and the number of queries.Each of the nextmlines contains two integersuiandvi(1 ≤ui,vi≤n), that means there is an edge between verticesuiandvi.It is guaranteed that the given graph is a forest.Each of the nextqlines contains two integersuiandvi(1 ≤ui,vi≤n) — the vertices given in thei-th query.OutputFor each query print the expected value ofdas described in the problem statement.Your answer will be considered correct if its absolute or relative error does not exceed10- 6. Let's assume that your answer isa, and the jury's answer isb. The checker program will consider your answer correct, if.ExamplesInput3 1 21 33 12 3Output-12.0000000000Input5 2 32 44 34 24 12 5Output-12.66666666672.6666666667NoteIn the first example the vertices1and3are in the same component, so the answer for the first query is-1. For the second query there are two options to add the edge: one option is to add the edge1 - 2, the other one is2 - 3. In both ways the resulting diameter is2, so the answer is2.In the second example the answer for the first query is obviously-1. The answer for the second query is the average of three cases: for added edges1 - 2or1 - 3the diameter is3, and for added edge1 - 4the diameter is2. Thus, the answer is.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "5ec6c4d3", "template_md5": "35d339e4", "result": "You are given a forest (a collection of trees) with $n$ vertices and $m$ edges. There are $q$ queries. Each query consists of two vertices $v$ and $u$. \n\nFor each query, do the following:\n\n1.  Find the connected components of the forest that contain vertices $v$ and $u$. Let's call these components $V$ and $U$ respectively.\n2.  Choose a random vertex $a$ from set $V$ and a random vertex $b$ from set $U$.\n3.  Add an edge between vertex $a$ and vertex $b$.\n4.  Calculate the diameter of the resulting connected component. The diameter is the longest distance between any two vertices in the component. If the resulting component is not a tree, the diameter is $-1$.\n\nCalculate the expected value of the diameter for each query. \n\n**Input:**\n\n*   The first line contains three integers: $n$, $m$, and $q$ ($1 \\le n, m, q \\le 10^5$).\n*   The next $m$ lines each contain two integers $u_i$ and $v_i$ ($1 \\le u_i, v_i \\le n$), representing an edge between vertices $u_i$ and $v_i$.\n*   The next $q$ lines each contain two integers $u_j$ and $v_j$ ($1 \\le u_j, v_j \\le n$), representing the vertices for the $j$-th query.\n\n**Output:**\n\nFor each query, print the expected value of the diameter. Your answer will be considered correct if its absolute or relative error does not exceed $10^{-6}$."}, {"prompt_md5": "eb4fa41a", "template_md5": "465699a0", "result": "You are given a forest (a collection of trees) with a certain number of nodes and edges. You need to answer queries about adding an edge between two nodes from different trees in the forest. For each query, calculate the expected diameter of the resulting connected component. The diameter is the longest distance between any two nodes in the component."}]}