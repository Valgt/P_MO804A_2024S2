{"uid": "1385-G", "url": "https://codeforces.com/contest/1385/problem/G", "tags": ["2-sat", " dfs and similar", " dsu", " graphs", " implementation"], "title": "1385-G", "statement": "G. Columns Swapstime limit per test2 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputYou are given a table $$$a$$$ of size $$$2 \\\\times n$$$ (i.e. two rows and $$$n$$$ columns) consisting of integers from $$$1$$$ to $$$n$$$.In one move, you can choose somecolumn$$$j$$$ ($$$1 \\\\le j \\\\le n$$$) and swap values $$$a_{1, j}$$$ and $$$a_{2, j}$$$ in it. Each column can be chosenno more than once.Your task is to find theminimumnumber of moves required to obtain permutations of size $$$n$$$ in both first and second rows of the table or determine if it is impossible to do that.You have to answer $$$t$$$ independent test cases.Recall that the permutation of size $$$n$$$ is such an array of size $$$n$$$ that containseach integerfrom $$$1$$$ to $$$n$$$ exactly once (the order of elements doesn't matter).InputThe first line of the input contains one integer $$$t$$$ ($$$1 \\\\le t \\\\le 2 \\\\cdot 10^4$$$) — the number of test cases. Then $$$t$$$ test cases follow.The first line of the test case contains one integer $$$n$$$ ($$$1 \\\\le n \\\\le 2 \\\\cdot 10^5$$$) — the number of columns in the table. The second line of the test case contains $$$n$$$ integers $$$a_{1, 1}, a_{1, 2}, \\\\dots, a_{1, n}$$$ ($$$1 \\\\le a_{1, i} \\\\le n$$$), where $$$a_{1, i}$$$ is the $$$i$$$-th element of the first row of the table. The third line of the test case contains $$$n$$$ integers $$$a_{2, 1}, a_{2, 2}, \\\\dots, a_{2, n}$$$ ($$$1 \\\\le a_{2, i} \\\\le n$$$), where $$$a_{2, i}$$$ is the $$$i$$$-th element of the second row of the table.It is guaranteed that the sum of $$$n$$$ does not exceed $$$2 \\\\cdot 10^5$$$ ($$$\\\\sum n \\\\le 2 \\\\cdot 10^5$$$).OutputFor each test case print the answer:-1if it is impossible to obtain permutation of size $$$n$$$ in both first and the second rows of the table, or one integer $$$k$$$ in the first line, where $$$k$$$ is theminimumnumber of moves required to obtain permutations in both rows, and $$$k$$$distinctintegers $$$pos_1, pos_2, \\\\dots, pos_k$$$ in the second line ($$$1 \\\\le pos_i \\\\le n$$$) inany order— indices of columns in which you need to swap values to obtain permutations in both rows. If there are several answers, you can print any.ExampleInput6 4 1 2 3 4 2 3 1 4 5 5 3 5 1 4 1 2 3 2 4 3 1 2 1 3 3 2 4 1 2 2 1 3 4 3 4 4 4 3 1 4 3 2 2 1 3 1 1 2 3 2 2Output0  2 2 3  1 1  2 3 4  2 3 4  -1", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "e76e2ac0", "template_md5": "35d339e4", "result": "You are given a 2 x $n$ table of integers from 1 to $n$.  Each row has $n$ columns. You can swap the values in any column, but you can only swap a column once.  \n\nYour goal is to find the fewest swaps needed to make both rows of the table contain a permutation of the numbers 1 to $n$. A permutation is a list of numbers from 1 to $n$ where each number appears exactly once.\n\nIf it's impossible to make both rows permutations, say so.\n\n**Input:**\n\n* The first line contains the number of test cases, $t$.\n* For each test case:\n    * The first line contains the number of columns, $n$.\n    * The second line contains the numbers in the first row.\n    * The third line contains the numbers in the second row.\n\n**Output:**\n\n* For each test case:\n    * If it's impossible to make both rows permutations, print \"-1\".\n    * Otherwise, print the minimum number of swaps needed, followed by a list of the column indices to swap."}, {"prompt_md5": "61fa69a1", "template_md5": "465699a0", "result": "You are given a 2xN grid of numbers from 1 to N.  You can swap the numbers in each column at most once.  Find the fewest swaps needed to make both rows into permutations of the numbers 1 to N, or determine if it's impossible."}]}