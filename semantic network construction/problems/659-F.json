{"uid": "659-F", "url": "https://codeforces.com/contest/659/problem/F", "tags": ["dfs and similar", " dsu", " graphs", " greedy", " sortings"], "title": "659-F", "statement": "F. Polycarp and Haytime limit per test4 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputThe farmer Polycarp has a warehouse with hay, which can be represented as ann×mrectangular table, wherenis the number of rows, andmis the number of columns in the table. Each cell of the table contains a haystack. The height in meters of the hay located in thei-th row and thej-th column is equal to an integerai,jand coincides with the number of cubic meters of hay in the haystack, because all cells have the size of the base1 × 1. Polycarp has decided to tidy up in the warehouse by removing an arbitrary integer amount of cubic meters of hay from the top of each stack. You can take different amounts of hay from different haystacks. Besides, it is allowed not to touch a stack at all, or, on the contrary, to remove it completely. If a stack is completely removed, the corresponding cell becomes empty and no longer contains the stack.Polycarp wants the following requirements to hold after the reorganization:the total amount of hay remaining in the warehouse must beequaltok,the heights of all stacks (i.e., cells containing a non-zero amount of hay) should be the same,the height of at least one stack must remain the same as it was,for the stability of the remaining structure all the stacks should form one connected region.The two stacks are considered adjacent if they share a side in the table. The area is called connected if from any of the stack in the area you can get to any other stack in this area, moving only to adjacent stacks. In this case two adjacent stacks necessarily belong to the same area.Help Polycarp complete this challenging task or inform that it is impossible.InputThe first line of the input contains three integersn,m(1 ≤n,m≤ 1000) andk(1 ≤k≤ 1018) — the number of rows and columns of the rectangular table where heaps of hay are lain and the required total number cubic meters of hay after the reorganization.Thennlines follow, each containingmpositive integersai,j(1 ≤ai,j≤ 109), whereai,jis equal to the number of cubic meters of hay making the hay stack on thei-th row andj-th column of the table.OutputIn the first line print \"YES\" (without quotes), if Polycarpus can perform the reorganisation and \"NO\" (without quotes) otherwise. If the answer is \"YES\" (without quotes), then in nextnlines printmnumbers — the heights of the remaining hay stacks. All the remaining non-zero values should be equal, represent a connected area and at least one of these values shouldn't be altered.If there are multiple answers, print any of them.ExamplesInput2 3 3510 4 99 9 7OutputYES7 0 77 7 7Input4 4 505 9 1 15 1 1 55 1 5 55 5 7 1OutputYES5 5 0 05 0 0 55 0 5 55 5 5 0Input2 4 121 1 3 11 6 2 4OutputNONoteIn the first sample non-zero values make up a connected area, their values do not exceed the initial heights of hay stacks. All the non-zero values equal7, and their number is5, so the total volume of the remaining hay equals the required valuek= 7·5 = 35. At that the stack that is on the second line and third row remained unaltered.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "e3606b5b", "template_md5": "35d339e4", "result": "You are given a rectangular table of size $n \\times m$ representing a warehouse filled with haystacks. Each cell in the table contains a haystack with a height (and volume) of $a_{i,j}$ cubic meters. \n\nYou need to remove some hay from the top of each haystack to satisfy the following conditions:\n\n1. The total volume of hay remaining in the warehouse must be equal to $k$ cubic meters.\n2. The height of all remaining haystacks must be the same.\n3. At least one haystack's height must remain unchanged.\n4. All remaining haystacks must form a single connected region (meaning you can reach any haystack from any other haystack by moving only to adjacent haystacks).\n\nDetermine if it is possible to achieve these conditions and, if so, output the heights of the remaining haystacks. If it is impossible, output \"NO\"."}, {"prompt_md5": "5ca652e1", "template_md5": "465699a0", "result": "You are given a rectangular grid of numbers representing the height of haystacks. You need to remove some hay from each haystack so that:\n\n* The total remaining hay is a specific target amount.\n* All remaining haystacks have the same height.\n* At least one haystack's height remains unchanged.\n* All remaining haystacks are connected (you can reach any from any other by moving to adjacent stacks).\n\nDetermine if this is possible and, if so, output the new heights of the remaining haystacks."}]}