{"uid": "1327-G", "url": "https://codeforces.com/contest/1327/problem/G", "tags": ["bitmasks", " dp", " string suffix structures"], "title": "1327-G", "statement": "G. Letters and Question Markstime limit per test4 secondsmemory limit per test1024 megabytesinputstandard inputoutputstandard outputYou are given a string $$$S$$$ and an array of strings $$$[t_1, t_2, \\\\dots, t_k]$$$. Each string $$$t_i$$$ consists of lowercase Latin letters fromaton; $$$S$$$ consists of lowercase Latin letters fromatonandno more than $$$14$$$question marks.Each string $$$t_i$$$ has its cost $$$c_i$$$ — an integer number. The value of some string $$$T$$$ is calculated as $$$\\\\sum\\\\limits_{i = 1}^{k} F(T, t_i) \\\\cdot c_i$$$, where $$$F(T, t_i)$$$ is the number of occurences of string $$$t_i$$$ in $$$T$$$ as a substring. For example, $$$F(\\\\text{aaabaaa}, \\\\text{aa}) = 4$$$.You have to replace all question marks in $$$S$$$ withpairwise distinctlowercase Latin letters fromatonso the value of $$$S$$$ is maximum possible.InputThe first line contains one integer $$$k$$$ ($$$1 \\\\le k \\\\le 1000$$$) — the number of strings in the array $$$[t_1, t_2, \\\\dots, t_k]$$$.Then $$$k$$$ lines follow, each containing one string $$$t_i$$$ (consisting of lowercase Latin letters fromaton) and one integer $$$c_i$$$ ($$$1 \\\\le |t_i| \\\\le 1000$$$, $$$-10^6 \\\\le c_i \\\\le 10^6$$$). The sum of lengths of all strings $$$t_i$$$ does not exceed $$$1000$$$.The last line contains one string $$$S$$$ ($$$1 \\\\le |S| \\\\le 4 \\\\cdot 10^5$$$) consisting of lowercase Latin letters fromatonand question marks. The number of question marks in $$$S$$$ is not greater than $$$14$$$.OutputPrint one integer — the maximum value of $$$S$$$ after replacing all question marks withpairwise distinctlowercase Latin letters fromaton.ExamplesInput4 abc -10 a 1 b 1 c 3 ?b?Output5Input2 a 1 a 1 ?Output2Input3 a 1 b 3 ab 4 abOutput8Input1 a -1 ?????????????Output0Input1 a -1 ??????????????Output-1", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "1d8ed6af", "template_md5": "35d339e4", "result": "You are given a string $S$ with some question marks and a list of strings $t_1, t_2, ..., t_k$. Each string $t_i$ has a cost $c_i$.  \n\nThe value of a string $T$ is calculated as:\n\n$$\\sum_{i=1}^{k} F(T, t_i) \\cdot c_i$$\n\nwhere $F(T, t_i)$ is the number of times $t_i$ appears as a substring in $T$.\n\nYour task is to replace all the question marks in $S$ with lowercase letters from the set {a, b, c, d, e, f, g, h, i, j, k, l, m, n, o} so that the resulting value of $S$ is as large as possible.  \n\nOutput the maximum possible value of $S$."}, {"prompt_md5": "e9f4470a", "template_md5": "465699a0", "result": "You are given a string with some question marks and a list of other strings. Each string in the list has a value.  You need to replace the question marks with letters (a, b, c, d) so that the total value of the resulting string is as high as possible. The value of a string is calculated by adding up the values of the strings from the list that appear as substrings within it."}]}