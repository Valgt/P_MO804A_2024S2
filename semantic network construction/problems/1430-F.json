{"uid": "1430-F", "url": "https://codeforces.com/contest/1430/problem/F", "tags": ["dp", " greedy"], "title": "1430-F", "statement": "F. Realistic Gameplaytime limit per test1 secondmemory limit per test256 megabytesinputstandard inputoutputstandard outputRecently you've discovered a new shooter. They say it has realistic game mechanics.Your character has a gun with magazine size equal to $$$k$$$ and should exterminate $$$n$$$ waves of monsters. The $$$i$$$-th wave consists of $$$a_i$$$ monsters and happens from the $$$l_i$$$-th moment of time up to the $$$r_i$$$-th moments of time. All $$$a_i$$$ monsters spawn at moment $$$l_i$$$ and you have to exterminate all of them before the moment $$$r_i$$$ ends (you can kill monsters right at moment $$$r_i$$$). For every two consecutive waves, the second wave starts not earlier than the first wave ends (though the second wave can start at the same moment when the first wave ends) — formally, the condition $$$r_i \\\\le l_{i + 1}$$$ holds. Take a look at the notes for the examples to understand the process better.You are confident in yours and your character's skills so you can assume that aiming and shooting are instant and you need exactly one bullet to kill one monster. But reloading takes exactly $$$1$$$ unit of time.One of the realistic mechanics is a mechanic of reloading: when you reload you throw away the old magazine with all remaining bullets in it. That's why constant reloads may cost you excessive amounts of spent bullets.You've taken a liking to this mechanic so now you are wondering: what is the minimum possible number of bullets you need to spend (both used and thrown) to exterminate all waves.Note that you don't throw the remaining bullets away after eradicating all monsters, and you start with a full magazine.InputThe first line contains two integers $$$n$$$ and $$$k$$$ ($$$1 \\\\le n \\\\le 2000$$$; $$$1 \\\\le k \\\\le 10^9$$$) — the number of waves and magazine size.The next $$$n$$$ lines contain descriptions of waves. The $$$i$$$-th line contains three integers $$$l_i$$$, $$$r_i$$$ and $$$a_i$$$ ($$$1 \\\\le l_i \\\\le r_i \\\\le 10^9$$$; $$$1 \\\\le a_i \\\\le 10^9$$$) — the period of time when the $$$i$$$-th wave happens and the number of monsters in it.It's guaranteed that waves don't overlap (but may touch) and are given in the order they occur, i. e. $$$r_i \\\\le l_{i + 1}$$$.OutputIf there is no way to clear all waves, print $$$-1$$$. Otherwise, print the minimum possible number of bullets you need to spend (both used and thrown) to clear all waves.ExamplesInput2 3 2 3 6 3 4 3Output9Input2 5 3 7 11 10 12 15Output30Input5 42 42 42 42 42 43 42 43 44 42 44 45 42 45 45 1Output-1Input1 10 100 111 1Output1NoteIn the first example:At the moment $$$2$$$, the first wave occurs and $$$6$$$ monsters spawn. You kill $$$3$$$ monsters and start reloading.At the moment $$$3$$$, the second wave occurs and $$$3$$$ more monsters spawn. You kill remaining $$$3$$$ monsters from the first wave and start reloading.At the moment $$$4$$$, you kill remaining $$$3$$$ monsters from the second wave.In total, you'll spend $$$9$$$ bullets.In the second example:At moment $$$3$$$, the first wave occurs and $$$11$$$ monsters spawn. You kill $$$5$$$ monsters and start reloading.At moment $$$4$$$, you kill $$$5$$$ more monsters and start reloading.At moment $$$5$$$, you kill the last monster and start reloading throwing away old magazine with $$$4$$$ bullets.At moment $$$10$$$, the second wave occurs and $$$15$$$ monsters spawn. You kill $$$5$$$ monsters and start reloading.At moment $$$11$$$, you kill $$$5$$$ more monsters and start reloading.At moment $$$12$$$, you kill last $$$5$$$ monsters.In total, you'll spend $$$30$$$ bullets.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "c09e4c71", "template_md5": "465699a0", "result": "You have a limited number of bullets per magazine. You need to clear waves of enemies that appear at specific times. Each wave has a number of enemies that must be killed before a certain time. Reloading takes one unit of time and discards the current magazine. Find the minimum number of bullets needed to clear all waves."}, {"prompt_md5": "e1e1c6b4", "template_md5": "35d339e4", "result": "You are given $n$ waves of monsters. Each wave $i$ lasts from time $l_i$ to $r_i$ and contains $a_i$ monsters.  You have a gun with a magazine size of $k$.  \n\nYou can kill monsters instantly, but reloading takes 1 unit of time.  When you reload, you discard the current magazine.\n\nFind the minimum number of bullets you need to spend (both used and discarded) to kill all the monsters. \n\n**Input:**\n\n* The first line contains two integers $n$ and $k$ ($1 \\le n \\le 2000$, $1 \\le k \\le 10^9$) - the number of waves and magazine size.\n* The next $n$ lines contain three integers $l_i$, $r_i$, and $a_i$ ($1 \\le l_i \\le r_i \\le 10^9$, $1 \\le a_i \\le 10^9$) - the start time, end time, and number of monsters in each wave.\n\n**Output:**\n\n* If it's impossible to kill all the monsters, print $-1$.\n* Otherwise, print the minimum number of bullets needed."}]}