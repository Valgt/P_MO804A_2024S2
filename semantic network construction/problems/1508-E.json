{"uid": "1508-E", "url": "https://codeforces.com/contest/1508/problem/E", "tags": ["brute force", " constructive algorithms", " data structures", " dfs and similar", " sortings", " trees"], "title": "1508-E", "statement": "E. Tree Calendartime limit per test2 secondsmemory limit per test512 megabytesinputstandard inputoutputstandard outputYuu Koito and Touko Nanami are newlyweds! On the wedding day, Yuu gifted Touko a directed tree with $$$n$$$ nodes and rooted at $$$1$$$, and a labeling $$$a$$$ which issomeDFS order of the tree. Every edge in this tree is directed away from the root.After callingdfs(1)the following algorithm returns $$$a$$$ as a DFS order of a tree rooted at $$$1$$$ :order := 0a := array of length nfunction dfs(u):order := order + 1a[u] := orderfor all v such that there is a directed edge (u -> v):dfs(v)Note that there may be different DFS orders for a given tree.Touko likes the present so much she decided to play with it! On each day following the wedding day, Touko performs this procedure once:Among all directed edges $$$u \\\\rightarrow v$$$ such that $$$a_u < a_v$$$, select the edge $$$u' \\\\rightarrow v'$$$ with the lexicographically smallest pair $$$(a_{u'}, a_{v'})$$$.Swap $$$a_{u'}$$$ and $$$a_{v'}$$$.Days have passed since their wedding, and Touko has somehow forgotten which date the wedding was and what was the original labeling $$$a$$$! Fearing that Yuu might get angry, Touko decided to ask you to derive these two pieces of information using the current labeling.Being her good friend, you need to find the number of days that have passed since the wedding, and the original labeling of the tree. However, there is a chance that Touko might have messed up her procedures, which result in the current labeling being impossible to obtain from some original labeling; in that case, please inform Touko as well.InputThe first line of the input contains an integer $$$n$$$ ($$$2 \\\\le n \\\\le 3 \\\\cdot 10^5$$$) — the number of nodes on the tree.The second line contains $$$n$$$ integers $$$a_1$$$, $$$a_2$$$, ..., $$$a_n$$$ ($$$1 \\\\le a_i \\\\le n$$$, all $$$a_i$$$ are distinct) — the current labeling of the tree.Each of the next $$$n - 1$$$ lines contains two integers $$$u_i$$$ and $$$v_i$$$ ($$$1 \\\\le u, v \\\\le n$$$, $$$u \\\\neq v$$$), describing an directed edge from $$$u_i$$$ to $$$v_i$$$. The edges form a directed tree rooted at $$$1$$$.OutputIf the current labeling is impossible to arrive at from any DFS order, printNO.Else, on the first line, printYES. On the second line, print a single integer denoting the number of days since the wedding. On the third line, print $$$n$$$ numbers space-separated denoting the original labeling of the tree.If there are multiple correct outputs, print any. This means: you are allowed to output any pair (DFS order, number of days), such that we get the current configuration from the DFS order you provided in exactly the number of days you provided.ExamplesInput7 4 5 2 1 7 6 3 1 5 7 6 1 2 2 7 3 4 1 3OutputYES 5 1 4 2 3 7 6 5Input7 7 6 5 3 1 4 2 4 3 2 5 3 7 1 4 7 2 2 6OutputNONoteThe following animation showcases the first sample test case. The white label inside the node represents the index of the node $$$i$$$, while the boxed orange label represents the value $$$a_i$$$.", "source": "CF", "vjudge": false, "processed": [{"prompt_md5": "a0cfb4d7", "template_md5": "35d339e4", "result": "You are given a directed tree with $n$ nodes, rooted at node 1. The tree is represented by a list of edges, where each edge points away from the root. You are also given a list of $n$ integers, representing the current labeling of the tree.\n\nThe labeling is obtained by performing a Depth First Search (DFS) on the tree, starting from node 1.  \n\nOn each day, you can select the edge with the lexicographically smallest pair of labels among all edges where the label of the source node is less than the label of the target node. Then, you swap the labels of the source and target nodes of the selected edge.\n\nGiven the current labeling, determine:\n\n1. Is it possible to obtain this labeling from a valid DFS traversal of the tree?\n2. If yes, what is the number of days it took to reach this labeling?\n3. What was the original labeling of the tree?\n\nIf it is not possible to obtain the current labeling from any valid DFS traversal, output \"NO\". Otherwise, output \"YES\" followed by the number of days and the original labeling."}, {"prompt_md5": "965105a1", "template_md5": "465699a0", "result": "You are given a tree with a specific order of nodes.  Each day, you can swap the order of two nodes connected by a directed edge, where the first node's order is smaller than the second node's order.  You are given the current order of the nodes. Determine the number of days it took to reach this order and the original order of the nodes. If it's impossible to reach the current order, say so."}]}